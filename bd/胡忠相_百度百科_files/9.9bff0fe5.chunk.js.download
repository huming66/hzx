(this["webpackJsonpwiki-react-editor"]=this["webpackJsonpwiki-react-editor"]||[]).push([[9],{1102:function(e,t,n){"use strict";n.d(t,"a",(function(){return m}));var o=n(4),a=n(3),i=n(56),c=n.n(i),r=n(27),s=n(549),l=n(176),d=n.n(l),u=[{key:"$$",cmd:function(e,t){Object(s.b)(e,s.a.sourceEdit,t)}}];var p=null,m=function(){function e(){var t=this;Object(o.a)(this,e),this.onKeydown=function(e){var n=t.editor.context,o=n.range,a=n.selectionModel,i=n.root;if(c()("space",e)&&o.collapsed&&a.startNode.closest(".J-editor-for-dom-plugin")===i){var r=a.startNode.closest("h2,h3");if(3===o.startContainer.nodeType&&!r){var s=function(e,t,n){var o=document.createRange();return o.setStart(n,0),o.setEnd(e,t),{preText:o.toString(),textRange:o}}(o.startContainer,o.startOffset,o.startContainer).preText;u.forEach((function(e){if(s.substring(s.length-e.key.length,s.length)===e.key){var n=document.createRange();n.setStart(o.startContainer,o.startOffset-e.key.length),p&&d.a.cancel(p),p=d()((function(){e.cmd(t.editor,(function(){n.setEnd(o.startContainer,o.startOffset),n.deleteContents(),t.editor.refreshNativeRange()}))}))}}))}}}}return Object(a.a)(e,[{key:"initialize",value:function(e){this.editor=e}},{key:"dispose",value:function(){this.editor=null}},{key:"onPluginEvent",value:function(e,t){if(e===r.b.keydown.pluginEventName)this.onKeydown(t)}}]),e}()},1103:function(e,t,n){},1104:function(e,t,n){(function(e){var o,a,i,c,r=n(48).default;c=function(e){"use strict";e.modeInfo=[{name:"APL",mime:"text/apl",mode:"apl",ext:["dyalog","apl"]},{name:"PGP",mimes:["application/pgp","application/pgp-encrypted","application/pgp-keys","application/pgp-signature"],mode:"asciiarmor",ext:["asc","pgp","sig"]},{name:"ASN.1",mime:"text/x-ttcn-asn",mode:"asn.1",ext:["asn","asn1"]},{name:"Asterisk",mime:"text/x-asterisk",mode:"asterisk",file:/^extensions\.conf$/i},{name:"Brainfuck",mime:"text/x-brainfuck",mode:"brainfuck",ext:["b","bf"]},{name:"C",mime:"text/x-csrc",mode:"clike",ext:["c","h","ino"]},{name:"C++",mime:"text/x-c++src",mode:"clike",ext:["cpp","c++","cc","cxx","hpp","h++","hh","hxx"],alias:["cpp"]},{name:"Cobol",mime:"text/x-cobol",mode:"cobol",ext:["cob","cpy","cbl"]},{name:"C#",mime:"text/x-csharp",mode:"clike",ext:["cs"],alias:["csharp","cs"]},{name:"Clojure",mime:"text/x-clojure",mode:"clojure",ext:["clj","cljc","cljx"]},{name:"ClojureScript",mime:"text/x-clojurescript",mode:"clojure",ext:["cljs"]},{name:"Closure Stylesheets (GSS)",mime:"text/x-gss",mode:"css",ext:["gss"]},{name:"CMake",mime:"text/x-cmake",mode:"cmake",ext:["cmake","cmake.in"],file:/^CMakeLists\.txt$/},{name:"CoffeeScript",mimes:["application/vnd.coffeescript","text/coffeescript","text/x-coffeescript"],mode:"coffeescript",ext:["coffee"],alias:["coffee","coffee-script"]},{name:"Common Lisp",mime:"text/x-common-lisp",mode:"commonlisp",ext:["cl","lisp","el"],alias:["lisp"]},{name:"Cypher",mime:"application/x-cypher-query",mode:"cypher",ext:["cyp","cypher"]},{name:"Cython",mime:"text/x-cython",mode:"python",ext:["pyx","pxd","pxi"]},{name:"Crystal",mime:"text/x-crystal",mode:"crystal",ext:["cr"]},{name:"CSS",mime:"text/css",mode:"css",ext:["css"]},{name:"CQL",mime:"text/x-cassandra",mode:"sql",ext:["cql"]},{name:"D",mime:"text/x-d",mode:"d",ext:["d"]},{name:"Dart",mimes:["application/dart","text/x-dart"],mode:"dart",ext:["dart"]},{name:"diff",mime:"text/x-diff",mode:"diff",ext:["diff","patch"]},{name:"Django",mime:"text/x-django",mode:"django"},{name:"Dockerfile",mime:"text/x-dockerfile",mode:"dockerfile",file:/^Dockerfile$/},{name:"DTD",mime:"application/xml-dtd",mode:"dtd",ext:["dtd"]},{name:"Dylan",mime:"text/x-dylan",mode:"dylan",ext:["dylan","dyl","intr"]},{name:"EBNF",mime:"text/x-ebnf",mode:"ebnf"},{name:"ECL",mime:"text/x-ecl",mode:"ecl",ext:["ecl"]},{name:"edn",mime:"application/edn",mode:"clojure",ext:["edn"]},{name:"Eiffel",mime:"text/x-eiffel",mode:"eiffel",ext:["e"]},{name:"Elm",mime:"text/x-elm",mode:"elm",ext:["elm"]},{name:"Embedded JavaScript",mime:"application/x-ejs",mode:"htmlembedded",ext:["ejs"]},{name:"Embedded Ruby",mime:"application/x-erb",mode:"htmlembedded",ext:["erb"]},{name:"Erlang",mime:"text/x-erlang",mode:"erlang",ext:["erl"]},{name:"Esper",mime:"text/x-esper",mode:"sql"},{name:"Factor",mime:"text/x-factor",mode:"factor",ext:["factor"]},{name:"FCL",mime:"text/x-fcl",mode:"fcl"},{name:"Forth",mime:"text/x-forth",mode:"forth",ext:["forth","fth","4th"]},{name:"Fortran",mime:"text/x-fortran",mode:"fortran",ext:["f","for","f77","f90","f95"]},{name:"F#",mime:"text/x-fsharp",mode:"mllike",ext:["fs"],alias:["fsharp"]},{name:"Gas",mime:"text/x-gas",mode:"gas",ext:["s"]},{name:"Gherkin",mime:"text/x-feature",mode:"gherkin",ext:["feature"]},{name:"GitHub Flavored Markdown",mime:"text/x-gfm",mode:"gfm",file:/^(readme|contributing|history)\.md$/i},{name:"Go",mime:"text/x-go",mode:"go",ext:["go"]},{name:"Groovy",mime:"text/x-groovy",mode:"groovy",ext:["groovy","gradle"],file:/^Jenkinsfile$/},{name:"HAML",mime:"text/x-haml",mode:"haml",ext:["haml"]},{name:"Haskell",mime:"text/x-haskell",mode:"haskell",ext:["hs"]},{name:"Haskell (Literate)",mime:"text/x-literate-haskell",mode:"haskell-literate",ext:["lhs"]},{name:"Haxe",mime:"text/x-haxe",mode:"haxe",ext:["hx"]},{name:"HXML",mime:"text/x-hxml",mode:"haxe",ext:["hxml"]},{name:"ASP.NET",mime:"application/x-aspx",mode:"htmlembedded",ext:["aspx"],alias:["asp","aspx"]},{name:"HTML",mime:"text/html",mode:"htmlmixed",ext:["html","htm","handlebars","hbs"],alias:["xhtml"]},{name:"HTTP",mime:"message/http",mode:"http"},{name:"IDL",mime:"text/x-idl",mode:"idl",ext:["pro"]},{name:"Pug",mime:"text/x-pug",mode:"pug",ext:["jade","pug"],alias:["jade"]},{name:"Java",mime:"text/x-java",mode:"clike",ext:["java"]},{name:"Java Server Pages",mime:"application/x-jsp",mode:"htmlembedded",ext:["jsp"],alias:["jsp"]},{name:"JavaScript",mimes:["text/javascript","text/ecmascript","application/javascript","application/x-javascript","application/ecmascript"],mode:"javascript",ext:["js"],alias:["ecmascript","js","node"]},{name:"JSON",mimes:["application/json","application/x-json"],mode:"javascript",ext:["json","map"],alias:["json5"]},{name:"JSON-LD",mime:"application/ld+json",mode:"javascript",ext:["jsonld"],alias:["jsonld"]},{name:"JSX",mime:"text/jsx",mode:"jsx",ext:["jsx"]},{name:"Jinja2",mime:"text/jinja2",mode:"jinja2",ext:["j2","jinja","jinja2"]},{name:"Julia",mime:"text/x-julia",mode:"julia",ext:["jl"],alias:["jl"]},{name:"Kotlin",mime:"text/x-kotlin",mode:"clike",ext:["kt"]},{name:"LESS",mime:"text/x-less",mode:"css",ext:["less"]},{name:"LiveScript",mime:"text/x-livescript",mode:"livescript",ext:["ls"],alias:["ls"]},{name:"Lua",mime:"text/x-lua",mode:"lua",ext:["lua"]},{name:"Markdown",mime:"text/x-markdown",mode:"markdown",ext:["markdown","md","mkd"]},{name:"mIRC",mime:"text/mirc",mode:"mirc"},{name:"MariaDB SQL",mime:"text/x-mariadb",mode:"sql"},{name:"Mathematica",mime:"text/x-mathematica",mode:"mathematica",ext:["m","nb","wl","wls"]},{name:"Modelica",mime:"text/x-modelica",mode:"modelica",ext:["mo"]},{name:"MUMPS",mime:"text/x-mumps",mode:"mumps",ext:["mps"]},{name:"MS SQL",mime:"text/x-mssql",mode:"sql"},{name:"mbox",mime:"application/mbox",mode:"mbox",ext:["mbox"]},{name:"MySQL",mime:"text/x-mysql",mode:"sql"},{name:"Nginx",mime:"text/x-nginx-conf",mode:"nginx",file:/nginx.*\.conf$/i},{name:"NSIS",mime:"text/x-nsis",mode:"nsis",ext:["nsh","nsi"]},{name:"NTriples",mimes:["application/n-triples","application/n-quads","text/n-triples"],mode:"ntriples",ext:["nt","nq"]},{name:"Objective-C",mime:"text/x-objectivec",mode:"clike",ext:["m"],alias:["objective-c","objc"]},{name:"Objective-C++",mime:"text/x-objectivec++",mode:"clike",ext:["mm"],alias:["objective-c++","objc++"]},{name:"OCaml",mime:"text/x-ocaml",mode:"mllike",ext:["ml","mli","mll","mly"]},{name:"Octave",mime:"text/x-octave",mode:"octave",ext:["m"]},{name:"Oz",mime:"text/x-oz",mode:"oz",ext:["oz"]},{name:"Pascal",mime:"text/x-pascal",mode:"pascal",ext:["p","pas"]},{name:"PEG.js",mime:"null",mode:"pegjs",ext:["jsonld"]},{name:"Perl",mime:"text/x-perl",mode:"perl",ext:["pl","pm"]},{name:"PHP",mimes:["text/x-php","application/x-httpd-php","application/x-httpd-php-open"],mode:"php",ext:["php","php3","php4","php5","php7","phtml"]},{name:"Pig",mime:"text/x-pig",mode:"pig",ext:["pig"]},{name:"Plain Text",mime:"text/plain",mode:"null",ext:["txt","text","conf","def","list","log"]},{name:"PLSQL",mime:"text/x-plsql",mode:"sql",ext:["pls"]},{name:"PostgreSQL",mime:"text/x-pgsql",mode:"sql"},{name:"PowerShell",mime:"application/x-powershell",mode:"powershell",ext:["ps1","psd1","psm1"]},{name:"Properties files",mime:"text/x-properties",mode:"properties",ext:["properties","ini","in"],alias:["ini","properties"]},{name:"ProtoBuf",mime:"text/x-protobuf",mode:"protobuf",ext:["proto"]},{name:"Python",mime:"text/x-python",mode:"python",ext:["BUILD","bzl","py","pyw"],file:/^(BUCK|BUILD)$/},{name:"Puppet",mime:"text/x-puppet",mode:"puppet",ext:["pp"]},{name:"Q",mime:"text/x-q",mode:"q",ext:["q"]},{name:"R",mime:"text/x-rsrc",mode:"r",ext:["r","R"],alias:["rscript"]},{name:"reStructuredText",mime:"text/x-rst",mode:"rst",ext:["rst"],alias:["rst"]},{name:"RPM Changes",mime:"text/x-rpm-changes",mode:"rpm"},{name:"RPM Spec",mime:"text/x-rpm-spec",mode:"rpm",ext:["spec"]},{name:"Ruby",mime:"text/x-ruby",mode:"ruby",ext:["rb"],alias:["jruby","macruby","rake","rb","rbx"]},{name:"Rust",mime:"text/x-rustsrc",mode:"rust",ext:["rs"]},{name:"SAS",mime:"text/x-sas",mode:"sas",ext:["sas"]},{name:"Sass",mime:"text/x-sass",mode:"sass",ext:["sass"]},{name:"Scala",mime:"text/x-scala",mode:"clike",ext:["scala"]},{name:"Scheme",mime:"text/x-scheme",mode:"scheme",ext:["scm","ss"]},{name:"SCSS",mime:"text/x-scss",mode:"css",ext:["scss"]},{name:"Shell",mimes:["text/x-sh","application/x-sh"],mode:"shell",ext:["sh","ksh","bash"],alias:["bash","sh","zsh"],file:/^PKGBUILD$/},{name:"Sieve",mime:"application/sieve",mode:"sieve",ext:["siv","sieve"]},{name:"Slim",mimes:["text/x-slim","application/x-slim"],mode:"slim",ext:["slim"]},{name:"Smalltalk",mime:"text/x-stsrc",mode:"smalltalk",ext:["st"]},{name:"Smarty",mime:"text/x-smarty",mode:"smarty",ext:["tpl"]},{name:"Solr",mime:"text/x-solr",mode:"solr"},{name:"SML",mime:"text/x-sml",mode:"mllike",ext:["sml","sig","fun","smackspec"]},{name:"Soy",mime:"text/x-soy",mode:"soy",ext:["soy"],alias:["closure template"]},{name:"SPARQL",mime:"application/sparql-query",mode:"sparql",ext:["rq","sparql"],alias:["sparul"]},{name:"Spreadsheet",mime:"text/x-spreadsheet",mode:"spreadsheet",alias:["excel","formula"]},{name:"SQL",mime:"text/x-sql",mode:"sql",ext:["sql"]},{name:"SQLite",mime:"text/x-sqlite",mode:"sql"},{name:"Squirrel",mime:"text/x-squirrel",mode:"clike",ext:["nut"]},{name:"Stylus",mime:"text/x-styl",mode:"stylus",ext:["styl"]},{name:"Swift",mime:"text/x-swift",mode:"swift",ext:["swift"]},{name:"sTeX",mime:"text/x-stex",mode:"stex"},{name:"LaTeX",mime:"text/x-latex",mode:"stex",ext:["text","ltx","tex"],alias:["tex"]},{name:"SystemVerilog",mime:"text/x-systemverilog",mode:"verilog",ext:["v","sv","svh"]},{name:"Tcl",mime:"text/x-tcl",mode:"tcl",ext:["tcl"]},{name:"Textile",mime:"text/x-textile",mode:"textile",ext:["textile"]},{name:"TiddlyWiki",mime:"text/x-tiddlywiki",mode:"tiddlywiki"},{name:"Tiki wiki",mime:"text/tiki",mode:"tiki"},{name:"TOML",mime:"text/x-toml",mode:"toml",ext:["toml"]},{name:"Tornado",mime:"text/x-tornado",mode:"tornado"},{name:"troff",mime:"text/troff",mode:"troff",ext:["1","2","3","4","5","6","7","8","9"]},{name:"TTCN",mime:"text/x-ttcn",mode:"ttcn",ext:["ttcn","ttcn3","ttcnpp"]},{name:"TTCN_CFG",mime:"text/x-ttcn-cfg",mode:"ttcn-cfg",ext:["cfg"]},{name:"Turtle",mime:"text/turtle",mode:"turtle",ext:["ttl"]},{name:"TypeScript",mime:"application/typescript",mode:"javascript",ext:["ts"],alias:["ts"]},{name:"TypeScript-JSX",mime:"text/typescript-jsx",mode:"jsx",ext:["tsx"],alias:["tsx"]},{name:"Twig",mime:"text/x-twig",mode:"twig"},{name:"Web IDL",mime:"text/x-webidl",mode:"webidl",ext:["webidl"]},{name:"VB.NET",mime:"text/x-vb",mode:"vb",ext:["vb"]},{name:"VBScript",mime:"text/vbscript",mode:"vbscript",ext:["vbs"]},{name:"Velocity",mime:"text/velocity",mode:"velocity",ext:["vtl"]},{name:"Verilog",mime:"text/x-verilog",mode:"verilog",ext:["v"]},{name:"VHDL",mime:"text/x-vhdl",mode:"vhdl",ext:["vhd","vhdl"]},{name:"Vue.js Component",mimes:["script/x-vue","text/x-vue"],mode:"vue",ext:["vue"]},{name:"XML",mimes:["application/xml","text/xml"],mode:"xml",ext:["xml","xsl","xsd","svg"],alias:["rss","wsdl","xsd"]},{name:"XQuery",mime:"application/xquery",mode:"xquery",ext:["xy","xquery"]},{name:"Yacas",mime:"text/x-yacas",mode:"yacas",ext:["ys"]},{name:"YAML",mimes:["text/x-yaml","text/yaml"],mode:"yaml",ext:["yaml","yml"],alias:["yml"]},{name:"Z80",mime:"text/x-z80",mode:"z80",ext:["z80"]},{name:"mscgen",mime:"text/x-mscgen",mode:"mscgen",ext:["mscgen","mscin","msc"]},{name:"xu",mime:"text/x-xu",mode:"mscgen",ext:["xu"]},{name:"msgenny",mime:"text/x-msgenny",mode:"mscgen",ext:["msgenny"]},{name:"WebAssembly",mime:"text/webassembly",mode:"wast",ext:["wat","wast"]}];for(var t=0;t<e.modeInfo.length;t++){var n=e.modeInfo[t];n.mimes&&(n.mime=n.mimes[0])}e.findModeByMIME=function(t){t=t.toLowerCase();for(var n=0;n<e.modeInfo.length;n++){var o=e.modeInfo[n];if(o.mime==t)return o;if(o.mimes)for(var a=0;a<o.mimes.length;a++)if(o.mimes[a]==t)return o}return/\+xml$/.test(t)?e.findModeByMIME("application/xml"):/\+json$/.test(t)?e.findModeByMIME("application/json"):void 0},e.findModeByExtension=function(t){t=t.toLowerCase();for(var n=0;n<e.modeInfo.length;n++){var o=e.modeInfo[n];if(o.ext)for(var a=0;a<o.ext.length;a++)if(o.ext[a]==t)return o}},e.findModeByFileName=function(t){for(var n=0;n<e.modeInfo.length;n++){var o=e.modeInfo[n];if(o.file&&o.file.test(t))return o}var a=t.lastIndexOf("."),i=a>-1&&t.substring(a+1,t.length);if(i)return e.findModeByExtension(i)},e.findModeByName=function(t){t=t.toLowerCase();for(var n=0;n<e.modeInfo.length;n++){var o=e.modeInfo[n];if(o.name.toLowerCase()==t)return o;if(o.alias)for(var a=0;a<o.alias.length;a++)if(o.alias[a].toLowerCase()==t)return o}}},"object"==r(t)&&"object"==r(e)?c(n(202)):(a=[n(202)],void 0===(i="function"===typeof(o=c)?o.apply(t,a):o)||(e.exports=i))}).call(this,n(359)(e))},1105:function(e,t,n){},1766:function(e,t,n){},1769:function(e,t,n){},1770:function(e,t,n){},1771:function(e,t,n){},1772:function(e,t,n){},1773:function(e,t,n){},1774:function(e,t,n){},1775:function(e,t,n){},1776:function(e,t,n){},1777:function(e,t,n){},1778:function(e,t,n){},1779:function(e,t,n){e.exports={container:"TableVerticalToolbar_container___tqTN","vertical-item":"TableVerticalToolbar_vertical-item__1FIe_",selected:"TableVerticalToolbar_selected__3RdQx","add-line":"TableVerticalToolbar_add-line__MEuYI","add-icon":"TableVerticalToolbar_add-icon__2zJ4i","select-all-btn":"TableVerticalToolbar_select-all-btn__2xxFd"}},1780:function(e,t,n){e.exports={container:"TableHorizontalToolbar_container__1FTfw","horizontal-item":"TableHorizontalToolbar_horizontal-item__359pz",selected:"TableHorizontalToolbar_selected__3bTao","add-line":"TableHorizontalToolbar_add-line__1vfLA","add-icon":"TableHorizontalToolbar_add-icon__P0RCO"}},1781:function(e,t,n){},1782:function(e,t,n){e.exports={"catalog-p":"index_catalog-p__1jcAk"}},1783:function(e,t,n){e.exports={"m-card__toolbar":"index_m-card__toolbar__1mfvO",select:"index_select__2C_JS","m-card__toolbar__addtext":"index_m-card__toolbar__addtext__2Qna4"}},1784:function(e,t,n){e.exports={container:"index_container__33mSy",content:"index_content__2ypGt",hoverContainer:"index_hoverContainer__258dT"}},1785:function(e,t,n){},1786:function(e,t,n){},1787:function(e,t,n){},1788:function(e,t,n){},1789:function(e,t,n){},1790:function(e,t,n){e.exports={btn:"index_btn__DsihL","btn--lock":"index_btn--lock__3Se_D",icon:"index_icon__20-MH"}},1816:function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return Ko}));var o=n(10),a=n(4),i=n(3),c=n(7),r=n(8),s=n(1),l=n.n(s),d=n(123),u=n(52),p=n(17),m=n(122),h=n(135),b=n(22),f=n(156),v=(n(1769),n(12)),j=n.n(v),g=n(20),x=n(457),O=n(67),y=n(106),C=n(51),N=n(1077),_=n(1076),k=n(819),I=n(818),w=n(1078),D=n(394),S=n(0),E=function(e){Object(c.a)(n,e);var t=Object(r.a)(n);function n(){var e;Object(a.a)(this,n);for(var o=arguments.length,i=new Array(o),c=0;c<o;c++)i[c]=arguments[c];return(e=t.call.apply(t,[this].concat(i))).state={isActive:!1},e._containerDivRef=function(t){e._containerDiv=t},e.toggleActive=function(t){e.setState({isActive:!e.state.isActive}),e.state.isActive||Object(O.d)()},e.insertTxt=function(t){Object(D.a)(e.props.editor),e.setState({isActive:!1}),Object(O.i)()},e.insertImage=function(t){Object(I.a)(e.props.editor),e.setState({isActive:!1}),Object(O.g)()},e.insertAlbum=function(t){Object(k.a)(e.props.editor),e.setState({isActive:!1}),Object(O.e)()},e.insertAlbums=function(t){Object(N.a)(e.props.editor),e.setState({isActive:!1}),Object(O.f)()},e.insertPanorama=function(t){Object(w.a)(e.props.editor),e.setState({isActive:!1}),Object(O.j)()},e.insertTable=function(t){Object(_.a)(e.props.editor),e.setState({isActive:!1}),Object(O.k)()},e.openEditorModuleBox=function(t){e.props.editor&&(C.f.triggerChange(x.b),e.setState({isActive:!1}),Object(O.h)())},e}return Object(i.a)(n,[{key:"componentDidMount",value:function(){var e=this;this._containerDiv&&(this.disposeClickoutside=Object(y.a)(this._containerDiv,(function(){e.setState({isActive:!1})})))}},{key:"componentWillUnmount",value:function(){this.disposeClickoutside()}},{key:"render",value:function(){var e=this.props.position,t=this.state.isActive,n={position:"absolute",left:e.left+"px",top:e.top+"px"},o=Object(g.a)("userInfo").editPrivilege,a=(void 0===o?{}:o).bigPic,i=void 0===a?0:a;return Object(S.jsxs)("div",{style:n,className:j()("fixed-toolbar",{active:t}),ref:this._containerDivRef,children:[Object(S.jsx)("button",{className:"btn-add",onClick:this.toggleActive,children:Object(S.jsx)("i",{className:"add-txt icon baike_icon_ins-module baike_icon_ins-module-add"})}),Object(S.jsxs)("div",{className:"toolar-container clearfix",children:[Object(S.jsx)("button",{className:"btn-icon",onClick:this.insertTxt,title:"\u63d2\u5165\u6bb5\u843d",children:Object(S.jsx)("i",{className:"icon baike_icon_ins-module baike_icon_ins-module-wenzikuai"})}),Object(S.jsx)("button",{className:"btn-icon",onClick:this.insertImage,title:"\u63d2\u5165\u56fe\u7247",children:Object(S.jsx)("i",{className:"icon baike_icon_ins-module baike_icon_ins-module-tupian"})}),Object(S.jsx)("button",{className:"btn-icon",onClick:this.insertAlbum,title:"\u63d2\u5165\u56fe\u518c",children:Object(S.jsx)("i",{className:"icon baike_icon_ins-module baike_icon_ins-module-tuce"})}),Object(S.jsx)("button",{className:"btn-icon",onClick:this.insertAlbums,title:"\u63d2\u5165\u56fe\u96c6",children:Object(S.jsx)("i",{className:"icon baike_icon_ins-module baike_icon_ins-module-tuji"})}),0!==i&&Object(S.jsx)("button",{className:"btn-icon",onClick:this.insertPanorama,title:"\u63d2\u5165\u5168\u666f\u56fe",children:Object(S.jsx)("i",{className:"icon baike_icon_ins-module baike_icon_ins-module-panorama"})}),Object(S.jsx)("button",{className:"btn-icon",onClick:this.insertTable,title:"\u63d2\u5165\u8868\u683c",children:Object(S.jsx)("i",{className:"icon baike_icon_ins-module baike_icon_ins-module-biaoge"})}),Object(S.jsx)("button",{className:"btn-icon",onClick:this.openEditorModuleBox,title:"\u63d2\u5165\u6a21\u5757",children:Object(S.jsx)("i",{className:"icon baike_icon_word baike_icon_word-module"})})]})]})}}]),n}(s.Component),M=n(183),L=n(76),T=n(210),R=n(45),A=n(61),B=n(27),P=n(41),z=function(e){return Object(P.b)(e,"lock-mask")},H=function(){function e(){var t=this;Object(a.a)(this,e),this._initToolbar=function(){var e=document.createElement("div");t.fixedToolbarDiv=e,document.body.appendChild(e)},this._destoryToolbar=function(e){t.fixedToolbarDiv&&(b.unmountComponentAtNode(t.fixedToolbarDiv),e&&document.body.removeChild(t.fixedToolbarDiv))},this.onSelectionChange=function(e){if(t.editor){var n=t.editor.context.root,o=Object(T.a)(n),a=Object(A.a)();if(o&&!z(o)&&a.collapsed&&a.startContainer!==n){var i=Object(M.a)(a.startContainer,n);if(i&&"element"===Object(L.a)(i)){var c=t._getPosition(i);t._refreshToolbar(c)}}else t._destoryToolbar()}},this._getPosition=function(e){var n=e.getBoundingClientRect(),o=n.height;return o=[].slice.call(e.childNodes).reduce((function(e,t){return t.clientHeight>e?t.clientHeight:e}),o),{left:t.editor.context.root.getBoundingClientRect().left+Object(f.a)()-27,top:n.top+o+Object(f.b)()-22}}}return Object(i.a)(e,[{key:"initialize",value:function(e){var t=this;this.editor=e,this.editorContentChangeServiceInsDispose=C.c.listenChange((function(){t.onSelectionChange()})),this._initToolbar()}},{key:"onPluginEvent",value:function(e,t){if(e===B.b.selectionchange.pluginEventName)this.onSelectionChange(t)}},{key:"dispose",value:function(){this._destoryToolbar(!0),this.editorContentChangeServiceInsDispose(),this.editor=null}},{key:"_refreshToolbar",value:function(e){b.render(Object(S.jsx)(E,{position:e,editor:this.editor}),this.fixedToolbarDiv)}}]),e}(),q=(n(1770),n(44)),W=n(49),F=n(38),U=n(15),Z=n(549),V=n(644),X=function(e){Object(c.a)(n,e);var t=Object(r.a)(n);function n(){var e;Object(a.a)(this,n);for(var o=arguments.length,i=new Array(o),c=0;c<o;c++)i[c]=arguments[c];return(e=t.call.apply(t,[this].concat(i)))._containerDivRef=function(t){e._containerDiv=t},e.onOk=function(){},e.handleChange=function(t,n){var o={};o[t]=n.target.value,e.setState(o)},e.modifyType=function(t){var n=e.props,o=n.editor,a=n.dom,i=n.onCancelCallback;o.triggleContentChange((function(){Object(W.a)(a,{"data-type":t}),Object(q.b)(a),i()}),"\u4fee\u6539\u516c\u5f0f\u6837\u5f0f".concat(t))},e.onDel=function(){var t=e.props,n=t.editor,o=t.dom,a=t.onCancelCallback;n.triggleContentChange((function(){o.remove(),a()}),"\u5220\u9664\u516c\u5f0f")},e.onEdit=function(){var t=e.props,n=t.editor,o=t.dom,a=t.math,i=t.onCancelCallback;Object(Z.c)(n,a,o),i()},e}return Object(i.a)(n,[{key:"componentDidMount",value:function(){var e=this.props.onCancelCallback;this._containerDiv&&(this.disposeClickoutside=Object(y.a)(this._containerDiv,(function(){e()})))}},{key:"componentWillUnmount",value:function(){this.disposeClickoutside()}},{key:"render",value:function(){var e=this,t=this.props,n=t.position,o=t.type,a={position:"absolute",left:n.left+"px",top:n.top+"px"};return Object(S.jsx)("div",{style:a,className:"math-toolbar",ref:this._containerDivRef,children:Object(S.jsxs)("div",{className:"toolbar-area",children:[Object(S.jsx)(F.b,{text:"\u5d4c\u5165\u884c\u5185",children:Object(S.jsx)("button",{className:j()("button",{active:o===V.b}),onClick:function(){e.modifyType(V.b)},children:Object(S.jsx)("i",{className:"icon baike_icon_word baike_icon_word-qianruneihang"})})}),Object(S.jsx)(F.b,{text:"\u5355\u72ec\u5360\u4e00\u884c",children:Object(S.jsx)("button",{className:j()("button",{active:o===V.a}),onClick:function(){e.modifyType(V.a)},children:Object(S.jsx)("i",{className:"icon baike_icon_word baike_icon_word-zhanyongyihang"})})}),Object(S.jsx)(F.b,{text:"\u7f16\u8f91",children:Object(S.jsx)("button",{className:j()("button"),onClick:function(){e.onEdit()},children:Object(S.jsx)("i",{className:"icon baike_icon_word baike_icon_word-bianji"})})}),Object(S.jsx)(F.b,{text:"\u5220\u9664",children:Object(S.jsx)("button",{title:"\u5220\u9664",className:j()("button",{active:"right"===o}),onClick:function(){e.onDel()},children:Object(S.jsx)("i",{className:"icon baike_icon_pic baike_icon_pic-shanchu1"})})})]})})}}]),n}(s.Component),Y=function(e,t){var n=t.dom,o=t.math,a=t.type,i=t.editor;return Object(U.i)({DialogContent:X,attrs:{math:o,type:a,position:e,dom:n,editor:i}})},J=n(572),Q=!1,K=null;var G=function(){Q||(Q=!0,document.addEventListener("drag",(function(e){}),!1),document.addEventListener("dragstart",(function(e){var t,n=e.target;t=n,Object(P.b)(t,"scapegoat-math")&&(K=n)}),!1),document.addEventListener("dragend",(function(e){}),!1),document.addEventListener("dragover",(function(e){var t=function(e){var t=null;return Object(J.a)(e,(function(e){if(1===e.nodeType){var n=e.tagName.toLowerCase();["p","li"].indexOf(n)>-1&&(t=e)}})),t}(e.target);K&&!t&&e.preventDefault()}),!1),document.addEventListener("dragenter",(function(e){}),!1),document.addEventListener("dragleave",(function(e){}),!1),document.addEventListener("drop",(function(e){K&&(K=null)}),!1))},$=n(64),ee=function(){function e(){var t=this;Object(a.a)(this,e),this._targetIsMath=function(e){var t=!1;return"IMG"===e.tagName&&Object(P.b)(e,"scapegoat-math")&&(t=!0),t},this.onClick=function(e){var n=e.target;if(t._targetIsMath(n)){e.stopPropagation();var o=n.dataset.math,a=n.dataset.type,i=t.editor,c=n.getBoundingClientRect(),r={left:c.left+Object(f.a)(),top:c.top+c.height+Object(f.b)()};Y(r,{dom:n,math:o,type:a||V.b,editor:i}).then((function(e){})).catch((function(e){}))}}}return Object(i.a)(e,[{key:"initialize",value:function(e){var t=this;this.editor=e,this.contentDiv=document.createElement("div"),this.allEventDisposer=[],this.allEventDisposer.push(Object($.b)(this.editor.context.root,"click",(function(e){t.onClick(e)}))),G()}},{key:"dispose",value:function(){this.allEventDisposer.forEach((function(e){Object($.a)(e.el,e.evt,e.fn)})),this.allEventDisposer=null,this.editor=null}}]),e}(),te=n(124),ne=n(820),oe=n(821),ae=n(822),ie=n(25),ce=n(215);function re(e,t){e.target.blur(),e.preventDefault(),U.p.info("\u4e0a\u4e00\u76ee\u5f55\u5df2\u88ab\u9501\u5b9a\uff0c\u6682\u4e0d\u652f\u6301\u5c06\u8be5\u4e00\u7ea7\u76ee\u5f55\u4fee\u6539\u4e3a\u4e8c\u7ea7\u76ee\u5f55\u6216\u6b63\u6587"),setTimeout((function(){Object(q.a)(t)}),20)}var se,le,de,ue,pe,me,he,be,fe=function(){function e(){var t=this;Object(a.a)(this,e),this.onKeydown=function(e){if(Object(ce.a)()){var n=t.editor.context,o=n.range,a=n.selectionModel;if(!n.isCollapsed){var i=a.startNode,c=a.endNode,r=a.startOffset,s=a.endOffset;i!==c&&(Object(ie.a)(i,["h2"])&&0===r&&null!==i&&void 0!==i&&i.previousSibling&&Object(P.b)(i.previousSibling,"lock")&&re(e,o),Object(ie.a)(c,["h2"])&&0===s&&null!==c&&void 0!==c&&c.previousSibling&&Object(P.b)(c.previousSibling,"lock")&&re(e,o))}}}}return Object(i.a)(e,[{key:"initialize",value:function(e){this.editor=e}},{key:"onPluginEvent",value:function(e,t){switch(e){case B.b.compositionstart.pluginEventName:case B.b.keydown.pluginEventName:this.onKeydown(t)}}},{key:"dispose",value:function(){this.editor=null}}]),e}(),ve=n(823),je=n(1102),ge=n(664),xe=(n(1771),n(6)),Oe=n.n(xe),ye=n(91),Ce=n(39),Ne=n(26),_e=function(){function e(){Object(a.a)(this,e)}return Object(i.a)(e,[{key:"initialize",value:function(e){this.editor=e;var t=e.context.root;this.allEventDisposer=[];var n=t.parentElement;this.marker=document.createElement("div"),n.insertBefore(this.marker,t)}},{key:"onPluginEvent",value:function(e,t){switch(e){case B.b.documentmousemove.pluginEventName:this.onMouseMove(t);break;case B.b.selectionchange.pluginEventName:this.onSelectionChange(t);break;case B.b.click.pluginEventName:this.handleClick(t);break;case B.b.drop.pluginEventName:this.removeOverlay()}}},{key:"dispose",value:function(){this.allEventDisposer.forEach((function(e){Object($.a)(e.el,e.evt,e.fn)})),this.allEventDisposer=null,this.editor=null}},{key:"handleClick",value:function(e){var t=this.editor.context.root,n=Object(A.a)();if(e.target===t&&n&&n.collapsed){var o=Object(M.a)(n.startContainer,t);if(!o)return;var a=o.getBoundingClientRect().top;if(e.clientY<a&&(o=o.previousSibling)&&Object(Ne.getFlaotInlineModule)(o).length>0){1===o.childNodes.length&&Object(Ne.isModule)(o.childNodes[0])&&Object(Ne.moduleDomIsRightInline)(o.childNodes[0])&&Object(Ce.a)(document.createTextNode(ye.a),o.childNodes[0]);var i=document.createRange();i.setStart(o,o.childNodes.length),i.setStart(o,o.childNodes.length),Object(q.a)(i)}}}},{key:"removeOverlay",value:function(){Object(b.render)(null,this.marker)}},{key:"onSelectionChange",value:function(e){var t=this.editor.context,n=t.root,o=t.range,a=t.selectionModel;if(document.activeElement===n&&Oe()(o,"commonAncestorContainer")!==n){if(null!==a&&void 0!==a&&a.startNode&&Object(R.a)(n,null===a||void 0===a?void 0:a.startNode)){var i=Object(M.a)(a.startNode,n);this.renderOverlay(i)}}else this.removeOverlay()}},{key:"onMouseMove",value:function(e){var t=this.editor.context,n=t.root,o=t.range;if(document.activeElement===n&&Oe()(o,"commonAncestorContainer")!==n){if(Object(R.a)(n,e.target)){for(var a=n.lastChild,i=parseInt(e.clientY),c=null;!c&&a;)i>parseInt(a.getBoundingClientRect().top)&&(c=a),a=a.previousSibling;this.renderOverlay(c)}}else this.removeOverlay()}},{key:"renderOverlay",value:function(e){if(e&&Object(R.a)(this.editor.context.root,e)&&Object(ie.a)(e,["p","h2","h3","ul","ol"])){var t=e.clientHeight;Object(Ne.getFlaotInlineModule)(e).length>0&&(t=[].slice.call(e.childNodes).reduce((function(e,t){return t.clientHeight>e?t.clientHeight:e}),t));var n=e.getBoundingClientRect(),o={left:n.left,top:n.top,width:n.width,height:t};this.addOverlay(o)}else this.removeOverlay()}},{key:"addOverlay",value:function(e){var t=this.editor.context.root.parentElement.getBoundingClientRect(),n=e.left-t.left,o=e.top-t.top-1,a=e.width,i=e.height+1,c={left:"".concat(n,"px"),top:"".concat(o,"px"),height:"".concat(i,"px")},r={left:"".concat(n+a,"px"),top:"".concat(o,"px"),height:"".concat(i,"px")},s={left:"".concat(n,"px"),top:"".concat(o,"px"),width:"".concat(a,"px")},l={left:"".concat(n,"px"),top:"".concat(o+i,"px"),width:"".concat(a,"px")};Object(b.render)(Object(S.jsxs)(S.Fragment,{children:[Object(S.jsx)("div",{className:"hover-overlay l",style:c}),Object(S.jsx)("div",{className:"hover-overlay r",style:r}),Object(S.jsx)("div",{className:"hover-overlay t",style:s}),Object(S.jsx)("div",{className:"hover-overlay b",style:l})]}),this.marker)}}]),e}(),ke=n(958),Ie=n(824),we=n(825),De=n(2),Se=n(5),Ee="dragpimage",Me="dragpalbum",Le="dragpalbum_image",Te="dragpanorama",Re="dragpalbums_album",Ae="dragtypeoneleveldom",Be="droppargraph",Pe="droppimage",ze="droppalbum",He="droppanorama",qe="dropalbums",We=n(142),Fe=function(e,t){var n=t.dragNode,o=t.dropNode,a=t.dragInfo;t.dropInfo;return xt(o),!Object(R.a)(o,n)&&(Object(Ne.getImageOrAlbumInlineModule)(o).length>0?(U.p.error("\u8be5\u6bb5\u843d\u5df2\u5305\u542b\u56fe\u7247\uff0c\u8bf7\u62d6\u52a8\u81f3\u56fe\u7247\u533a\u57df"),!1):(n.closest(".editor-module").remove(),void o.appendChild(Object(Ne.createInline)(a.nodeData))))},Ue=(se={},Object(Se.a)(se,Ee+"_"+Be,(function(e,t){var n=t.dragNode,o=t.dropNode,a=t.dragInfo,i=t.dropInfo;Fe(0,{dragNode:n,dropNode:o,dragInfo:a,dropInfo:i})})),Object(Se.a)(se,Me+"_"+Be,(function(e,t){var n=t.dragNode,o=t.dropNode,a=t.dragInfo,i=t.dropInfo;Fe(0,{dragNode:n,dropNode:o,dragInfo:a,dropInfo:i})})),Object(Se.a)(se,Le+"_"+Be,(function(e,t){!function(e,t){var n=t.dragNode,o=t.dropNode,a=t.dragInfo;if(t.dropInfo,xt(o),Object(R.a)(o,n));else if(Object(Ne.getImageOrAlbumInlineModule)(o).length>0)U.p.error("\u8be5\u6bb5\u843d\u5df2\u5305\u542b\u56fe\u7247\uff0c\u8bf7\u62d6\u52a8\u81f3\u56fe\u7247\u533a\u57df");else{o.appendChild(Object(Ne.createInline)(Object(We.e)(a.nodeData.picinfo)));var i=n.closest(".editor-module"),c=Object(Ne.getModuleInfo)(i);c.data.pics.splice(a.nodeData.index,1),0===c.data.pics.length?i.remove():(c.data.pics.filter((function(e){return e.isCover}))[0]||(c.data.pics[0].isCover=!0),i.change.update(c,"\u62d6\u52a8\u56fe\u7247"))}}(0,{dragNode:t.dragNode,dropNode:t.dropNode,dragInfo:t.dragInfo,dropInfo:t.dropInfo})})),Object(Se.a)(se,Re+"_"+Be,(function(e,t){!function(e,t){var n=t.dragNode,o=t.dropNode,a=t.dragInfo;if(t.dropInfo,xt(o),Object(R.a)(o,n));else if(Object(Ne.getImageOrAlbumInlineModule)(o).length>0)U.p.error("\u8be5\u6bb5\u843d\u5df2\u5305\u542b\u56fe\u7247\uff0c\u8bf7\u62d6\u52a8\u81f3\u56fe\u7247\u533a\u57df");else{o.appendChild(Object(Ne.createInline)(a.nodeData.albumInfo));var i=n.closest(".editor-module"),c=Object(Ne.getModuleInfo)(i);c.data.albums.splice(a.nodeData.index,1),0===c.data.albums.length?i.remove():i.change.update(c,"\u62d6\u52a8\u56fe\u96c6\u4e2d\u7684\u56fe\u518c")}}(0,{dragNode:t.dragNode,dropNode:t.dropNode,dragInfo:t.dragInfo,dropInfo:t.dropInfo})})),Object(Se.a)(se,Te+"_"+Be,(function(e,t){!function(e,t){var n=t.dragNode,o=t.dropNode,a=t.dragInfo;if(t.dropInfo,xt(o),Object(R.a)(o,n)||Object(Ne.getImageOrAlbumInlineModule)(o).length>0||"TD"===o.parentNode.nodeName)return!1;n.closest(".editor-module").remove(),o.appendChild(Object(Ne.createInline)(a.nodeData))}(0,{dragNode:t.dragNode,dropNode:t.dropNode,dragInfo:t.dragInfo,dropInfo:t.dropInfo})})),se),Ze=function(e,t){var n=t.dragNode,o=t.dropNode;t.dragInfo,t.dropInfo;return xt(o),!Object(R.a)(o,n)&&(!(Object(Ne.getImageOrAlbumInlineModule)(o).length>0)&&void gt(o))},Ve=(le={},Object(Se.a)(le,Ee+"_"+Be,(function(e,t){var n=t.dragNode,o=t.dropNode,a=t.dragInfo,i=t.dropInfo;Ze(0,{dragNode:n,dropNode:o,dragInfo:a,dropInfo:i})})),Object(Se.a)(le,Me+"_"+Be,(function(e,t){var n=t.dragNode,o=t.dropNode,a=t.dragInfo,i=t.dropInfo;Ze(0,{dragNode:n,dropNode:o,dragInfo:a,dropInfo:i})})),Object(Se.a)(le,Le+"_"+Be,(function(e,t){var n=t.dragNode,o=t.dropNode,a=t.dragInfo,i=t.dropInfo;Ze(0,{dragNode:n,dropNode:o,dragInfo:a,dropInfo:i})})),Object(Se.a)(le,Re+"_"+Be,(function(e,t){var n=t.dragNode,o=t.dropNode,a=t.dragInfo,i=t.dropInfo;Ze(0,{dragNode:n,dropNode:o,dragInfo:a,dropInfo:i})})),Object(Se.a)(le,Te+"_"+Be,(function(e,t){!function(e,t){var n=t.dragNode,o=t.dropNode;if(t.dragInfo,t.dropInfo,xt(o),Object(R.a)(o,n)||Object(Ne.getImageOrAlbumInlineModule)(o).length>0||"TD"===o.parentNode.nodeName)return!1;gt(o)}(0,{dragNode:t.dragNode,dropNode:t.dropNode,dragInfo:t.dragInfo,dropInfo:t.dropInfo})})),le),Xe=n(198),Ye=n.n(Xe),Je=(de={},Object(Se.a)(de,Ee+"_"+Pe,(function(e,t){!function(e,t){var n=t.dragNode,o=t.dropNode,a=t.dragInfo,i=t.dropInfo;if(xt(o),Object(R.a)(o,n));else{var c=o.closest(".editor-module"),r=o.closest("td");c.parentNode.replaceChild(Object(Ne.createInline)(Object(We.a)([Object(De.a)(Object(De.a)({},Ye()(i.nodeData.data,"url","desc","width","height","picId","id","owner")),{},{isCover:!0}),Object(De.a)({},Ye()(a.nodeData.data,"url","desc","width","height","picId","id","owner"))],i.nodeData.data.desc,"right"===i.nodeData.data.type||r?"right":"gallery")),c),n.closest(".editor-module").remove()}}(0,{dragNode:t.dragNode,dropNode:t.dropNode,dragInfo:t.dragInfo,dropInfo:t.dropInfo})})),Object(Se.a)(de,Me+"_"+Pe,(function(e,t){!function(e,t){var n=t.dragNode,o=t.dropNode,a=t.dragInfo,i=t.dropInfo;if(xt(o),Object(R.a)(o,n));else{a.nodeData.data.pics.unshift(Ye()(i.nodeData.data,"url","desc","width","height","picId","id","owner"));var c=o.closest(".editor-module");c.parentNode.replaceChild(Object(Ne.createInline)(a.nodeData),c),n.closest(".editor-module").remove()}}(0,{dragNode:t.dragNode,dropNode:t.dropNode,dragInfo:t.dragInfo,dropInfo:t.dropInfo})})),Object(Se.a)(de,Le+"_"+Pe,(function(e,t){!function(e,t){var n=t.dragNode,o=t.dropNode,a=t.dragInfo,i=t.dropInfo;if(xt(o),Object(R.a)(o,n));else{var c=o.closest(".editor-module");c.parentNode.replaceChild(Object(Ne.createInline)(Object(We.a)([Object(De.a)(Object(De.a)({},Ye()(i.nodeData.data,"url","desc","width","height","picId","id","owner")),{},{isCover:!0}),Object(De.a)({},Ye()(a.nodeData.picinfo,"url","desc","width","height","picId","id","owner"))],i.nodeData.data.desc,"right"===i.nodeData.data.type?"right":"gallery")),c);var r=n.closest(".editor-module"),s=Object(Ne.getModuleInfo)(r);s.data.pics.splice(a.nodeData.index,1),0===s.data.pics.length?r.remove():(s.data.pics.filter((function(e){return e.isCover}))[0]||(s.data.pics[0].isCover=!0),r.change.update(s,"\u62d6\u52a8\u56fe\u7247"))}}(0,{dragNode:t.dragNode,dropNode:t.dropNode,dragInfo:t.dragInfo,dropInfo:t.dropInfo})})),Object(Se.a)(de,Re+"_"+Pe,(function(e,t){!function(e,t){var n=t.dragNode,o=t.dropNode,a=t.dragInfo,i=t.dropInfo;if(xt(o),Object(R.a)(o,n));else{a.nodeData.albumInfo.data.pics.unshift(Object(De.a)({},Ye()(i.nodeData.data,"url","desc","width","height","picId","id","owner")));var c=o.closest(".editor-module");c.parentNode.replaceChild(Object(Ne.createInline)(a.nodeData.albumInfo),c);var r=n.closest(".editor-module"),s=Object(Ne.getModuleInfo)(r);s.data.albums.splice(a.nodeData.index,1),0===s.data.albums.length?r.remove():r.change.update(s,"\u62d6\u52a8\u56fe\u96c6\u4e2d\u7684\u56fe\u518c")}}(0,{dragNode:t.dragNode,dropNode:t.dropNode,dragInfo:t.dragInfo,dropInfo:t.dropInfo})})),de),Qe=function(e,t){var n=t.dragNode,o=t.dropNode;t.dragInfo,t.dropInfo;if(xt(o),Object(R.a)(o,n))return!1;gt(o)},Ke=(ue={},Object(Se.a)(ue,Ee+"_"+Pe,(function(e,t){var n=t.dragNode,o=t.dropNode,a=t.dragInfo,i=t.dropInfo;Qe(0,{dragNode:n,dropNode:o,dragInfo:a,dropInfo:i})})),Object(Se.a)(ue,Me+"_"+Pe,(function(e,t){var n=t.dragNode,o=t.dropNode,a=t.dragInfo,i=t.dropInfo;Qe(0,{dragNode:n,dropNode:o,dragInfo:a,dropInfo:i})})),Object(Se.a)(ue,Le+"_"+Pe,(function(e,t){var n=t.dragNode,o=t.dropNode,a=t.dragInfo,i=t.dropInfo;Qe(0,{dragNode:n,dropNode:o,dragInfo:a,dropInfo:i})})),Object(Se.a)(ue,Re+"_"+Pe,(function(e,t){var n=t.dragNode,o=t.dropNode,a=t.dragInfo,i=t.dropInfo;Qe(0,{dragNode:n,dropNode:o,dragInfo:a,dropInfo:i})})),ue),Ge=(pe={},Object(Se.a)(pe,Ee+"_"+ze,(function(e,t){!function(e,t){t.store;var n=t.dragNode,o=t.dropNode,a=t.dragInfo,i=t.dropInfo;if(xt(o),Object(R.a)(o,n));else{i.nodeData.data.pics.push(Object(De.a)({},Ye()(a.nodeData.data,"desc","url","width","height","picId","id","owner")));var c=o.closest(".editor-module");c.parentNode.replaceChild(Object(Ne.createInline)(i.nodeData),c),n.closest(".editor-module").remove()}}(0,{store:t.store,dragNode:t.dragNode,dropNode:t.dropNode,dragInfo:t.dragInfo,dropInfo:t.dropInfo})})),Object(Se.a)(pe,Me+"_"+ze,(function(e,t){!function(e,t){t.store;var n=t.dragNode,o=t.dropNode,a=t.dragInfo,i=t.dropInfo;if(xt(o),Object(R.a)(o,n));else{a.nodeData.data.pics.forEach((function(e){i.nodeData.data.pics.push(Object(De.a)({},Ye()(e,"url","desc","width","height","picId","id","owner")))}));var c=o.closest(".editor-module");c.parentNode.replaceChild(Object(Ne.createInline)(i.nodeData),c),n.closest(".editor-module").remove()}}(0,{store:t.store,dragNode:t.dragNode,dropNode:t.dropNode,dragInfo:t.dragInfo,dropInfo:t.dropInfo})})),Object(Se.a)(pe,Le+"_"+ze,(function(e,t){!function(e,t){t.store;var n=t.dragNode,o=t.dropNode,a=t.dragInfo,i=t.dropInfo;if(xt(o),Object(R.a)(o,n));else{i.nodeData.data.pics.push(Object(De.a)({},Ye()(a.nodeData.picinfo,"url","desc","width","height","picId","id","owner")));var c=o.closest(".editor-module");c.parentNode.replaceChild(Object(Ne.createInline)(i.nodeData),c);var r=n.closest(".editor-module"),s=Object(Ne.getModuleInfo)(r);s.data.pics.splice(a.nodeData.index,1),0===s.data.pics.length?r.remove():(s.data.pics.filter((function(e){return e.isCover}))[0]||(s.data.pics[0].isCover=!0),r.change.update(s,"\u62d6\u52a8\u56fe\u7247"))}}(0,{store:t.store,dragNode:t.dragNode,dropNode:t.dropNode,dragInfo:t.dragInfo,dropInfo:t.dropInfo})})),Object(Se.a)(pe,Re+"_"+ze,(function(e,t){!function(e,t){t.store;var n=t.dragNode,o=t.dropNode,a=t.dragInfo,i=t.dropInfo;if(xt(o),Object(R.a)(o,n));else{a.nodeData.albumInfo.data.pics.forEach((function(e){i.nodeData.data.pics.push(Object(De.a)({},Ye()(e,"url","desc","width","height","picId","id","owner")))}));var c=o.closest(".editor-module");c.parentNode.replaceChild(Object(Ne.createInline)(i.nodeData),c);var r=n.closest(".editor-module"),s=Object(Ne.getModuleInfo)(r);s.data.albums.splice(a.nodeData.index,1),0===s.data.albums.length?r.remove():r.change.update(s,"\u62d6\u52a8\u56fe\u96c6\u4e2d\u7684\u56fe\u518c")}}(0,{store:t.store,dragNode:t.dragNode,dropNode:t.dropNode,dragInfo:t.dragInfo,dropInfo:t.dropInfo})})),pe),$e=function(e,t){t.store;var n=t.dragNode,o=t.dropNode;t.dragInfo,t.dropInfo;if(xt(o),Object(R.a)(o,n))return!1;gt(o)},et=(me={},Object(Se.a)(me,Ee+"_"+ze,(function(e,t){var n=t.store,o=t.dragNode,a=t.dropNode,i=t.dragInfo,c=t.dropInfo;$e(0,{store:n,dragNode:o,dropNode:a,dragInfo:i,dropInfo:c})})),Object(Se.a)(me,Me+"_"+ze,(function(e,t){var n=t.store,o=t.dragNode,a=t.dropNode,i=t.dragInfo,c=t.dropInfo;$e(0,{store:n,dragNode:o,dropNode:a,dragInfo:i,dropInfo:c})})),Object(Se.a)(me,Le+"_"+ze,(function(e,t){var n=t.store,o=t.dragNode,a=t.dropNode,i=t.dragInfo,c=t.dropInfo;$e(0,{store:n,dragNode:o,dropNode:a,dragInfo:i,dropInfo:c})})),Object(Se.a)(me,Re+"_"+ze,(function(e,t){var n=t.store,o=t.dragNode,a=t.dropNode,i=t.dragInfo,c=t.dropInfo;$e(0,{store:n,dragNode:o,dropNode:a,dragInfo:i,dropInfo:c})})),me),tt=function(e){var t=e.length>=30;return t&&U.p.error("\u6700\u591a\u6dfb\u52a030\u4e2a\u56fe\u518c\uff0c\u5df2\u8fbe\u4e0a\u9650"),!t},nt=(he={},Object(Se.a)(he,Me+"_"+qe,(function(e,t){!function(e,t){t.store;var n=t.dragNode,o=t.dropNode,a=t.dragInfo,i=t.dropInfo;if(xt(o),Object(R.a)(o,n));else{if(!tt(i.nodeData.data.albums))return;a.nodeData.data.type="right",i.nodeData.data.albums.push(a.nodeData),o.closest(".editor-module").change.update(i.nodeData,"\u62d6\u52a8\u56fe\u518c\u5230\u56fe\u96c6"),n.closest(".editor-module").remove()}}(0,{store:t.store,dragNode:t.dragNode,dropNode:t.dropNode,dragInfo:t.dragInfo,dropInfo:t.dropInfo})})),Object(Se.a)(he,Re+"_"+qe,(function(e,t){!function(e,t){t.store;var n=t.dragNode,o=t.dropNode,a=t.dragInfo,i=t.dropInfo;if(xt(o),Object(R.a)(o,n));else{if(!tt(i.nodeData.data.albums))return;i.nodeData.data.albums.push(a.nodeData.albumInfo),o.closest(".editor-module").change.update(i.nodeData,"\u62d6\u52a8\u56fe\u518c\u5230\u56fe\u96c6");var c=n.closest(".editor-module"),r=Object(Ne.getModuleInfo)(c);r.data.albums.splice(a.nodeData.index,1),0===r.data.albums.length?c.remove():c.change.update(r,"\u62d6\u52a8\u56fe\u96c6\u4e2d\u7684\u56fe\u518c")}}(0,{store:t.store,dragNode:t.dragNode,dropNode:t.dropNode,dragInfo:t.dragInfo,dropInfo:t.dropInfo})})),he),ot=function(e,t){t.store;var n=t.dragNode,o=t.dropNode;t.dragInfo,t.dropInfo;if(xt(o),Object(R.a)(o,n))return!1;gt(o)},at=(be={},Object(Se.a)(be,Me+"_"+qe,(function(e,t){var n=t.store,o=t.dragNode,a=t.dropNode,i=t.dragInfo,c=t.dropInfo;ot(0,{store:n,dragNode:o,dropNode:a,dragInfo:i,dropInfo:c})})),Object(Se.a)(be,Re+"_"+qe,(function(e,t){var n=t.store,o=t.dragNode,a=t.dropNode,i=t.dragInfo,c=t.dropInfo;ot(0,{store:n,dragNode:o,dropNode:a,dragInfo:i,dropInfo:c})})),be),it=Object(De.a)(Object(De.a)(Object(De.a)(Object(De.a)({},Ue),Je),Ge),nt),ct=Object(De.a)(Object(De.a)(Object(De.a)(Object(De.a)({},Ve),Ke),et),at),rt=function(e,t,n){if(e){var o=e.__bkeditorstore;return o||(o=e.__bkeditorstore={}),void 0!==n?(o[t]=n,o[t]):o[t]}},st="data-dnd-drag-tag",lt="data-dnd-drag-type",dt="data-dnd-drag-info",ut="data-dnd-drop-tag",pt="data-dnd-drop-type",mt="data-dnd-drop-info",ht=function(e,t,n){Object(W.a)(e,{draggable:"true"}),rt(e,st,"true"),rt(e,lt,t),rt(e,dt,n)},bt=function(e,t,n){rt(e,ut,"true"),rt(e,pt,t),rt(e,mt,n)},ft=(n(1772),n(179)),vt=n(541),jt="bke-dnd-img-or-album",gt=function(e){Object(P.a)(e,"".concat(jt))},xt=function(){var e="".concat(jt);[].slice.call(document.getElementsByClassName(e)).forEach((function(t){Object(P.c)(t,e)}),undefined)},Ot=function(){function e(){Object(a.a)(this,e),this.dragNode=null}return Object(i.a)(e,[{key:"bindDropTarget",value:function(e){var t=this.editor.context.root;Object(ie.a)(e,["p"])&&(e.parentNode===t||Object(ie.a)(e.parentNode,["td"]))&&bt(e,Be,{})}},{key:"getNodeCanDrop",value:function(e){var t=this;this.bindDropTarget(e);var n=[];return Object(J.a)(e,(function(e){e&&rt(e,ut)&&"true"===rt(e,ut)&&[Be,Pe,ze,qe,He].indexOf(rt(e,pt))>-1&&(Object(R.a)(t.dragNode,e)||n.push(e))})),n.length>0?n[0]:null}},{key:"getNodeCanDrag",value:function(e){var t=null;return e&&rt(e,st)&&"true"===rt(e,st)&&[Ee,Me,Le,Te,Re].indexOf(rt(e,lt))>-1&&(t=e),t}},{key:"dropDeal",value:function(e,t,n){var o=it[rt(t,lt)+"_"+rt(n,pt)];if(o){var a=Object(ft.a)(t),i=Object(ft.a)(n);o(e,{dragNode:t,dropNode:n,dragInfo:rt(t,dt),dropInfo:rt(n,mt)}),a.__editor.__collectDirtyDomService.addDirtyEle(t),i.__editor.__collectDirtyDomService.addDirtyEle(n),a.__editor===i.__editor?a.__editor.triggleContentChange((function(){}),p.a.drop):(a.__editor.triggleContentChange((function(){}),p.a.drop),i.__editor.triggleContentChange((function(){}),p.a.drop))}}},{key:"dragenterDeal",value:function(e,t,n){var o=ct[rt(t,lt)+"_"+rt(n,pt)];o&&o(e,{dragNode:t,dropNode:n,dragInfo:rt(t,dt),dropInfo:rt(n,mt)})}},{key:"initialize",value:function(e){var t=this;this.editor=e,this.allEventDisposer=[],this.allEventDisposer.push(Object($.b)(this.editor.context.root,"drag",(function(e){}))),this.allEventDisposer.push(Object($.b)(this.editor.context.root,"dragstart",(function(e){(t.dragNode=t.getNodeCanDrag(e.target),t.dragNode)&&(Object(vt.a)(),Object(ft.a)(t.dragNode).__editor.__collectDirtyDomService.addDirtyEle(t.dragNode))}))),this.allEventDisposer.push(Object($.b)(this.editor.context.root,"dragover",(function(e){t.dragNode&&e.preventDefault()}))),this.allEventDisposer.push(Object($.b)(this.editor.context.root,"dragenter",(function(e){if(t.dragNode){var n=t.getNodeCanDrop(e.target);n?(e.preventDefault(),t.dragenterDeal(e,t.dragNode,n)):xt()}}))),this.allEventDisposer.push(Object($.b)(this.editor.context.root,"dragleave",(function(e){t.dragNode&&(t.getNodeCanDrop(e.target)||e.preventDefault())}))),this.allEventDisposer.push(Object($.b)(this.editor.context.root,"drop",(function(e){if(t.dragNode){var n=t.getNodeCanDrop(e.target);n&&(e.preventDefault(),t.dropDeal(e,t.dragNode,n))}t.dragNode=null})))}},{key:"dispose",value:function(){this.allEventDisposer.forEach((function(e){Object($.a)(e.el,e.evt,e.fn)})),this.allEventDisposer=null,this.editor=null}}]),e}(),yt=(n(1773),n(223)),Ct=n(386),Nt=n(35),_t="drag-overlay-for-block-module";new Image(1e3,1e3).src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABgAAAAYCAYAAADgdz34AAAAAXNSR0IArs4c6QAAARdJREFUSA3tlckOgyAQhrHLG/gOXjy6XLukz97NoxcfQ29qKp2fMESqiSaQ9tJJyMAo3z8MBAIhREBNFEUxwPuyJEk2YO00UInEceyFX5YlOGBKpaIHCPo0lfTXBHxmbrF4BVbQ5+AvsFjNf4l+XyK+ixYzmftB3zlzn0zMSQCUMAwNbBgG0TSN7Pv+yUFvp2gMT9P04FUA8LquZdu2D4IfCY63RULEeQUMp7Lc8zw/EfOlm3rAnAWQedd1tyzLzp9wGktrk9ecCppkGWV+pcwvFBxnjvKoEuHVQdtS22uvXiLqL1oURaKqKgbDc+0VHAAWQKmwGvi1Agxh8AROLCPAQmvhmMsGIbWh5FmUvxkBE3DoTOBgvQECKmgiXjg1/QAAAABJRU5ErkJggg==";var kt=function(){function e(){Object(a.a)(this,e),this.dragInfo={ele:null}}return Object(i.a)(e,[{key:"getNodeCanDrag",value:function(e){var t=null;return Object(J.a)(e,(function(e){var n=!1;return e&&rt(e,st)&&"true"===rt(e,st)&&[Ae].indexOf(rt(e,lt))>-1&&(t=e,n=!0),n})),t}},{key:"getNodeCanDrop",value:function(e){var t=this.editor.context.root,n=e.closest("p")||e.closest("h2")||e.closest("h3");return n&&n.parentNode===t&&!Object(R.a)(this.dragInfo.ele,n)?n:null}},{key:"initialize",value:function(e){var t=this;this.editor=e;var n=e.context.root;this.allEventDisposer=[];var o=n.parentElement;this.marker=document.createElement("div"),o.appendChild(this.marker),this.allEventDisposer.push(Object($.b)(document,"dragstart",(function(e){if(t.dragNode=t.getNodeCanDrag(e.target),t.dragNode){try{e.dataTransfer.setData("text/plain",ye.a)}catch(o){}try{t.virualDargImage=t.dragInfo.ele.cloneNode(!0);var n=t.dragInfo.ele.getBoundingClientRect();t.virualDargImage.style.width=n.width+"px",t.virualDargImage.style.height=n.height+"px",t.virualDargImage.style.backgroundColor="#fff",t.virualDargImage.style.opacity=.4,t.virualDargImage.style.position="absolute",t.virualDargImage.style.top="0px",t.virualDargImage.style.left="-10000px",document.body.appendChild(t.virualDargImage),t.virualDargImage.innerHTML="",e.dataTransfer.setDragImage(t.virualDargImage,0,0)}catch(o){}}}))),this.allEventDisposer.push(Object($.b)(document,"drop",(function(e){if(t.dragNode){var n=t.getNodeCanDrop(e.target);n?setTimeout((function(){var e=t.dragInfo.ele,o=Object(ft.a)(e),a=Object(A.a)();a.deleteContents(),setTimeout((function(){var e=Object(Ct.a)(n,a);e[0]&&(n.innerHTML=e[0]),e[2]&&Object(Ce.a)(Object(Nt.a)(n.tagName.toLowerCase(),e[2]),n),Object(q.b)(n.childNodes[n.childNodes.length-1]),Object(Ce.a)(t.dragInfo.ele,n),o.__editor.triggleContentChange((function(){}),p.a.drop)}),0)}),0):e.preventDefault(),t.dragNode=null,t.removeOverlay()}})))}},{key:"onPluginEvent",value:function(e,t){switch(e){case B.b.documentmousemove.pluginEventName:this.renderOverlay(t);break;case B.a.ContentChange:this.removeOverlay()}}},{key:"dispose",value:function(){this.allEventDisposer.forEach((function(e){Object($.a)(e.el,e.evt,e.fn)})),this.allEventDisposer=null,this.editor=null}},{key:"removeOverlay",value:function(e){Object(b.render)(null,this.marker),this.virualDargImage&&this.virualDargImage.remove()}},{key:"renderOverlay",value:function(e){var t=this.editor.context.root;if(Object(R.a)(t,e.target)){var n=e.target.closest("section");if(n&&Object(yt.b)(n)){var o=n.clientHeight,a=n.getBoundingClientRect(),i={left:a.left,top:a.top,width:a.width,height:o};this.addOverlay(i),this.dragInfo={ele:n},ht(this.marker,Ae,{})}}}},{key:"addOverlay",value:function(e){var t=this.editor.context.root.parentElement.getBoundingClientRect(),n=e.left-t.left+20,o=e.top-t.top,a=e.width-20,i=e.height,c={left:"".concat(n,"px"),top:"".concat(o,"px"),width:"".concat(a,"px")},r={left:"".concat(n,"px"),top:"".concat(o+i,"px"),width:"".concat(a,"px")};Object(b.render)(Object(S.jsxs)(S.Fragment,{children:[Object(S.jsx)("div",{className:"".concat(_t," t"),style:c}),Object(S.jsx)("div",{className:"".concat(_t," b"),style:r})]}),this.marker)}}]),e}(),It=n(465),wt=n(151),Dt=n(73),St=n(159),Et=n(162),Mt=n(665),Lt=n(957),Tt=n(14),Rt=(n(1774),n(88)),At=n(82),Bt=n(21),Pt=n.n(Bt),zt=n(24);function Ht(e){return e.parentNode.parentNode.parentNode.parentNode.parentNode}var qt=function(e){Object(c.a)(n,e);var t=Object(r.a)(n);function n(){return Object(a.a)(this,n),t.apply(this,arguments)}return Object(i.a)(n,[{key:"render",value:function(){var e=this.props,t=e.type,n=e.modifyType,o=e.remove,a=e.modifyMap;return Object(S.jsxs)("div",{className:"m-map__toolbar clearfix "+t,children:[Object(S.jsx)("div",{className:"toolbar-area",children:Object(S.jsx)("button",{className:"button",onClick:a,children:Object(S.jsx)(F.b,{text:"\u7f16\u8f91",popupClassName:"map-tooltip",getPopupContainer:Ht,children:Object(S.jsx)("i",{className:"icon baike_icon_pic baike_icon_pic-tupianbianji"})})})}),Object(S.jsxs)("div",{className:"toolbar-area",children:[Object(S.jsx)("button",{className:j()("button",{active:"big"===t}),onClick:function(){n("big")},children:Object(S.jsx)(F.b,{text:"\u5927\u56fe",popupClassName:"map-tooltip",getPopupContainer:Ht,children:Object(S.jsx)("i",{className:"icon baike_icon_pic baike_icon_pic-juzhongpingpu"})})}),Object(S.jsx)("button",{className:j()("button",{active:"small"===t}),onClick:function(){n("small")},children:Object(S.jsx)(F.b,{text:"\u5c0f\u56fe",popupClassName:"map-tooltip",getPopupContainer:Ht,children:Object(S.jsx)("i",{className:"icon baike_icon_pic baike_icon_pic-juyou"})})})]}),Object(S.jsx)("div",{className:"toolbar-area",children:Object(S.jsx)("button",{className:"button",onClick:o,children:Object(S.jsx)(F.b,{text:"\u5220\u9664",popupClassName:"map-tooltip",getPopupContainer:Ht,children:Object(S.jsx)("i",{className:"icon baike_icon_pic baike_icon_pic-shanchu1"})})})})]})}}]),n}(s.Component),Wt=function(e){Object(c.a)(n,e);var t=Object(r.a)(n);function n(e){var o;return Object(a.a)(this,n),(o=t.call(this,e)).onScriptLoad=function(){o.initMap(),o.script.removeEventListener("load",o.onScriptLoad)},o.openInfoWindow=function(){o.marker.openInfoWindow(o.infoWin)},o.initMap=function(){var e={},t=o.props.node,n=new window.BMap.Point(t.data.address.point.lng,t.data.address.point.lat);"small"===o.type&&(e={enableMapClick:!1});var a=new window.BMap.Icon("https://baikebcs.bdimg.com/cms/wiki-react-editor/img/map.svg",new window.BMap.Size(14,21),{imageOffset:{width:0,height:-220}});if(o.marker=new window.BMap.Marker(n,{icon:a}),o.map=new window.BMap.Map("J-map-api-"+o.uuid,e),o.map.addOverlay(o.marker),o.map.centerAndZoom(n,14),o.map.addControl(new window.BMap.NavigationControl({anchor:BMAP_ANCHOR_TOP_LEFT,type:BMAP_NAVIGATION_CONTROL_SMALL})),"big"===o.type){o.map.centerAndZoom(n,15);var i='<h4 class="address-title big">'.concat(t.data.address.title,'\n            <a class="address-link" href="').concat(t.data.address.detailUrl,'" target="_blank">\u8be6\u60c5</a></h4>\n            <p class="address-detail">').concat(t.data.address.address,"</p>\n            ");o.infoWin=new window.BMap.InfoWindow(i,{width:420}),o.marker.addEventListener("click",o.openInfoWindow),o.openInfoWindow()}},o.modifyType=function(e){if(e!==o.props.node.data.type){var t=Pt()(o.props.node);t.data.type=e,o.updateData(t)}},o.modifyMap=function(){var e=o.props.node;Object(U.m)({address:e.data.address}).then((function(e){var t=Pt()(o.props.node);t.data.address=e.address,o.updateData(t)})).catch((function(e){}))},o.remove=function(){o.props.change.delete()},o.updateData=function(e){o.props.change.update(e,"\u4fee\u6539\u5730\u56fe")},o.map=null,o.marker=null,o.infoWin=null,o.type=o.props.node.data.type,o.uid=o.props.node.data.address.uid,o.script=null,o.uuid=Object(zt.a)(),o}return Object(i.a)(n,[{key:"componentDidMount",value:function(){var e=document.getElementById("mapApi");e?(this.script=e,window.BMap?this.initMap():this.script.addEventListener("load",this.onScriptLoad)):(this.script=document.createElement("script"),this.script.id="mapApi",window.BMAP_PROTOCOL="https",this.script.src="https://api.map.baidu.com/getscript?v=3.0&ak=3GoY1jmZ5rBRSmrMfgzNXZZgXvpKtFxl",this.script.addEventListener("load",this.onScriptLoad),document.body.appendChild(this.script))}},{key:"componentWillUnmount",value:function(){this.marker.removeEventListener("click",this.openInfoWindow)}},{key:"componentDidUpdate",value:function(){this.type!==this.props.node.data.type&&(this.type=this.props.node.data.type,this.marker.removeEventListener("click",this.openInfoWindow),this.initMap()),this.uid!==this.props.node.data.address.uid&&(this.marker.removeEventListener("click",this.openInfoWindow),this.initMap(),this.uid=this.props.node.data.address.uid)}},{key:"render",value:function(){var e=this.props.node,t=e.data.type,n={type:e.data.type,remove:this.remove,modifyType:this.modifyType,modifyMap:this.modifyMap};return Object(S.jsx)("div",{className:"map-container",id:this.uuid,children:Object(S.jsx)(At.a,{blurDelay:.01,forceRender:!0,popupClassName:"module-toolbar",popupPlacement:"topLeft",action:["hover"],builtinPlacements:Rt.a,popup:Object(S.jsx)(qt,Object(De.a)({},n)),children:Object(S.jsxs)("div",{className:"map-trigger-container",children:["big"===t&&Object(S.jsx)("div",{id:"J-map-api-"+this.uuid,className:"map-api-container"}),"small"===t&&Object(S.jsxs)("div",{className:"map-small-container",children:[Object(S.jsx)("div",{id:"J-map-api-"+this.uuid,className:"map-small-api-container"}),Object(S.jsxs)("div",{className:"map-small-info",children:[Object(S.jsx)("h4",{className:"address-title",children:e.data.address.title}),Object(S.jsx)("p",{className:"address-detail small",children:e.data.address.address}),Object(S.jsx)("a",{className:"small-address-link",href:e.data.address.detailUrl,target:"_blank",children:"\u8be6\u60c5"})]})]})]})})})}}]),n}(s.Component),Ft=n(100),Ut=n(826),Zt=n(730),Vt={},Xt={clike:"C\u3001Java",commonlisp:"lisp",coffeescript:"coffee",css:"css",python:"python",sql:"sql",javascript:"javascript",jsx:"jsx"},Yt=["null","clike","go","python","php","sql","javascript","perl","jsx","lua","markdown","erlang","commonlisp","htmlmixed","css","dart","diff","dockerfile"];Zt.a.modeInfo.forEach((function(e){Yt.indexOf(e.mode)>-1&&(Vt[e.mode]||(Vt[e.mode]=[]),Vt[e.mode].push(e.name))}));var Jt=[];for(var Qt in Vt)Vt.hasOwnProperty(Qt)&&Jt.push({mode:Qt,language:Vt[Qt].join("\u3001")});Jt.sort((function(e,t){return Yt.indexOf(e.mode)-Yt.indexOf(t.mode)}));var Kt=[];Jt.forEach((function(e){var t=e.language;Xt[e.mode]&&(t=Xt[e.mode]),Kt.push(Object(S.jsx)(Ft.a,{value:e.mode,title:e.language,children:t},e.mode))}));var Gt=Kt;n(1775);function $t(e){return document.body}var en=function(e){Object(c.a)(n,e);var t=Object(r.a)(n);function n(){return Object(a.a)(this,n),t.apply(this,arguments)}return Object(i.a)(n,[{key:"render",value:function(){var e=this.props.remove;return Object(S.jsx)("div",{className:"clearfix m-code__toolbar",children:Object(S.jsx)("div",{className:"toolbar-area",children:Object(S.jsx)("button",{className:"button",onClick:e,children:Object(S.jsx)(F.b,{text:"\u5220\u9664",popupClassName:"map-tooltip",getPopupContainer:$t,children:Object(S.jsx)("i",{className:"icon baike_icon_pic baike_icon_pic-shanchu1"})})})})})}}]),n}(s.Component),tn=(n(1776),n(196)),nn=n.n(tn),on=function(e){Object(c.a)(n,e);var t=Object(r.a)(n);function n(){var e;Object(a.a)(this,n);for(var o=arguments.length,i=new Array(o),c=0;c<o;c++)i[c]=arguments[c];return(e=t.call.apply(t,[this].concat(i))).onChange=nn()((function(t){var n=e.props,o=n.node;n.change.update(Object(De.a)(Object(De.a)({},o),{},{data:Object(De.a)(Object(De.a)({},o.data),{},{value:t})}),"\u4fee\u6539\u4ee3\u7801")}),200),e.onChangeMode=function(t){var n=e.props,o=n.node;n.change.update(Object(De.a)(Object(De.a)({},o),{},{data:Object(De.a)(Object(De.a)({},o.data),{},{mode:t})}),"\u4fee\u6539\u4ee3\u7801\u8bed\u8a00")},e.remove=function(){e.props.change.delete()},e}return Object(i.a)(n,[{key:"render",value:function(){var e=this.props.node,t=Oe()(e,"data.value")||"",n={lineNumbers:!0,mode:Oe()(e,"data.mode")||"null"},o={remove:this.remove};return Object(S.jsx)("div",{className:"code-block",children:Object(S.jsx)(At.a,{blurDelay:.01,forceRender:!0,popupClassName:"module-toolbar",popupPlacement:"topLeft",action:["hover"],builtinPlacements:Rt.a,popup:Object(S.jsx)(en,Object(De.a)({},o)),children:Object(S.jsxs)("div",{className:"code-container",children:[Object(S.jsxs)("div",{className:"code__head",children:[Object(S.jsx)("section",{className:"code__head__title",children:"\u4ee3\u7801\u5757"}),Object(S.jsx)(Ft.b,{className:"code__head__mode",title:"\u6807\u9898",value:n.mode,optionLabelProp:"children",onChange:this.onChangeMode,showSearch:!1,children:Gt})]}),Object(S.jsx)("div",{className:"code__body",children:Object(S.jsx)(Ut.a,{options:n,value:t,onChange:this.onChange})})]})})})}}]),n}(s.Component),an=(n(1777),n(282),n(1778),n(437)),cn=n(438),rn=n(408),sn=n(729),ln=Object(S.jsx)("svg",{className:"svg-icon",width:"100%",height:"100%",viewBox:"0 0 14 15",children:Object(S.jsx)("g",{stroke:"none",strokeWidth:"1",fill:"none",children:Object(S.jsx)("g",{transform:"translate(-878.000000, -416.000000)",children:Object(S.jsx)("g",{transform:"translate(628.000000, 407.000000)",children:Object(S.jsxs)("g",{transform:"translate(249.000000, 9.000000)",children:[Object(S.jsx)("path",{d:"M1,14.5 L1,14.5 C1,14.2238576 1.22385763,14 1.5,14 L9,14 C9.27614237,14 9.5,13.7761424 9.5,13.5 L9.5,6 C9.5,5.72385763 9.72385763,5.5 10,5.5 L10,5.5 C10.2761424,5.5 10.5,5.72385763 10.5,6 L10.5,13.5 C10.5,14.3284271 9.82842712,15 9,15 L1.5,15 C1.22385763,15 1,14.7761424 1,14.5 Z",fill:"#CCCCCC"}),Object(S.jsx)("rect",{stroke:"#666666",x:"7.5",y:"1",width:"7",height:"3"}),Object(S.jsx)("path",{d:"M3.5,2 L5,2 C5.27614237,2 5.5,2.22385763 5.5,2.5 C5.5,2.77614237 5.27614237,3 5,3 L3.5,3 L3.5,5 L1,2.5 L3.5,0 L3.5,2 Z",fill:"#666666"}),Object(S.jsx)("path",{d:"M10,10 L10,11 L1.5,11 C1.22385763,11 1,10.7761424 1,10.5 C1,10.2238576 1.22385763,10 1.5,10 L10,10 Z M10,6 L10,7 L1.5,7 C1.22385763,7 1,6.77614237 1,6.5 C1,6.22385763 1.22385763,6 1.5,6 L10,6 Z",fill:"#CCCCCC"})]})})})})}),dn=Object(S.jsx)("svg",{className:"svg-icon",width:"100%",height:"100%",viewBox:"0 0 14 15",children:Object(S.jsx)("g",{stroke:"none",strokeWidth:"1",fill:"none",fillRule:"evenodd",children:Object(S.jsx)("g",{transform:"translate(-906.000000, -417.000000)",fillRule:"nonzero",children:Object(S.jsx)("g",{transform:"translate(628.000000, 407.000000)",children:Object(S.jsxs)("g",{transform:"translate(277.000000, 9.000000)",children:[Object(S.jsx)("path",{d:"M1,10.5 L1,9.5 L9,9.5 C9.27614237,9.5 9.5,9.27614237 9.5,9 L9.5,1.5 C9.5,1.22385763 9.72385763,1 10,1 L10,1 C10.2761424,1 10.5,1.22385763 10.5,1.5 L10.5,9 C10.5,9.82842712 9.82842712,10.5 9,10.5 L1,10.5 Z",fill:"#CCCCCC",transform:"translate(5.750000, 5.750000) scale(1, -1) translate(-5.750000, -5.750000) "}),Object(S.jsx)("rect",{stroke:"#666666",x:"7.5",y:"12",width:"7",height:"3"}),Object(S.jsx)("path",{d:"M3.5,13 L5,13 C5.27614237,13 5.5,13.2238576 5.5,13.5 C5.5,13.7761424 5.27614237,14 5,14 L3.5,14 L3.5,16 L1,13.5 L3.5,11 L3.5,13 Z",fill:"#666666"}),Object(S.jsx)("path",{d:"M10,9 L10,10 L1.5,10 C1.22385763,10 1,9.77614237 1,9.5 L1,9.5 C1,9.22385763 1.22385763,9 1.5,9 L10,9 Z",fill:"#CCCCCC",transform:"translate(5.500000, 9.500000) scale(1, -1) translate(-5.500000, -9.500000) "}),Object(S.jsx)("path",{d:"M10,5 L10,6 L1.5,6 C1.22385763,6 1,5.77614237 1,5.5 L1,5.5 C1,5.22385763 1.22385763,5 1.5,5 L10,5 Z",fill:"#CCCCCC",transform:"translate(5.500000, 5.500000) scale(1, -1) translate(-5.500000, -5.500000) "})]})})})})}),un=Object(S.jsxs)("svg",{className:"svg-icon",viewBox:"0 0 1024 1024",width:"100%",height:"100%",children:[Object(S.jsx)("path",{d:"M926.848 256a32 32 0 0 1-32-32V128h-768v96a32 32 0 0 1-64 0V128c0-35.264 28.736-64 64-64h768c35.328 0 64 28.736 64 64v96a32 32 0 0 1-32 32zM894.848 960h-768c-35.264 0-64-28.672-64-64v-96a32 32 0 0 1 64 0V896h768v-32a32 32 0 0 1 64 0v32a64 64 0 0 1-64 64z",fill:"#CCCCCC"}),Object(S.jsx)("path",{d:"M612.352 704H62.848V320h896v102.528a32 32 0 0 1-64 0V384h-768v256h485.504a32 32 0 0 1 0 64z"}),Object(S.jsx)("path",{d:"M838.656 602.496l67.904-67.904a32 32 0 0 1 45.248 45.248l-67.904 67.904 67.904 67.904a32 32 0 0 1-45.248 45.248l-67.904-67.904-67.904 67.904a32 32 0 0 1-45.248-45.248l67.904-67.904-67.904-67.904a32 32 0 0 1 45.248-45.248l67.904 67.904z"})]}),pn=Object(S.jsx)("svg",{className:"svg-icon",width:"100%",height:"100%",viewBox:"0 0 15 14",children:Object(S.jsx)("g",{stroke:"none",strokeWidth:"1",fill:"none",fillRule:"evenodd",children:Object(S.jsx)("g",{transform:"translate(-974.000000, -417.000000)",fillRule:"nonzero",children:Object(S.jsx)("g",{transform:"translate(628.000000, 407.000000)",children:Object(S.jsxs)("g",{transform:"translate(354.000000, 17.000000) rotate(-270.000000) translate(-354.000000, -17.000000) translate(346.000000, 9.000000)",children:[Object(S.jsx)("path",{d:"M1,10.5 L1,9.5 L9,9.5 C9.27614237,9.5 9.5,9.27614237 9.5,9 L9.5,1.5 C9.5,1.22385763 9.72385763,1 10,1 L10,1 C10.2761424,1 10.5,1.22385763 10.5,1.5 L10.5,9 C10.5,9.82842712 9.82842712,10.5 9,10.5 L1,10.5 Z",fill:"#CCCCCC",transform:"translate(5.750000, 5.750000) scale(1, -1) translate(-5.750000, -5.750000) "}),Object(S.jsx)("rect",{stroke:"#666666",x:"7.5",y:"12",width:"7",height:"3"}),Object(S.jsx)("path",{d:"M3.5,13 L5,13 C5.27614237,13 5.5,13.2238576 5.5,13.5 C5.5,13.7761424 5.27614237,14 5,14 L3.5,14 L3.5,16 L1,13.5 L3.5,11 L3.5,13 Z",fill:"#666666"}),Object(S.jsx)("path",{d:"M10,9 L10,10 L1.5,10 C1.22385763,10 1,9.77614237 1,9.5 L1,9.5 C1,9.22385763 1.22385763,9 1.5,9 L10,9 Z",fill:"#CCCCCC",transform:"translate(5.500000, 9.500000) scale(1, -1) translate(-5.500000, -9.500000) "}),Object(S.jsx)("path",{d:"M10,5 L10,6 L1.5,6 C1.22385763,6 1,5.77614237 1,5.5 L1,5.5 C1,5.22385763 1.22385763,5 1.5,5 L10,5 Z",fill:"#CCCCCC",transform:"translate(5.500000, 5.500000) scale(1, -1) translate(-5.500000, -5.500000) "})]})})})})}),mn=Object(S.jsx)("svg",{className:"svg-icon",width:"100%",height:"100%",viewBox:"0 0 15 14",children:Object(S.jsx)("g",{stroke:"none",strokeWidth:"1",fill:"none",fillRule:"evenodd",children:Object(S.jsx)("g",{transform:"translate(-1003.000000, -417.000000)",fillRule:"nonzero",children:Object(S.jsx)("g",{transform:"translate(628.000000, 407.000000)",children:Object(S.jsxs)("g",{transform:"translate(382.000000, 17.000000) rotate(-270.000000) translate(-382.000000, -17.000000) translate(374.000000, 9.000000)",children:[Object(S.jsx)("path",{d:"M1,14.5 L1,14.5 C1,14.2238576 1.22385763,14 1.5,14 L9,14 C9.27614237,14 9.5,13.7761424 9.5,13.5 L9.5,6 C9.5,5.72385763 9.72385763,5.5 10,5.5 L10,5.5 C10.2761424,5.5 10.5,5.72385763 10.5,6 L10.5,13.5 C10.5,14.3284271 9.82842712,15 9,15 L1.5,15 C1.22385763,15 1,14.7761424 1,14.5 Z",fill:"#CCCCCC"}),Object(S.jsx)("rect",{stroke:"#666666",x:"7.5",y:"1",width:"7",height:"3"}),Object(S.jsx)("path",{d:"M3.5,2 L5,2 C5.27614237,2 5.5,2.22385763 5.5,2.5 C5.5,2.77614237 5.27614237,3 5,3 L3.5,3 L3.5,5 L1,2.5 L3.5,0 L3.5,2 Z",fill:"#666666"}),Object(S.jsx)("path",{d:"M10,10 L10,11 L1.5,11 C1.22385763,11 1,10.7761424 1,10.5 C1,10.2238576 1.22385763,10 1.5,10 L10,10 Z M10,6 L10,7 L1.5,7 C1.22385763,7 1,6.77614237 1,6.5 C1,6.22385763 1.22385763,6 1.5,6 L10,6 Z",fill:"#CCCCCC"})]})})})})}),hn=Object(S.jsxs)("svg",{className:"svg-icon",viewBox:"0 0 1024 1024",width:"100%",height:"100%",children:[Object(S.jsx)("path",{d:"M896 945.6h-32a32 32 0 0 1 0-64h32v-768h-96a32 32 0 0 1 0-64H896c35.328 0 64 28.736 64 64v768a64 64 0 0 1-64 64zM224 945.6H128c-35.264 0-64-28.672-64-64v-768c0-35.264 28.736-64 64-64h96a32 32 0 0 1 0 64H128v768h96a32 32 0 0 1 0 64z",fill:"#CCCCCC"}),Object(S.jsx)("path",{d:"M416 945.6H320v-896h384v544a32 32 0 0 1-64 0v-480H384v768h32a32 32 0 0 1 0 64z"}),Object(S.jsx)("path",{d:"M642.24 774.656l67.904-67.904a32 32 0 0 1 45.248 45.248l-67.904 67.904 67.904 67.904a32 32 0 0 1-45.248 45.248l-67.904-67.904-67.904 67.904a32 32 0 0 1-45.248-45.248l67.904-67.904-67.84-67.904a32 32 0 0 1 45.248-45.248l67.84 67.904z"})]}),bn=function(e){return e.table.parentNode.__editor},fn=function(e){Object(c.a)(n,e);var t=Object(r.a)(n);function n(e){var o;Object(a.a)(this,n),(o=t.call(this,e)).onAlign=function(e){var t=o.props.tableServiceIns;bn(t).triggleContentChange((function(){t.setAlign(e)}),p.a.moduleOpModify)},o.onThHorizontal=function(){if("disabled"!==o.state.status.thHorizontal){var e=o.props.tableServiceIns;e.toggleThHorizontal(),bn(e).triggleContentChange((function(){}),p.a.moduleOpModify)}},o.onThVertical=function(){if("disabled"!==o.state.status.thVertical){var e=o.props.tableServiceIns;e.toggleThVertical(),bn(e).triggleContentChange((function(){}),p.a.moduleOpModify)}},o.onMergeClick=function(){var e=o.state.status,t=o.props.tableServiceIns;"active"===e.merge?t.split():"enable"===e.merge&&t.merge(),bn(t).triggleContentChange((function(){}),p.a.moduleOpModify)},o.onDeleteRow=function(){o.state.status;var e=o.props,t=e.tableServiceIns,n=e.deleteTable;t.deleteRow(),t.table.querySelector("td")?bn(t).triggleContentChange((function(){}),p.a.moduleOpModify):n()},o.onDeleteCol=function(){var e=o.props,t=e.tableServiceIns,n=e.deleteTable;t.deleteColumn(),t.table.querySelector("td")?bn(t).triggleContentChange((function(){}),p.a.moduleOpModify):n()},o.insertImage=function(e){var t=o.props.tableServiceIns;Object(I.a)(bn(t))},o.insertAlbum=function(e){var t=o.props.tableServiceIns;Object(k.a)(bn(t))},o.onDeleteTable=function(){o.props.deleteTable()},o.adaptByText=function(){var e=o.props.tableServiceIns;e.adaptByText(),bn(e).triggleContentChange((function(){}),p.a.moduleOpModify)},o.adaptByWindow=function(){var e=o.props.tableServiceIns;e.adaptByWindow(),bn(e).triggleContentChange((function(){}),p.a.moduleOpModify)},o.insertCol=function(e){var t=o.props.tableServiceIns;bn(t).triggleContentChange((function(){t.insertCol(e)}),p.a.moduleOpModify)},o.insertRow=function(e){var t=o.props.tableServiceIns;bn(t).triggleContentChange((function(){t.insertRow(e)}),p.a.moduleOpModify)},o.toggleBorder=function(){o.props.toggleBorder()};var i=e.tableServiceIns;return o.state={isActive:!1,status:{},format:null,tbRefOffY:i.getBoundingClientRect().top},o.width=0,o.height=0,o}return Object(i.a)(n,[{key:"componentDidMount",value:function(){var e=this,t=this.props.tableServiceIns;this.toolbarServiceInsDispose=C.g.listenChange((function(n){n.editor;var o=n.format;t.table&&e.setState({format:o,status:Object(sn.b)(t)})})),this.allEventDisposer=[],this.allEventDisposer.push(Object($.b)(document,"scroll",(function(){e.setState({tbRefOffY:t.getBoundingClientRect().top})}))),this.onSelctedZoneChangeDispose=t.listenStateChange((function(){e.setState({isActive:t.context.isActive,tbRefOffY:t.getBoundingClientRect().top,status:Object(sn.b)(t)})}))}},{key:"componentWillUnmount",value:function(){this.toolbarServiceInsDispose(),this.allEventDisposer.forEach((function(e){Object($.a)(e.el,e.evt,e.fn)})),this.onSelctedZoneChangeDispose()}},{key:"render",value:function(){var e=this,t=this.state,n=t.status;if(!t.isActive)return null;var o=this.props,a=o.tableServiceIns,i=o.noborder,c=j()(["button",{active:"left"===n.align}]),r=j()(["button",{active:"center"===n.align}]),s=j()(["button",{active:"right"===n.align}]),l=j()(["button",{active:"active"===n.merge},{disabled:"disabled"===n.merge}]),d=j()(["button",{active:"active"===n.thHorizontal},{disabled:"disabled"===n.thHorizontal}]),u=j()(["button",{active:"active"===n.thVertical},{disabled:"disabled"===n.thVertical}]),p=j()(["svg-icon",{"svg-icon-table-border--active":i},{"svg-icon-table-border--hide":!i}]),m=j()(["button"]),h="active"===n.merge?"\u53d6\u6d88\u5408\u5e76\u5355\u5143\u683c":"\u5408\u5e76\u5355\u5143\u683c",b={left:a.table.parentNode.parentNode.getBoundingClientRect().left+Object(f.a)()-10+"px",top:a.getBoundingClientRect().top+Object(f.b)()-80+"px"};this.state.tbRefOffY<140&&a.getBoundingClientRect().bottom>97&&(b.top=Object(f.b)()+70);var v=bn(a);return Object(S.jsxs)("div",{className:"table-toolbar",style:b,id:"J-tabletoolbar-".concat(this.props.uuid),children:[Object(S.jsx)(an.a,{format:this.state.format,editor:v}),Object(S.jsxs)("div",{className:"toolbar-area",children:[Object(S.jsx)(cn.a,{format:this.state.format,editor:v}),Object(S.jsx)(rn.a,{format:this.state.format,editor:v})]}),Object(S.jsxs)("div",{className:"toolbar-area",children:[Object(S.jsx)(F.b,{text:"\u5de6\u5bf9\u9f50",children:Object(S.jsx)("button",{className:c,onClick:function(){e.onAlign("left")},children:Object(S.jsx)("i",{className:"icon baike_icon_word baike_icon_word-juzuo"})})}),Object(S.jsx)(F.b,{text:"\u5c45\u4e2d",children:Object(S.jsx)("button",{className:r,onClick:function(){e.onAlign("center")},children:Object(S.jsx)("i",{className:"icon baike_icon_word baike_icon_word-juzhong"})})}),Object(S.jsx)(F.b,{text:"\u53f3\u5bf9\u9f50",children:Object(S.jsx)("button",{className:s,onClick:function(){e.onAlign("right")},children:Object(S.jsx)("i",{className:"icon baike_icon_word baike_icon_word-juyou"})})})]}),Object(S.jsxs)("div",{className:"toolbar-area",children:[Object(S.jsx)(F.b,{text:"\u4e0a\u589e\u884c",children:Object(S.jsx)("button",{className:"button",onClick:function(){e.insertRow()},children:ln})}),Object(S.jsx)(F.b,{text:"\u4e0b\u589e\u884c",children:Object(S.jsx)("button",{className:"button",onClick:function(){e.insertRow(1)},children:dn})}),Object(S.jsx)(F.b,{text:"\u5220\u9664\u884c",children:Object(S.jsx)("button",{className:m,onClick:function(){e.onDeleteRow()},children:un})})]}),Object(S.jsxs)("div",{className:"toolbar-area",children:[Object(S.jsx)(F.b,{text:"\u5de6\u589e\u5217",children:Object(S.jsx)("button",{className:"button",onClick:function(){e.insertCol()},children:pn})}),Object(S.jsx)(F.b,{text:"\u53f3\u589e\u5217",children:Object(S.jsx)("button",{className:"button",onClick:function(){e.insertCol(1)},children:mn})}),Object(S.jsx)(F.b,{text:"\u5220\u9664\u5217",children:Object(S.jsx)("button",{className:m,onClick:function(){e.onDeleteCol()},children:hn})})]}),Object(S.jsx)("div",{className:"toolbar-area",children:Object(S.jsx)(F.b,{text:h,children:Object(S.jsx)("button",{className:l,onClick:function(){e.onMergeClick()},children:Object(S.jsxs)("svg",{className:"svg-icon",viewBox:"0 0 1024 1024",width:"100%",height:"100%",children:[Object(S.jsx)("path",{d:"M314.514286 694.857143h58.514285V950.857143h-58.514285z",fill:"#CCCCCC"}),Object(S.jsx)("path",{d:"M914.285714 0h-804.571428C51.2 0 0 51.2 0 109.714286v804.571428c0 58.514286 51.2 109.714286 109.714286 109.714286h804.571428c58.514286 0 109.714286-51.2 109.714286-109.714286v-804.571428c0-58.514286-51.2-109.714286-109.714286-109.714286z m36.571429 914.285714c0 21.942857-14.628571 36.571429-36.571429 36.571429h-804.571428c-21.942857 0-36.571429-14.628571-36.571429-36.571429v-804.571428c0-21.942857 14.628571-36.571429 36.571429-36.571429h204.8v256h58.514285V73.142857h277.942858v256h58.514285V73.142857h204.8c21.942857 0 36.571429 14.628571 36.571429 36.571429v804.571428z",fill:"#CCCCCC"}),Object(S.jsx)("path",{d:"M650.971429 694.857143h58.514285V950.857143h-58.514285z",fill:"#CCCCCC"}),Object(S.jsx)("path",{d:"M914.285714 731.428571h-804.571428C51.2 731.428571 0 680.228571 0 621.714286v-219.428572C0 343.771429 51.2 292.571429 109.714286 292.571429h804.571428c58.514286 0 109.714286 51.2 109.714286 109.714285v219.428572c0 58.514286-51.2 109.714286-109.714286 109.714285z m-804.571428-365.714285c-21.942857 0-36.571429 14.628571-36.571429 36.571428v219.428572c0 21.942857 14.628571 36.571429 36.571429 36.571428h804.571428c21.942857 0 36.571429-14.628571 36.571429-36.571428v-219.428572c0-21.942857-14.628571-36.571429-36.571429-36.571428h-804.571428z"})]})})})}),Object(S.jsxs)("div",{className:"toolbar-area",children:[Object(S.jsx)(F.b,{text:"\u63d2\u5165\u56fe\u7247",children:Object(S.jsx)("button",{className:"button",onClick:function(){e.insertImage()},children:Object(S.jsx)("i",{className:"icon baike_icon_ins-module baike_icon_ins-module-tupian"})})}),Object(S.jsx)(F.b,{text:"\u63d2\u5165\u56fe\u518c",children:Object(S.jsx)("button",{className:"button",onClick:function(){e.insertAlbum()},children:Object(S.jsx)("i",{className:"icon baike_icon_ins-module baike_icon_ins-module-tuce"})})})]}),Object(S.jsxs)("div",{className:"toolbar-area",children:[Object(S.jsx)(F.b,{text:"\u6a2a\u8868\u5934",children:Object(S.jsx)("button",{className:d,onClick:function(){e.onThHorizontal()},children:Object(S.jsxs)("svg",{className:"svg-icon",viewBox:"0 0 1024 1024",width:"100%",height:"100%",children:[Object(S.jsx)("path",{d:"M373.028571 365.714286v585.142857h-58.514285V365.714286zM709.485714 365.714286v585.142857h-58.514285V365.714286z",fill:"#CCCCCC"}),Object(S.jsx)("path",{d:"M950.857143 0H73.142857C29.257143 0 0 29.257143 0 73.142857v877.714286c0 43.885714 29.257143 73.142857 73.142857 73.142857h877.714286c43.885714 0 73.142857-29.257143 73.142857-73.142857V73.142857c0-43.885714-29.257143-73.142857-73.142857-73.142857z m0 950.857143H73.142857V438.857143h877.714286v512z"})]})})}),Object(S.jsx)(F.b,{text:"\u7ad6\u8868\u5934",children:Object(S.jsx)("button",{className:u,onClick:function(){e.onThVertical()},children:Object(S.jsxs)("svg",{className:"svg-icon",viewBox:"0 0 1024 1024",width:"100%",height:"100%",children:[Object(S.jsx)("path",{d:"M365.714286 643.657143h658.285714v73.142857H365.714286zM365.714286 307.2h658.285714v73.142857H365.714286z",fill:"#CCCCCC"}),Object(S.jsx)("path",{d:"M950.857143 0H73.142857C29.257143 0 0 29.257143 0 73.142857v877.714286c0 43.885714 29.257143 73.142857 73.142857 73.142857h877.714286c43.885714 0 73.142857-29.257143 73.142857-73.142857V73.142857c0-43.885714-29.257143-73.142857-73.142857-73.142857z m0 950.857143H438.857143V73.142857h512v877.714286z"})]})})})]}),Object(S.jsxs)("div",{className:"toolbar-area",children:[Object(S.jsx)(F.b,{text:"\u9690\u85cf\u8fb9\u6846",children:Object(S.jsx)("button",{className:"button",onClick:function(){e.toggleBorder()},children:Object(S.jsx)("i",{className:p})})}),Object(S.jsx)(F.b,{text:"\u6839\u636e\u5185\u5bb9\u81ea\u52a8\u8c03\u6574\u8868\u683c",children:Object(S.jsx)("button",{className:"button",onClick:function(){e.adaptByText()},children:Object(S.jsx)("i",{className:"svg-icon svg-icon-table-adaptbytext"})})}),Object(S.jsx)(F.b,{text:"\u6839\u636e\u9875\u9762\u5bbd\u5ea6\u81ea\u52a8\u8c03\u6574\u8868\u683c",children:Object(S.jsx)("button",{className:"button",onClick:function(){e.adaptByWindow()},children:Object(S.jsx)("i",{className:"svg-icon svg-icon-table-adaptbywindow"})})}),Object(S.jsx)(F.b,{text:"\u5220\u9664",children:Object(S.jsx)("button",{className:"button",onClick:function(){e.onDeleteTable()},children:Object(S.jsx)("i",{className:"icon baike_icon_pic baike_icon_pic-shanchu1"})})})]})]})}}]),n}(s.Component),vn=(n(1766),n(406)),jn=function(e){Object(c.a)(n,e);var t=Object(r.a)(n);function n(e){var o;return Object(a.a)(this,n),(o=t.call(this,e))._initMouseEvent=!1,o._getColWidthByIndex=function(e){return o.props.tableServiceIns.computed.cols[e]||0},o.mouseContext={onRowLineMouseDown:!1,onColLineMouseDown:!1,mouseStartY:0,mouseStartX:0,startY:0,startX:0,upY:0,leftX:0,rightX:0},o.onRowLineMouseDown=function(e,t){e.stopPropagation(),o.mouseContext.onRowLineMouseDown=!0;var n=o.state.heights;o.mouseContext.mouseStartY=e.clientY,o.mouseContext.startY=0,o.mouseContext.upY=0,o.mouseContext.rowIndex=t;for(var a=0;a<=t;a++)o.mouseContext.startY+=n[a],a!==t&&(o.mouseContext.upY+=n[a]);o.mouseContext.upY+=vn.a,o.horizontalLineRef.current.style.top=o.mouseContext.startY+"px",o.horizontalLineRef.current.className="horizontal-split-line-move"},o.onColLineMouseDown=function(e,t){e.stopPropagation(),o.mouseContext.onColLineMouseDown=!0;var n=o.props.tableServiceIns.computed.cols;o.mouseContext.mouseStartX=e.clientX,o.mouseContext.startX=0,o.mouseContext.leftX=0,o.mouseContext.rightX=0,o.mouseContext.colIndex=t;for(var a=0;a<=t;a++)o.mouseContext.startX+=n[a],o.mouseContext.rightX+=n[a],a!==t&&(o.mouseContext.leftX+=n[a]);t===n.length-1?o.mouseContext.rightX=vn.d:o.mouseContext.rightX+=parseInt(n[t+1])-vn.b,o.mouseContext.leftX+=vn.b,o.verticalLineRef.current.style.left=o.mouseContext.startX+"px",o.verticalLineRef.current.className="vertical-split-line-move"},o.state={heights:[],isActive:!1,status:{}},o.canSelect=!0,o.verticalLineRef=l.a.createRef(),o.horizontalLineRef=l.a.createRef(),o}return Object(i.a)(n,[{key:"componentDidMount",value:function(){var e=this,t=this.props.tableServiceIns;this.allEventDisposer=[],this.onSelctedZoneChangeDispose=t.listenStateChange((function(){e.setState({heights:t.computed.heights,isActive:t.context.isActive,status:Object(sn.b)(t)}),e.initMouseEvent()}))}},{key:"initMouseEvent",value:function(){var e=this;if(!this._initMouseEvent){this._initMouseEvent=!0;var t=this.props.tableServiceIns,n=t.table.parentNode.__editor,o=n.context.root.ownerDocument;this.allEventDisposer.push(Object($.b)(o,"mousemove",(function(t){if(e.mouseContext.onRowLineMouseDown){t.preventDefault();var n=t.clientY-e.mouseContext.mouseStartY;n<0&&e.mouseContext.startY+n<e.mouseContext.upY?e.horizontalLineRef.current.style.top=e.mouseContext.upY+"px":e.horizontalLineRef.current.style.top=e.mouseContext.startY+n+"px"}}))),this.allEventDisposer.push(Object($.b)(o,"mouseup",(function(t){if(e.mouseContext.onRowLineMouseDown){e.mouseContext.onRowLineMouseDown=!1;var o=e.state.heights;t.preventDefault();var a=t.clientY-e.mouseContext.mouseStartY;if(a<0&&e.mouseContext.startY+a<e.mouseContext.upY&&(a=e.mouseContext.upY-e.mouseContext.startY),e.horizontalLineRef.current.className="horizontal-split-line-move hidden",0!==a){var i=e.mouseContext.rowIndex,c=e.props.tableServiceIns;Object(W.a)(c.table.rows[i],{height:o[i]- -a}),n.triggleContentChange((function(){}),p.a.moduleOpModify)}}}))),this.allEventDisposer.push(Object($.b)(o,"mousemove",(function(t){if(e.mouseContext.onColLineMouseDown){t.preventDefault();var n=t.clientX-e.mouseContext.mouseStartX;n<0&&e.mouseContext.startX+n<e.mouseContext.leftX?e.verticalLineRef.current.style.left=e.mouseContext.leftX+"px":n>0&&e.mouseContext.startX+n>e.mouseContext.rightX?e.verticalLineRef.current.style.left=e.mouseContext.rightX+"px":e.verticalLineRef.current.style.left=parseInt(e.mouseContext.startX)+parseInt(n)+"px"}}))),this.allEventDisposer.push(Object($.b)(o,"mouseup",(function(o){if(e.mouseContext.onColLineMouseDown){e.mouseContext.onColLineMouseDown=!1,o.preventDefault();var a=o.clientX-e.mouseContext.mouseStartX;if(a<0&&e.mouseContext.startX+a<e.mouseContext.leftX?a=e.mouseContext.leftX-e.mouseContext.startX:a>0&&e.mouseContext.startX+a>e.mouseContext.rightX&&(a=e.mouseContext.rightX-e.mouseContext.startX),e.verticalLineRef.current.className="vertical-split-line-move hidden",0!==a){var i=e.mouseContext.colIndex,c=t.table.querySelectorAll("col");if(a>0&&!c[i+1]&&parseInt(t.table.width)>=vn.d)return;c[i].width=e._getColWidthByIndex(i)+parseInt(a),c[i+1]&&(c[i+1].width=e._getColWidthByIndex(i+1)-parseInt(a)),n.triggleContentChange((function(){}),p.a.moduleOpModify)}}})))}}},{key:"componentWillUnmount",value:function(){this.onSelctedZoneChangeDispose(),this.allEventDisposer.forEach((function(e){Object($.a)(e.el,e.evt,e.fn)}))}},{key:"_renderHorizontalSplitLine",value:function(){var e=this,t=this.state.heights,n=0;return this.props.tableServiceIns.cells.map((function(o,a){return n+=t[a],Object(S.jsx)("div",{className:"horizontal-split-line",style:{top:n+"px"},onMouseDown:function(t){e.onRowLineMouseDown(t,a)}},a)}))}},{key:"_renderVerticalSplitLine",value:function(){var e=this,t=this.props.tableServiceIns.computed.cols,n=0;return t.map((function(t,o){return n+=parseInt(t),Object(S.jsx)("div",{className:"vertical-split-line",style:{left:n+"px"},onMouseDown:function(t){e.onColLineMouseDown(t,o)}},o)}))}},{key:"render",value:function(){if(!this.state.isActive)return null;var e=this.props.tableServiceIns,t=e.computed.cols,n=e.table.clientHeight,o=t.reduce((function(e,t){return e+(parseInt(t)||0)}),0);return Object(S.jsxs)("div",{className:"split-line-container",style:{width:o+"px",height:n+"px"},children:[this._renderHorizontalSplitLine(),this._renderVerticalSplitLine(),Object(S.jsx)("div",{className:"horizontal-split-line-move hidden",ref:this.horizontalLineRef}),Object(S.jsx)("div",{className:"vertical-split-line-move hidden",ref:this.verticalLineRef})]})}}]),n}(s.Component),gn=n(1779),xn=n.n(gn),On=xn.a.selected,yn=function(e){Object(c.a)(n,e);var t=Object(r.a)(n);function n(e){var o;return Object(a.a)(this,n),(o=t.call(this,e)).onSelectAll=function(){var e=o.props.tableServiceIns;e.change({selectedZoneByUser:{left:0,top:0,right:e.cells[0].length-1,bottom:e.cells.length-1}})},o.selectRow=function(e){if(o.canSelect){var t=o.props.tableServiceIns;t.change({selectedZoneByUser:{left:0,top:e,right:t.cells[0].length-1,bottom:e}})}else o.canSelect=!0},o.insertRow=function(e){o.canSelect=!1;var t=o.props.tableServiceIns;t.insertBelow(e),t.table.parentNode.__editor.triggleContentChange((function(){}),p.a.moduleOpModify)},o.proxyMouseMove=function(e,t){var n=e.clientY,a=e.target.getBoundingClientRect();n-a.top>a.height/2?o.setState({activeInsertIndex:t}):o.setState({activeInsertIndex:t-1})},o.proxyMouseLeave=function(){o.setState({activeInsertIndex:-2})},o._renderInsertBtn=function(){var e=o.state,t=e.activeInsertIndex,n=e.heights;if(t<=-2)return null;var a=o.props.tableServiceIns.table.clientWidth,i=n.reduce((function(e,n,o){return o<=t?e+(n||0):e}),0),c={top:"".concat(i-8,"px")},r={width:a+"px",top:"".concat(i,"px")};return Object(S.jsxs)(S.Fragment,{children:[Object(S.jsx)("div",{className:"".concat(xn.a["add-line"]),style:r}),Object(S.jsx)("i",{className:" icon baike_icon_word baike_icon_word-tianjiaxiang ".concat(xn.a["add-icon"]),style:c,onClick:function(){o.insertRow(t)}})]})},o.state={isActive:!1,heights:[],selected:[],activeInsertIndex:-2,top:-1,bottom:-1},o.canSelect=!0,o._verticalContainerRef=l.a.createRef(),o}return Object(i.a)(n,[{key:"componentDidMount",value:function(){var e=this,t=this.props.tableServiceIns;this.onSelctedZoneChangeDispose=t.listenStateChange((function(){var n=t.context.selectedZone;e.setState({isActive:t.context.isActive,heights:t.computed.heights,top:n.top,bottom:n.bottom})}))}},{key:"componentWillUnmount",value:function(){this.onSelctedZoneChangeDispose()}},{key:"_renderVertical",value:function(){var e=this,t=this.props.tableServiceIns,n=t.computed.selectedDom,o=this.state,a=o.top,i=o.bottom,c=o.heights;return t.cells.map((function(t,o){var r=j()([xn.a["vertical-item"],Object(Se.a)({},On,n.length>1&&o>=a&&o<=i)]);return Object(S.jsx)("div",{className:r,style:{height:c[o]+"px"},onClick:function(){e.selectRow(o)},onMouseMove:function(t){e.proxyMouseMove(t,o)}},o)}))}},{key:"render",value:function(){var e=this;if(!this.state.isActive)return null;var t=this.props.tableServiceIns.table.clientHeight;return Object(S.jsxs)(S.Fragment,{children:[Object(S.jsx)("button",{className:xn.a["select-all-btn"],onClick:function(){e.onSelectAll()}},1),Object(S.jsxs)("div",{className:xn.a.container,ref:this._verticalContainerRef,style:{height:t+"px"},onMouseLeave:this.proxyMouseLeave,children:[this._renderVertical(),this._renderInsertBtn()]},2)]})}}]),n}(s.Component),Cn=n(1780),Nn=n.n(Cn),_n=Nn.a.selected,kn=function(e){Object(c.a)(n,e);var t=Object(r.a)(n);function n(e){var o;return Object(a.a)(this,n),(o=t.call(this,e)).selectCol=function(e){if(o.canSelect){var t=o.props.tableServiceIns;t.change({selectedZoneByUser:{left:e,top:0,right:e,bottom:t.cells.length-1}})}else o.canSelect=!0},o.insertCol=function(e){o.canSelect=!1;var t=o.props.tableServiceIns;t.insertRight(e),t.table.parentNode.__editor.triggleContentChange((function(){}),p.a.moduleOpModify)},o.proxyMouseMove=function(e,t){var n=e.clientX,a=e.target.getBoundingClientRect();n-a.left>a.width/2?o.setState({activeInsertIndex:t}):o.setState({activeInsertIndex:t-1})},o.proxyMouseLeave=function(){o.setState({activeInsertIndex:-2})},o._renderInsertBtn=function(){var e=o.state.activeInsertIndex;if(e<=-2)return null;var t=o.props.tableServiceIns,n=t.computed,a=t.table.clientHeight-5,i=n.cols.reduce((function(t,n,o){return o<=e?t+(n||0):t}),0),c={left:"".concat(i-7,"px")},r={height:a+"px",left:"".concat(i,"px")};return Object(S.jsxs)(S.Fragment,{children:[Object(S.jsx)("div",{className:"".concat(Nn.a["add-line"]),style:r}),Object(S.jsx)("i",{className:" icon baike_icon_word baike_icon_word-tianjiaxiang ".concat(Nn.a["add-icon"]),style:c,"data-index":e,onClick:function(){o.insertCol(e)}})]})},o.state={isActive:!1,activeInsertIndex:-2,left:-1,right:-1},o.canSelect=!0,o.verticalLineRef=l.a.createRef(),o.horizontalLineRef=l.a.createRef(),o._horizontalContainerRef=l.a.createRef(),o}return Object(i.a)(n,[{key:"componentDidMount",value:function(){var e=this,t=this.props.tableServiceIns;this.onSelctedZoneChangeDispose=t.listenStateChange((function(){var n=t.context.selectedZone;e.setState({isActive:t.context.isActive,left:n.left,right:n.right,cols:Object(o.a)(t.computed.cols)})}))}},{key:"componentWillUnmount",value:function(){this.onSelctedZoneChangeDispose()}},{key:"_renderHorizontal",value:function(){var e=this,t=this.props.tableServiceIns.computed.selectedDom,n=this.state,o=n.left,a=n.right;return n.cols.map((function(n,i){var c=j()([Nn.a["horizontal-item"],Object(Se.a)({},_n,t.length>1&&i>=o&&i<=a)]);return Object(S.jsx)("div",{className:c,style:{width:n?parseInt(n)+"px":""},onClick:function(){e.selectCol(i)},onMouseMove:function(t){e.proxyMouseMove(t,i)}},i)}))}},{key:"render",value:function(){var e=this.state,t=e.isActive,n=e.cols;if(!t)return null;var o=n.reduce((function(e,t){return e+(t||0)}),0);return Object(S.jsx)(S.Fragment,{children:Object(S.jsxs)("div",{className:Nn.a.container,style:{width:o+"px"},ref:this._horizontalContainerRef,onMouseLeave:this.proxyMouseLeave,children:[this._renderHorizontal(),this._renderInsertBtn()]})})}}]),n}(s.Component),In=(n(1781),function(e){Object(c.a)(n,e);var t=Object(r.a)(n);function n(e){var o;return Object(a.a)(this,n),(o=t.call(this,e)).state={isActive:!1,selectedDom:[]},o}return Object(i.a)(n,[{key:"componentDidMount",value:function(){var e=this,t=this.props.tableServiceIns;this.onSelctedZoneChangeDispose=t.listenStateChange((function(){e.setState({isActive:t.context.isActive,selectedDom:t.computed.selectedDom}),t.computed.selectedDom.length>1&&Object(vt.a)()})),this.allEventDisposer=[],this.allEventDisposer.push()}},{key:"componentWillUnmount",value:function(){this.allEventDisposer.forEach((function(e){Object($.a)(e.el,e.evt,e.fn)})),this.onSelctedZoneChangeDispose()}},{key:"render",value:function(){var e=this.state,t=e.isActive,n=e.selectedDom,o=this.props.tableServiceIns;if(!t)return null;if(n.length>1){var a=o.getBoundingClientRect(),i=n[0].getBoundingClientRect(),c=n.reduce((function(e,t){var n=t.getBoundingClientRect();return{left:Math.min(e.left,n.left),top:Math.min(e.top,n.top),right:Math.max(e.right,n.right),bottom:Math.max(e.bottom,n.bottom)}}),{left:i.left,top:i.top,right:i.right,bottom:i.bottom}),r=c.left-a.left,s=c.top-a.top,l=c.right-c.left,d=c.bottom-c.top,u={left:"".concat(r,"px"),top:"".concat(s,"px"),height:"".concat(d,"px")},p={left:"".concat(r+l,"px"),top:"".concat(s,"px"),height:"".concat(d,"px")},m={left:"".concat(r,"px"),top:"".concat(s,"px"),width:"".concat(l,"px")},h={left:"".concat(r,"px"),top:"".concat(s+d,"px"),width:"".concat(l,"px")};"".concat(r+1,"px"),"".concat(s+1,"px"),"".concat(r+l-4,"px"),"".concat(s+d-4,"px");return Object(S.jsxs)("div",{className:"table-td-selected-rect",children:[Object(S.jsx)("div",{className:"table-td-selected-rect-line l",style:u}),Object(S.jsx)("div",{className:"table-td-selected-rect-line r",style:p}),Object(S.jsx)("div",{className:"table-td-selected-rect-line t",style:m}),Object(S.jsx)("div",{className:"table-td-selected-rect-line b",style:h})]})}return null}}]),n}(s.Component)),wn=function(e){Object(c.a)(n,e);var t=Object(r.a)(n);function n(e){var o;return Object(a.a)(this,n),(o=t.call(this,e)).state={width:""},o.proxyBlur=function(e){(0,o.props.editTableTitle)(o.input.current.value)},o.input=l.a.createRef(),o}return Object(i.a)(n,[{key:"componentDidMount",value:function(){var e=this,t=this.props.tableServiceIns;this.disposeTableChange=t.listenStateChange((function(){if(e.state.width!==t.table.clientWidth){var n=!1;t.table&&(n=[].slice.call(t.table.querySelector("colgroup").childNodes).filter((function(e){return!e.width})).length>0);var o="auto";n||(o="".concat(t.table.clientWidth+10,"px")),e.setState({width:o})}}))}},{key:"componentWillUnmount",value:function(){this.disposeTableChange()}},{key:"render",value:function(){var e=this.props.title,t={width:this.state.width};return Object(S.jsx)(S.Fragment,{children:Object(S.jsx)("h4",{className:"table-title",style:t,children:Object(S.jsx)("input",{type:"text",className:"table-title-input",placeholder:"\u8bf7\u8f93\u5165\u8868\u683c\u6807\u9898",maxLength:"30",defaultValue:e,ref:this.input,onBlur:this.proxyBlur})})})}}]),n}(s.Component),Dn=n(646),Sn=n(827),En=n(828),Mn=n(829),Ln=n(143),Tn=n(387),Rn=function(e){Object(c.a)(n,e);var t=Object(r.a)(n);function n(e){var i;return Object(a.a)(this,n),(i=t.call(this,e)).initTableService=function(){var e=i.props.tableServiceIns,t=i._editorDiv.querySelector("table");t&&e.refresh(t)},i.getEditorOptions=function(){var e=i.props,t=e.updateHtml,n=e.tableServiceIns,a=Object(wt.a)(),c=[].concat(Object(o.a)(a),[new Tn.a((function(){i.initTableService()})),new je.a,new m.a((function(e,t){var n=e.context.root;[].slice.call(n.childNodes).forEach((function(e){Object(ie.a)(e,["table"])||e.remove()}));var o=e.context.triggleContentChangeType;[p.a.inited,p.a.setContent].indexOf(o)>-1?([].slice.call(n.querySelectorAll("tr")).forEach((function(e){Object(Ln.a)(e)})),[].slice.call(n.querySelectorAll("td")).forEach((function(e){Object(Ln.a)(e),Object(It.b)(e)}))):([].slice.call(n.querySelectorAll("tr")).forEach((function(e){Object(Ln.a)(e)})),t=t||[],[].slice.call(t).forEach((function(e){Object(Ln.a)(e),Object(It.b)(e)})))})),new En.a,new Mn.a,new te.a((function(e){Object(It.b)(e)})),new ee,new Sn.a(n),new ge.a(new Mt.a(Ro))]);return{customAttributes:{type:u.e},initialContent:i.props.html,plugins:c,changed:function(e){if(i._editorDiv.querySelector("table")){var n=e.context.triggleContentChangeType,o=e.getContent();t(n,o)}}}},i._editorDivOnRef=function(e){i._editorDiv=e},i.allEventDisposer=[],i}return Object(i.a)(n,[{key:"componentDidMount",value:function(){this.editor=new d.a(this._editorDiv,this.getEditorOptions())}},{key:"componentDidUpdate",value:function(){this.editor.setContent(this.props.html)}},{key:"componentWillUnmount",value:function(){this.allEventDisposer.forEach((function(e){Object($.a)(e.el,e.evt,e.fn)})),this.editor&&this.editor.dispose()}},{key:"render",value:function(){return Object(S.jsx)("div",{className:"J-editor-for-dom-plugin",spellCheck:"false",ref:this._editorDivOnRef})}}]),n}(s.Component),An=n(651),Bn=function(e){Object(c.a)(n,e);var t=Object(r.a)(n);function n(e){var o;return Object(a.a)(this,n),(o=t.call(this,e))._containerDivRef=function(e){o._containerDiv=e},o.onClickHandler=function(e){o.tableServiceIns.change({isActive:!0})},o.updateData=function(e,t){o.props.change.update(e,t)},o.deleteTable=function(){o.props.change.delete()},o.updateHtml=function(e,t){var n=o.props.node;n.data.html!==t&&o.updateData(Object(De.a)(Object(De.a)({},n),{},{data:Object(De.a)(Object(De.a)({},n.data),{},{html:t})}),e||"\u66f4\u65b0table html")},o.editTableTitle=function(e){var t=o.props.node;o.updateData(Object(De.a)(Object(De.a)({},t),{},{data:Object(De.a)(Object(De.a)({},t.data),{},{title:e})}),"\u4fee\u6539\u8868\u683c\u6807\u9898")},o.toggleBorder=function(){var e=o.props.node;o.updateData(Object(De.a)(Object(De.a)({},e),{},{data:Object(De.a)(Object(De.a)({},e.data),{},{noborder:e.data.noborder?0:1})}),p.a.moduleOpModify)},o.uuid=Object(zt.a)(),o.tableServiceIns=new Dn.a,o}return Object(i.a)(n,[{key:"componentDidMount",value:function(){var e=this;this.allEventDisposer=[],this.allEventDisposer.push(),this.disposeClickoutside=Object(y.a)(this._containerDiv,(function(t){Object(R.a)(document.getElementById("J-tabletoolbar-".concat(e.uuid)),t.target)||e.tableServiceIns.change({isActive:!1})}));var t="";this.disposeTableChange=this.tableServiceIns.listenStateChange((function(){if(t!==e.tableServiceIns.context.isActive){t=e.tableServiceIns.context.isActive;var n="table-container_active";e.tableServiceIns.context.isActive?Object(P.a)(e._containerDiv,n):Object(P.c)(e._containerDiv,n)}}))}},{key:"componentWillUnmount",value:function(){this.disposeClickoutside(),this.disposeTableChange(),this.allEventDisposer.forEach((function(e){Object($.a)(e.el,e.evt,e.fn)})),this.allEventDisposer=null}},{key:"render",value:function(){var e=this,t=this.props.node,n={uuid:this.uuid,noborder:t.data.noborder,tableServiceIns:this.tableServiceIns,deleteTable:this.deleteTable,toggleBorder:this.toggleBorder},o={title:t.data.title,tableServiceIns:this.tableServiceIns,editTableTitle:this.editTableTitle},a={tableServiceIns:this.tableServiceIns,html:Pt()(t.data.html),updateHtml:this.updateHtml},i=j()(["table-container__body ",{noborder:1===parseInt(t.data.noborder)}]);return Object(S.jsxs)("div",{className:"table-container",ref:this._containerDivRef,onClick:function(t){e.onClickHandler(t)},children:[Object(S.jsx)(An.a,{children:Object(S.jsx)(fn,Object(De.a)({},n))}),Object(S.jsx)(yn,Object(De.a)({},n)),Object(S.jsx)(wn,Object(De.a)({},o)),Object(S.jsxs)("div",{className:i,children:[Object(S.jsx)(kn,Object(De.a)({},n)),Object(S.jsx)(jn,Object(De.a)({},n)),Object(S.jsx)(In,Object(De.a)({},n)),Object(S.jsx)(Rn,Object(De.a)({},a))]})]})}}]),n}(s.Component),Pn=n(32),zn=n(134),Hn=n(261),qn=n(137),Wn=n(94),Fn=n(1782),Un=n.n(Fn),Zn=function(e){var t=e.catalog,n=e.id,o=e.onMouseOver,a=e.onMouseOut,i=t.level,c=t.text;switch(i){case 1:return Object(S.jsx)("h2",{onMouseOver:o,onMouseOut:a,"data-id":n,children:c});case 2:return Object(S.jsx)("h3",{onMouseOver:o,onMouseOut:a,"data-id":n,children:c})}return Object(S.jsx)("p",{onMouseOver:o,onMouseOut:a,className:Un.a["catalog-p"],children:c})},Vn=n(1783),Xn=n.n(Vn),Yn=function(e){return document.body},Jn=[{value:1,label:"1\u7ea7\u76ee\u5f55"},{value:2,label:"2\u7ea7\u76ee\u5f55"},{value:0,label:"\u65e0\u76ee\u5f55"}].map((function(e){return Object(S.jsx)(Ft.a,{value:e.value,children:e.label},e.value)}));function Qn(e){var t,n=e.remove,o=e.edit,a=e.add,i=e.level,c=e.type,r=e.changeLevel,s=e.addText,l=j()([[Xn.a["m-card__toolbar"]],"clearfix"]),d=Object(Se.a)({},Tt.p,Object(S.jsx)(Kn,{remove:n}));return Object(S.jsx)("div",{className:l,children:null!==(t=d[c])&&void 0!==t?t:Object(S.jsxs)(S.Fragment,{children:[Object(S.jsx)(eo,{level:i,changeLevel:r}),Object(S.jsx)($n,{edit:o}),Object(S.jsx)(Gn,{add:a,addText:s}),Object(S.jsx)(Kn,{remove:n})]})})}function Kn(e){var t=e.remove;return Object(S.jsx)("div",{className:"toolbar-area",children:Object(S.jsx)("button",{className:"button",onClick:t,children:Object(S.jsx)(F.b,{text:"\u5220\u9664",popupClassName:"map-tooltip",getPopupContainer:Yn,children:Object(S.jsx)("i",{className:"icon baike_icon_pic baike_icon_pic-shanchu1"})})})})}function Gn(e){var t=e.add,n=e.addText;return Object(S.jsx)("div",{className:"toolbar-area",children:Object(S.jsx)("button",{className:"button",onClick:t,children:Object(S.jsxs)(F.b,{text:n,popupClassName:"map-tooltip",getPopupContainer:Yn,children:[Object(S.jsx)("i",{className:"icon baike_icon_ins-module baike_icon_ins-module-add"}),Object(S.jsx)("span",{className:Xn.a["m-card__toolbar__addtext"],children:n})]})})})}function $n(e){var t=e.edit;return Object(S.jsx)("div",{className:"toolbar-area",children:Object(S.jsx)("button",{className:"button",onClick:t,children:Object(S.jsx)(F.b,{text:"\u7f16\u8f91",popupClassName:"map-tooltip",getPopupContainer:Yn,children:Object(S.jsx)("i",{className:"icon baike_icon_word baike_icon_word-bianji"})})})})}function eo(e){var t=e.level,n=e.changeLevel;return Object(S.jsx)("div",{className:"toolbar-area",children:Object(S.jsx)(Ft.b,{className:Xn.a.select,value:t,optionLabelProp:"children",onChange:n,showSearch:!1,children:Jn})})}var to=n(1784),no=n.n(to),oo=function(e){Object(c.a)(n,e);var t=Object(r.a)(n);function n(){var e;Object(a.a)(this,n);for(var o=arguments.length,i=new Array(o),c=0;c<o;c++)i[c]=arguments[c];return(e=t.call.apply(t,[this].concat(i))).state={isFetchingTypeSchema:!0,isHoverCatalog:!1},e.remove=function(){var t=e.props.change;Object(zn.a)({component:"\u786e\u5b9a\u5220\u9664\u8be5\u6a21\u5757\u5417\uff1f",buttons:[{text:"\u53d6\u6d88",onPress:function(){}},{text:"\u786e\u8ba4",style:"active",onPress:function(){t.delete()}}]})},e.edit=function(){var t=e.props,n=(t.change,t.node),o=n.type;Wn.a.lockedHistory(),Object(Hn.a)(o,n,{isEdit:!0}).then((function(t){e.onChange(t)}))},e.add=function(){var t=e.props,n=(t.change,t.node),o=n.type;Wn.a.lockedHistory(),Object(Hn.a)(o,n).then((function(t){e.onChange(t)}))},e.onChange=function(t){var n=e.props.change;Wn.a.unLockedHistory(),n.update(t,"\u4fee\u6539\u81ea\u5b9a\u4e49\u6a21\u5757")},e.changeLevel=function(t){var n=e.props,o=n.change,a=n.node;o.update(Object(De.a)(Object(De.a)({},a),{},{data:Object(De.a)(Object(De.a)({},a.data),{},{catalog:Object(De.a)(Object(De.a)({},a.data.catalog),{},{level:t})})}),"\u4fee\u6539\u81ea\u5b9a\u4e49\u6a21\u5757")},e}return Object(i.a)(n,[{key:"componentDidMount",value:function(){var e=this,t=this.props.node.type;Pn.b.fetchTplSchemaByCardType(t).then((function(){e.setState({isFetchingTypeSchema:!1})}))}},{key:"render",value:function(){var e=this,t=this.props,n=t.node,o=t.change,a=t.id,i=n.type,c=n.data,r={level:Oe()(c,"catalog.level"),remove:this.remove,changeLevel:this.changeLevel,edit:this.edit,add:this.add,addText:qn.a[i].addButtonText||"\u65b0\u589e",type:i},s={id:a,type:i,catalog:Oe()(c,"catalog"),onMouseOver:function(){e.setState({isHoverCatalog:!0})},onMouseOut:function(){e.setState({isHoverCatalog:!1})}},l=qn.a[i].lemmaPreview,d={node:n,onChange:this.onChange,onRemove:function(){o.delete()}};return this.state.isFetchingTypeSchema?null:Object(S.jsx)("div",{className:"".concat(no.a.container," ").concat(this.state.isHoverCatalog?no.a.hoverContainer:""),children:Object(S.jsxs)("div",{className:"".concat(no.a.content,"  clearfix"),children:[Object(S.jsx)(At.a,{blurDelay:.01,forceRender:!0,popupClassName:"module-toolbar",popupPlacement:"topLeft",action:["hover"],builtinPlacements:Rt.a,popup:Object(S.jsx)(Qn,Object(De.a)({},r)),children:Object(S.jsx)("div",{children:Object(S.jsx)(Zn,Object(De.a)({},s))})}),Object(S.jsx)(l,Object(De.a)({},d))]})})}}]),n}(s.Component),ao=(n(1785),n(1085)),io=n(476),co=n(112),ro=function(e){Object(c.a)(n,e);var t=Object(r.a)(n);function n(){var e;Object(a.a)(this,n);for(var o=arguments.length,i=new Array(o),c=0;c<o;c++)i[c]=arguments[c];return(e=t.call.apply(t,[this].concat(i)))._albumDomRef=function(t,n,o){var a=e.props.nodeId;t&&ht(t,Re,{nodeData:{index:n,albumInfo:o},nodeId:a})},e.renderItem=function(t){return t.map((function(t,n){var o,a=null===(o=t.data.pics.find((function(e){return e.isCover})))||void 0===o?void 0:o.url,i=Object(co.a)(a,"",160);return Object(S.jsx)("span",{className:"swiper-li albums","data-id":t.id,children:Object(S.jsxs)("span",{className:"swiper-drag-container",ref:function(o){e._albumDomRef(o,n,t)},children:[Object(S.jsx)("img",{draggable:"false",src:i,alt:""}),Object(S.jsx)("span",{className:"total",children:t.data.pics.length}),Object(S.jsx)("span",{className:"desc",children:t.data.desc})]})},n)}))},e}return Object(i.a)(n)}(io.a);function so(e){return e.parentNode.parentNode.parentNode.parentNode.parentNode}var lo=function(e){Object(c.a)(n,e);var t=Object(r.a)(n);function n(){return Object(a.a)(this,n),t.apply(this,arguments)}return Object(i.a)(n,[{key:"render",value:function(){var e=this.props,t=e.remove,n=e.modifyAlbums;return Object(S.jsxs)("span",{className:"m-album__toolbar clearfix",children:[Object(S.jsx)("span",{className:"toolbar-area",children:Object(S.jsx)("button",{className:"button",onClick:n,children:Object(S.jsx)(F.b,{text:"\u7f16\u8f91",popupClassName:"album-tooltip",getPopupContainer:so,children:Object(S.jsx)("i",{className:"icon baike_icon_pic baike_icon_pic-tupianbianji"})})})}),Object(S.jsx)("span",{className:"toolbar-area",children:Object(S.jsx)("button",{className:"button",onClick:t,children:Object(S.jsx)(F.b,{text:"\u5220\u9664",popupClassName:"album-tooltip",getPopupContainer:so,children:Object(S.jsx)("i",{className:"icon baike_icon_pic baike_icon_pic-shanchu1"})})})})]})}}]),n}(s.Component),uo=function(e){Object(c.a)(n,e);var t=Object(r.a)(n);function n(){var e;Object(a.a)(this,n);for(var o=arguments.length,i=new Array(o),c=0;c<o;c++)i[c]=arguments[c];return(e=t.call.apply(t,[this].concat(i)))._albumsDomRef=function(t){e.albumsDom=t},e._bindDragDrop=function(){var t=e.props.node;bt(e.albumsDom,qe,{nodeData:t})},e.changeDesc=function(t){var n=e.props,o=n.node;n.change.update(Object(De.a)(Object(De.a)({},o),{},{data:Object(De.a)(Object(De.a)({},o.data),{},{desc:t})}),"\u4fee\u6539\u56fe\u96c6\u63cf\u8ff0")},e.modifyAlbums=function(){var t=e.props,n=t.node,o=t.change,a=n.data,i=a.desc,c=a.albums;Object(ao.a)({albums:c,desc:i,node:n}).then((function(t){t.albums&&t.albums.length?(n.data.albums=t.albums,n.data.desc=t.desc,o.update(n)):e.remove()})).catch((function(e){}))},e.remove=function(){e.props.change.delete()},e}return Object(i.a)(n,[{key:"componentDidUpdate",value:function(){this._bindDragDrop()}},{key:"componentDidMount",value:function(){this._bindDragDrop()}},{key:"render",value:function(){var e=this.props,t=e.node,n=e.nodeId,o=t.data,a=o.desc,i=o.albums,c={remove:this.remove,modifyAlbums:this.modifyAlbums};return Object(S.jsx)("div",{className:"albums-container",ref:this._albumsDomRef,children:Object(S.jsx)(At.a,{popupClassName:"module-toolbar",popupPlacement:"topLeft",action:["hover"],builtinPlacements:Rt.a,popup:Object(S.jsx)(lo,Object(De.a)({},c)),children:Object(S.jsxs)("div",{children:[Object(S.jsx)("div",{className:"albums-title",children:a}),Object(S.jsx)(ro,{pics:i,nodeId:n})]})})})}}]),n}(s.Component),po=(n(1786),n(69)),mo=n(318),ho=function(e){Object(c.a)(n,e);var t=Object(r.a)(n);function n(e){var o;return Object(a.a)(this,n),(o=t.call(this,e)).proxyBlur=function(e){(0,o.props.onChange)(o.input.current.value)},o.input=l.a.createRef(),o}return Object(i.a)(n,[{key:"componentDidUpdate",value:function(){var e=this.props.value;this.input.current.value=e}},{key:"render",value:function(){var e,t=this.props,n=t.value,o=t.style,a=Object(De.a)({},o);return Oe()(a,"height")&&delete a.height,Object(S.jsx)("input",(e={type:"text",className:"m-image__desc J-img-module-input",maxLength:"30",defaultValue:n,ref:this.input,onBlur:this.proxyBlur},Object(Se.a)(e,"maxLength","30"),Object(Se.a)(e,"placeholder","\u8bf7\u8f93\u5165\u56fe\u7247\u63cf\u8ff0..."),Object(Se.a)(e,"style",a),e))}}]),n}(s.Component);function bo(e,t){return e/t>1?{maxWidth:"".concat(220),maxHeight:parseInt("".concat(e/t*220))}:{maxWidth:parseInt("".concat(e/t*220)),maxHeight:"".concat(220)}}function fo(e){return e.parentNode.parentNode.parentNode.parentNode.parentNode}var vo=function(e){Object(c.a)(n,e);var t=Object(r.a)(n);function n(){var e;Object(a.a)(this,n);for(var o=arguments.length,i=new Array(o),c=0;c<o;c++)i[c]=arguments[c];return(e=t.call.apply(t,[this].concat(i))).addRef=function(){var t=e.props.modifyRef;Object(po.b)((function(e){t([e.uuid])}))},e}return Object(i.a)(n,[{key:"componentDidMount",value:function(){}},{key:"render",value:function(){var e=this.props,t=e.type,n=e.modifyType,o=e.remove,a=(e.modifyImage,e.inTd),i=e.crop,c=e.modifyAlbum,r=j()(["m-image__toolbar clearfix",t,{"m-image__toolbar--table":a}]);return Object(S.jsxs)("span",{className:r,children:[Object(S.jsx)("span",{className:"toolbar-area",children:Object(S.jsx)("button",{className:"button",onClick:i,children:Object(S.jsx)(F.b,{text:"\u88c1\u526a",getPopupContainer:fo,children:Object(S.jsx)("i",{className:"icon baike_icon_word baike_icon_word-caijian"})})})}),!a&&Object(S.jsxs)("span",{className:"toolbar-area",children:[Object(S.jsx)("button",{className:j()("button",{active:"largecenter"===t}),onClick:function(){n("largecenter")},children:Object(S.jsx)(F.b,{text:"\u5c45\u4e2d",getPopupContainer:fo,children:Object(S.jsx)("i",{className:"icon baike_icon_pic baike_icon_pic-juzhongpingpu"})})}),Object(S.jsx)("button",{className:j()("button",{active:"right"===t}),onClick:function(){n("right")},children:Object(S.jsx)(F.b,{text:"\u5c45\u53f3",getPopupContainer:fo,children:Object(S.jsx)("i",{className:"icon baike_icon_pic baike_icon_pic-juyou"})})})]}),Object(S.jsxs)("span",{className:"toolbar-area",children:[Object(S.jsx)("button",{className:"button",onClick:this.addRef,children:Object(S.jsx)(F.b,{text:"\u53c2\u8003\u8d44\u6599",children:Object(S.jsx)("i",{className:"icon baike_icon_word baike_icon_word-yinyong-copy-copy"})})}),Object(S.jsx)("button",{className:"button",onClick:c,children:Object(S.jsx)(F.b,{text:"\u8f6c\u4e3a\u56fe\u518c",getPopupContainer:fo,children:Object(S.jsx)("i",{className:"icon baike_icon_pic baike_icon_pic-tupianzhuantuce"})})}),Object(S.jsx)("button",{className:"button",onClick:o,children:Object(S.jsx)(F.b,{text:"\u5220\u9664",getPopupContainer:fo,children:Object(S.jsx)("i",{className:"icon baike_icon_pic baike_icon_pic-shanchu1"})})})]})]})}}]),n}(s.Component),jo=function(e){Object(c.a)(n,e);var t=Object(r.a)(n);function n(){var e;Object(a.a)(this,n);for(var o=arguments.length,i=new Array(o),c=0;c<o;c++)i[c]=arguments[c];return(e=t.call.apply(t,[this].concat(i)))._floatDomRef=function(t){e.floatDom=t},e._bindDragDrop=function(){if(e.floatDom){var t=e.props.node;ht(e.floatDom,Ee,{nodeData:t}),bt(e.floatDom,Pe,{nodeData:t})}},e.changeDesc=function(t){var n=e.props,o=n.node;n.change.update(Object(De.a)(Object(De.a)({},o),{},{data:Object(De.a)(Object(De.a)({},o.data),{},{desc:t})}),"\u4fee\u6539\u56fe\u7247\u63cf\u8ff0")},e.modifyRef=function(t){var n=e.props,o=n.node;n.change.update(Object(De.a)(Object(De.a)({},o),{},{data:Object(De.a)(Object(De.a)({},o.data),{},{reference:t})}),"\u4fee\u6539\u53c2\u8003\u8d44\u6599")},e.modifyType=function(t){var n=e.props,o=n.node;n.change.update(Object(De.a)(Object(De.a)({},o),{},{data:Object(De.a)(Object(De.a)({},o.data),{},{type:t})}),"\u4fee\u6539\u56fe\u7247\u7c7b\u578b")},e.modifyImage=function(){var t=e.props,n=t.node,o=t.change;Object(U.l)("").then((function(e){n.data=Object(De.a)(Object(De.a)({},n.data),e),o.update(n,"\u4fee\u6539\u56fe\u7247")})).catch((function(e){}))},e.modifyAlbum=function(){var t=e.props,n=t.node,o=t.change,a=n.data,i=a.desc,c=a.height,r=a.picId,s=a.type,l=a.url,d=a.width,u={id:Object(zt.a)(),desc:i,height:c,picId:r,url:l,width:d,isCover:!0};Object(U.n)({imgs:[u],desc:i,title:"\u8f6c\u4e3a\u56fe\u518c",node:n}).then((function(t){t.imgs&&(t.imgs.length>0&&(n.data={pics:t.imgs,type:"right"===s?"right":"gallery",desc:t.desc},n.type=Tt.a,o.update(n,"\u4fee\u6539\u56fe\u7247\u683c\u5f0f")),0===t.imgs.length&&e.remove())})).catch((function(e){}))},e.remove=function(){e.props.change.delete()},e.crop=function(){var t=e.props,n=t.node,o=t.change;Object(U.k)(n.data).then((function(e){n.data=Object(De.a)(Object(De.a)({},n.data),{},{url:e.url,picId:e.picId,width:e.width,height:e.height}),o.update(n,"\u88c1\u526a\u56fe\u7247")})).catch((function(e){}))},e}return Object(i.a)(n,[{key:"componentDidMount",value:function(){this._bindDragDrop()}},{key:"componentDidUpdate",value:function(){this._bindDragDrop()}},{key:"render",value:function(){var e=this.props,t=e.node,n=e.dom,o=t.data,a=o.type,i=o.reference,c=o.url,r=o.desc,s=void 0===r?"":r,l=o.width,d=o.height,u=n.closest("td"),p="J-img-module m-image ".concat(a=u?"right":a),m={inTd:u,type:o.type,remove:this.remove,modifyType:this.modifyType,modifyRef:this.modifyRef,modifyImage:this.modifyImage,modifyAlbum:this.modifyAlbum,crop:this.crop},h=null;if(u){var b=bo(l,d);c=Object(co.a)(c,b.maxWidth,b.maxHeight),h={maxWidth:"".concat(b.maxWidth,"px"),maxHeight:"".concat(b.maxHeight,"px")}}else if("largecenter"===a){var f=function(e,t){var n=Math.min(640,e),o=Math.min(500,t),a={height:n*t/e,width:n};return a.height>o&&(a={height:o,width:o*e/t}),a}(l,d);c=Object(co.a)(c,f.width,f.height)}else c=Object(co.a)(c,220,"");return Object(S.jsx)("span",{className:p,children:Object(S.jsxs)("span",{className:"m-image__body",children:[c&&Object(S.jsxs)(S.Fragment,{children:[Object(S.jsx)(mo.a,{reference:i,change:this.modifyRef,popupPlacement:"bottom",popupAlign:{offset:[0,10]}}),Object(S.jsx)(At.a,{popupClassName:"module-toolbar",popupPlacement:"topLeft",action:["hover"],builtinPlacements:Rt.a,popup:Object(S.jsx)(vo,Object(De.a)({},m)),children:Object(S.jsx)("span",{className:"image__container",ref:this._floatDomRef,children:Object(S.jsx)("img",{draggable:"false",className:"image__container__img",alt:"",src:c,style:h})})})]}),Object(S.jsx)(ho,{onChange:this.changeDesc,value:s,style:h})]})})}}]),n}(s.Component),go=(n(1787),n(96)),xo=n.n(go),Oo=n(369),yo={gallery:"gallery",bigGallery:"bigGallery",right:"right"},Co=function(e){Object(c.a)(n,e);var t=Object(r.a)(n);function n(){var e;Object(a.a)(this,n);for(var o=arguments.length,i=new Array(o),c=0;c<o;c++)i[c]=arguments[c];return(e=t.call.apply(t,[this].concat(i)))._imgDomRef=function(t,n,o){var a=e.props.nodeId;t&&ht(t,Le,{nodeData:{index:n,picinfo:o},nodeId:a})},e.renderItem=function(t){var n=e.props.type;return t.map((function(t,o){var a=160,i=Object(co.a)(t.url,"",160);n===yo.bigGallery&&(i=Object(co.a)(t.url,"",500),a=500);var c={height:"".concat(a,"px")};return Object(S.jsx)("span",{className:"swiper-li",children:Object(S.jsx)("img",{className:"album__img",src:i,alt:"",style:c,ref:function(n){e._imgDomRef(n,o,t)}})},"".concat(i).concat(o))}))},e}return Object(i.a)(n,[{key:"componentDidUpdate",value:function(e,t,n){var o=this;this.props.pics.toString()===e.pics.toString()&&this.props.type===e.type||this.setState({currentIndex:0},(function(){o.animateTo()}))}}]),n}(io.a);function No(e){return e.parentNode.parentNode.parentNode.parentNode.parentNode}var _o=function(e){Object(c.a)(n,e);var t=Object(r.a)(n);function n(){return Object(a.a)(this,n),t.apply(this,arguments)}return Object(i.a)(n,[{key:"render",value:function(){var e=this.props,t=e.type,n=e.modifyType,o=e.remove,a=e.modifyAlbum,i=e.inTd,c=j()(["m-album__toolbar clearfix",t,{"m-album__toolbar--table":i}]),r=Object(g.a)("userInfo").editPrivilege,s=(void 0===r?{}:r).bigGalleryAlbum,l=void 0===s?0:s;return Object(S.jsxs)("span",{className:c,children:[Object(S.jsx)("span",{className:"toolbar-area",children:Object(S.jsx)("button",{className:"button",onClick:a,children:Object(S.jsx)(F.b,{text:"\u7f16\u8f91",popupClassName:"album-tooltip",getPopupContainer:No,children:Object(S.jsx)("i",{className:"icon baike_icon_pic baike_icon_pic-tupianbianji"})})})}),!i&&Object(S.jsxs)("span",{className:"toolbar-area",children:[Object(S.jsx)("button",{className:j()("button",{active:t===yo.gallery}),onClick:function(){n(yo.gallery)},children:Object(S.jsx)(F.b,{text:"\u5e73\u94fa",popupClassName:"album-tooltip",getPopupContainer:No,children:Object(S.jsx)("i",{className:"icon baike_icon_pic baike_icon_pic-gallery"})})}),0!==l&&Object(S.jsx)("button",{className:j()("button",{active:t===yo.bigGallery}),onClick:function(){n(yo.bigGallery)},children:Object(S.jsx)(F.b,{text:"\u5927\u56fe\u5e73\u94fa",popupClassName:"album-tooltip",getPopupContainer:No,children:Object(S.jsx)("i",{className:"icon baike_icon_pic baike_icon_pic-bigGallery"})})}),Object(S.jsx)("button",{className:j()("button",{active:t===yo.right}),onClick:function(){n(yo.right)},children:Object(S.jsx)(F.b,{text:"\u5c45\u53f3",popupClassName:"album-tooltip",getPopupContainer:No,children:Object(S.jsx)("i",{className:"icon baike_icon_pic baike_icon_pic-juyou"})})})]}),Object(S.jsx)("span",{className:"toolbar-area",children:Object(S.jsx)("button",{className:"button",onClick:o,children:Object(S.jsx)(F.b,{text:"\u5220\u9664",popupClassName:"album-tooltip",getPopupContainer:No,children:Object(S.jsx)("i",{className:"icon baike_icon_pic baike_icon_pic-shanchu1"})})})})]})}}]),n}(s.Component),ko=function(e){Object(c.a)(n,e);var t=Object(r.a)(n);function n(){var e;Object(a.a)(this,n);for(var o=arguments.length,i=new Array(o),c=0;c<o;c++)i[c]=arguments[c];return(e=t.call.apply(t,[this].concat(i)))._floatDomRef=function(t){e.floatDom=t},e._bindDragDrop=function(){if(e.floatDom){var t=e.props.node;ht(e.floatDom,Me,{nodeData:t}),bt(e.floatDom,ze,{nodeData:t})}},e.changeDesc=function(t){var n=e.props,o=n.node;n.change.update(Object(De.a)(Object(De.a)({},o),{},{data:Object(De.a)(Object(De.a)({},o.data),{},{desc:t})}),"\u4fee\u6539\u56fe\u518c\u63cf\u8ff0")},e.modifyType=function(t){var n=e.props,o=n.node;n.change.update(Object(De.a)(Object(De.a)({},o),{},{data:Object(De.a)(Object(De.a)({},o.data),{},{type:t})}),"\u4fee\u6539\u56fe\u518c\u7c7b\u578b")},e.modifyAlbum=function(){var t=e.props,n=t.node,o=t.change,a=n.data,i=(a.type,a.desc),c=a.pics;Object(Oo.a)({imgs:c,desc:i,node:n}).then((function(t){t.imgs&&t.imgs.length?(n.data.pics=t.imgs,n.data.desc=t.desc,o.update(n)):e.remove()})).catch((function(e){}))},e.remove=function(){e.props.change.delete()},e}return Object(i.a)(n,[{key:"componentDidUpdate",value:function(){this._bindDragDrop()}},{key:"componentDidMount",value:function(){this._bindDragDrop()}},{key:"render",value:function(){var e=this.props,t=e.node,n=e.dom,o=(e.nodeId,t.data),a=o.desc,i=o.type,c=o.pics,r=n.closest("td"),s="J-img-module m-album "+(i=r?"right":i),l={inTd:r,type:o.type,remove:this.remove,modifyType:this.modifyType,modifyAlbum:this.modifyAlbum},d=0===xo()(a).length?Object(S.jsx)("span",{className:"invalid-feedback required",children:"\u5fc5\u586b"}):null,u=function(e,t,n,o){var a={},i=null;if(e===yo.right){var c=t.filter((function(e){return e.isCover}));if(c=c[0]||t[0]){var r=c,s=r.url,l=r.width,d=r.height;if(a=null,o){var u=bo(l,d);s=Object(co.a)(s,u.maxWidth,u.maxHeight),a={maxWidth:"".concat(u.maxWidth,"px"),maxHeight:"".concat(u.maxHeight,"px")}}else s=Object(co.a)(s,220,""),a={maxWidth:"".concat(220,"px")};i=Object(S.jsxs)(S.Fragment,{children:[Object(S.jsx)("img",{draggable:"false",className:"m-album__single-img",alt:"",src:s,style:a}),Object(S.jsx)("span",{className:"m-album__singletag",children:t.length})]})}}else t&&t.length>0&&(i=Object(S.jsx)(Co,{pics:t,type:e}));return{picCom:i,style:a}}(i,c,0,r),p=u.picCom,m=u.style;return Object(S.jsx)("span",{className:s,children:Object(S.jsxs)("span",{className:"album__content",ref:this._floatDomRef,children:[Object(S.jsx)(At.a,{popupClassName:"module-toolbar",popupPlacement:"topLeft",action:["hover"],builtinPlacements:Rt.a,popup:Object(S.jsx)(_o,Object(De.a)({},l)),children:Object(S.jsx)("span",{className:"m-album",children:p})}),Object(S.jsxs)("span",{className:"m-album__desc",children:[Object(S.jsx)(ho,{onChange:this.changeDesc,value:a,placeholder:"\u8bf7\u8f93\u5165\u56fe\u518c\u63cf\u8ff0...",style:m}),d]})]})})}}]),n}(s.Component),Io=n(89);n(1788);function wo(e){return e.parentNode.parentNode.parentNode.parentNode.parentNode}var Do,So=function(e){Object(c.a)(n,e);var t=Object(r.a)(n);function n(){var e;Object(a.a)(this,n);for(var o=arguments.length,i=new Array(o),c=0;c<o;c++)i[c]=arguments[c];return(e=t.call.apply(t,[this].concat(i))).addRef=function(){var t=e.props.modifyRef;Object(po.b)((function(e){t([e.uuid])}))},e}return Object(i.a)(n,[{key:"render",value:function(){var e=this.props,t=e.remove,n=e.crop,o=e.permission,a=void 0===o?0:o;return Object(S.jsx)("span",{className:"m-image__toolbar clearfix",children:Object(S.jsxs)("span",{className:"toolbar-area",children:[0!==a&&Object(S.jsx)("button",{className:"button",onClick:n,children:Object(S.jsx)(F.b,{text:"\u88c1\u526a",popupClassName:"image-tooltip",getPopupContainer:wo,children:Object(S.jsx)("i",{className:"icon baike_icon_word baike_icon_word-caijian"})})}),Object(S.jsx)("button",{className:"button",onClick:this.addRef,children:Object(S.jsx)(F.b,{text:"\u53c2\u8003\u8d44\u6599",children:Object(S.jsx)("i",{className:"icon baike_icon_word baike_icon_word-yinyong-copy-copy"})})}),Object(S.jsx)("button",{className:"button",onClick:t,children:Object(S.jsx)(F.b,{text:"\u5220\u9664",popupClassName:"image-tooltip",getPopupContainer:wo,children:Object(S.jsx)("i",{className:"icon baike_icon_pic baike_icon_pic-shanchu1"})})})]})})}}]),n}(s.Component),Eo="largecenter",Mo="right",Lo=function(e){Object(c.a)(n,e);var t=Object(r.a)(n);function n(){var e;Object(a.a)(this,n);for(var o=arguments.length,i=new Array(o),c=0;c<o;c++)i[c]=arguments[c];return(e=t.call.apply(t,[this].concat(i)))._floatDomRef=function(t){e.floatDom=t},e._bindDragDrop=function(){var t=e.props.node;e.floatDom&&(ht(e.floatDom,Te,{nodeData:t}),bt(e.floatDom,He,{nodeData:t}))},e.changeDesc=function(t){var n=e.props,o=n.node;n.change.update(Object(De.a)(Object(De.a)({},o),{},{data:Object(De.a)(Object(De.a)({},o.data),{},{desc:t})}),"\u4fee\u6539\u56fe\u7247\u63cf\u8ff0")},e.remove=function(){e.props.change.delete()},e.crop=function(){var t=e.props,n=t.node,o=t.change;Object(U.k)(n.data).then((function(e){var t=e.width,a=e.height;n.data=Object(De.a)(Object(De.a)({},n.data),{},{url:e.url,picId:e.picId,width:t,height:a}),a>=320&&t>=3*a||t>=320&&a>=3*t?(n.data.type=a>t?Mo:Eo,o.update(n,"\u88c1\u526a\u56fe\u7247")):(Io.a.error("\u56fe\u7247\u5c3a\u5bf8\u4e0d\u7b26\u5408\u5168\u666f\u56fe\u8981\u6c42\uff08\u957f\u8fb9:\u77ed\u8fb9\u22653:1\uff09\uff0c\u5df2\u81ea\u52a8\u4e3a\u60a8\u8f6c\u6362\u4e3a\u666e\u901a\u56fe\u7247\u5c55\u793a~",4e3),n.type=Tt.y,n.data.type="right",o.update(n,"\u4fee\u6539\u56fe\u7247\u683c\u5f0f"))})).catch((function(e){}))},e.modifyRef=function(t){var n=e.props,o=n.node;n.change.update(Object(De.a)(Object(De.a)({},o),{},{data:Object(De.a)(Object(De.a)({},o.data),{},{reference:t})}),"\u4fee\u6539\u53c2\u8003\u8d44\u6599")},e}return Object(i.a)(n,[{key:"componentDidMount",value:function(){this._bindDragDrop()}},{key:"componentDidUpdate",value:function(){this._bindDragDrop()}},{key:"render",value:function(){var e=this.props,t=e.node,n=(e.change,Object(g.a)("userInfo").editPrivilege),o=(void 0===n?{}:n).bigPic,a=void 0===o?0:o,i=t.data,c=i.type,r=i.url,s=i.desc,l=void 0===s?"":s,d=i.width,u=i.height,p=i.reference;u>d?(r=Object(co.a)(r,200,""),c=Mo):(r=Object(co.a)(r,"",250),c=Eo);var m={permission:a,remove:this.remove,modifyRef:this.modifyRef,crop:this.crop};return Object(S.jsx)("span",{className:"J-img-module m-panorama ".concat(c),children:Object(S.jsxs)("span",{className:"m-panorama__body",children:[r&&Object(S.jsxs)(S.Fragment,{children:[Object(S.jsx)(mo.a,{reference:p,change:this.modifyRef,popupPlacement:"bottom",popupAlign:{offset:[0,10]},style:{top:"2px",right:"2px"}}),Object(S.jsx)(At.a,{popupClassName:"module-toolbar",popupPlacement:"topLeft",action:["hover"],builtinPlacements:Rt.a,popup:Object(S.jsx)(So,Object(De.a)({},m)),children:Object(S.jsx)("span",{className:"panorama__container",ref:this._floatDomRef,children:Object(S.jsx)("img",{draggable:"false",className:"panorama__img",alt:l,src:r})})})]}),0===a&&Object(S.jsx)("span",{className:"m-image__desc",children:l}),0!==a&&Object(S.jsx)(ho,{onChange:this.changeDesc,value:l})]})})}}]),n}(s.Component),To=(Do={},Object(Se.a)(Do,Tt.y,{com:jo}),Object(Se.a)(Do,Tt.a,{com:ko}),Object(Se.a)(Do,Tt.b,{com:uo}),Object(Se.a)(Do,Tt.A,{com:Lo}),Object(Se.a)(Do,Tt.j,{com:oo}),Object(Se.a)(Do,Tt.t,{com:oo}),Object(Se.a)(Do,Tt.k,{com:oo}),Object(Se.a)(Do,Tt.m,{com:oo}),Object(Se.a)(Do,Tt.v,{com:oo}),Object(Se.a)(Do,Tt.l,{com:oo}),Object(Se.a)(Do,Tt.h,{com:oo}),Object(Se.a)(Do,Tt.f,{com:oo}),Object(Se.a)(Do,Tt.d,{com:oo}),Object(Se.a)(Do,Tt.c,{com:oo}),Object(Se.a)(Do,Tt.r,{com:oo}),Object(Se.a)(Do,Tt.s,{com:oo}),Object(Se.a)(Do,Tt.o,{com:oo}),Object(Se.a)(Do,Tt.i,{com:oo}),Object(Se.a)(Do,Tt.g,{com:oo}),Object(Se.a)(Do,Tt.e,{com:oo}),Object(Se.a)(Do,Tt.w,{com:oo}),Object(Se.a)(Do,Tt.n,{com:oo}),Object(Se.a)(Do,Tt.q,{com:oo}),Object(Se.a)(Do,Tt.u,{com:oo}),Object(Se.a)(Do,Tt.p,{com:oo}),Object(Se.a)(Do,Tt.z,{com:Wt}),Object(Se.a)(Do,Tt.x,{com:on}),Object(Se.a)(Do,Tt.B,{com:Bn}),Do),Ro=Object(Lt.a)(To),Ao=(n(1789),n(13)),Bo=n(77),Po=n(99),zo=n(495),Ho=n(60);var qo=n(496),Wo=n(130),Fo=n(1790),Uo=n.n(Fo),Zo={display:"block",opacity:0,position:"absolute",top:0,left:0,height:"100%",width:"100%",overflow:"hidden",pointerEvents:"none",zIndex:-1},Vo=function(e){var t=e.onResize,n=Object(s.useRef)();return function(e,t){var n=function(){return e.current&&e.current.contentDocument&&e.current.contentDocument.defaultView};function o(){t();var e=n();e&&e.addEventListener("resize",t)}Object(s.useEffect)((function(){return n()?o():e.current&&e.current.addEventListener&&e.current.addEventListener("load",o),function(){var e=n();e&&"function"===typeof e.removeEventListener&&e.removeEventListener("resize",t)}}),[])}(n,(function(){return t(n)})),Object(S.jsx)("iframe",{style:Zo,src:"about:blank",ref:n,"aria-hidden":!0,tabIndex:-1,frameBorder:0})},Xo=function(e){return{width:null!==e?e.offsetWidth:null,height:null!==e?e.offsetHeight:null}};var Yo=function(){if(!Object(Wo.b)())return null;var e=Object(s.useState)(!1),t=Object(Ao.a)(e,2),n=t[0],a=t[1];!function(e,t){var n=Object(s.useRef)(e);Object(s.useEffect)((function(){n.current=e}),[e]),Object(s.useEffect)((function(){if(!(t<0)){var e=setTimeout((function(){return n.current&&n.current()}),t);return function(){return clearTimeout(e)}}}),[t])}((function(){a(!0)}),200);var i=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Xo,t=Object(s.useState)(e(null)),n=Object(Ao.a)(t,2),o=n[0],a=n[1],i=Object(s.useCallback)((function(t){return a(e(t.current))}),[e]);return[Object(s.useMemo)((function(){return Object(S.jsx)(Vo,{onResize:i})}),[i]),o]}(),c=Object(Ao.a)(i,2),r=c[0],l=function(e,t){var n=Object(s.useState)([]),o=Object(Ao.a)(n,2),a=o[0],i=o[1];return Object(s.useEffect)((function(){var e,t,n,o,a,c,r,s=null;null!==(e=window)&&void 0!==e&&null!==(t=e.__contextEditor)&&void 0!==t&&t.context.root&&(s=null===(c=window)||void 0===c||null===(r=c.__contextEditor)||void 0===r?void 0:r.context.root.getBoundingClientRect());var l=[].slice.call((null===(n=window)||void 0===n||null===(o=n.__contextEditor)||void 0===o||null===(a=o.context.root)||void 0===a?void 0:a.querySelectorAll("h2"))||[]);i(l.filter((function(e){return Object(ie.a)(e,["h2"])})).map((function(e){var t=e.getBoundingClientRect(),n=t.x,o=t.y,a=s,i=a.x,c=a.y;return{id:e.getAttribute("data-id"),x:n-i,y:o-c}})))}),[e,t]),{h2DomRect:a}}(c[1],n),d=l.h2DomRect,u=Object(Bo.d)((function(e){return e.acl.needLockedList})),p=Object(Bo.d)((function(e){var t=[],n=e.lock.lockedModules.find((function(e){return e.locateType===Ho.a.content}));return n&&(t=n.list.reduce((function(e,t){return[].concat(Object(o.a)(e),Object(o.a)(t.list))}),[])),t})),m=Object(qo.b)().toggleLock;return Object(S.jsxs)(S.Fragment,{children:[r,d.map((function(e){var t=e.x,n=e.y,a=e.id,i=u.find((function(e){return e===a})),c=p.find((function(e){return e===a})),r=j()([Uo.a.btn,Object(Se.a)({},Uo.a["btn--lock"],i)]);return Object(S.jsx)("span",{className:r,style:{position:"absolute",right:"0px",top:"".concat(n,"px")},onClick:function(){if(c)Object(zn.a)({component:"\u5f53\u524d\u76ee\u5f55\u6b63\u5728\u5ba1\u6838\u4e2d\uff0c\u6682\u4e0d\u53ef\u7f16\u8f91",buttons:[{text:"\u786e\u5b9a",onPress:function(){}}]});else{var e=Object(Po.f)();i?Object(zn.a)({component:"\u8bf7\u786e\u8ba4\u662f\u5426\u53d6\u6d88\u9501\u5b9a\u8be5\u76ee\u5f55\uff0c\u89e3\u9501\u4e14\u5ba1\u6838\u901a\u8fc7\u540e\uff0c\u5176\u4ed6\u7528\u6237\u53ef\u7f16\u8f91\u8be5\u76ee\u5f55\u4e0b\u5185\u5bb9",buttons:[{text:"\u786e\u8ba4\u89e3\u9501",onPress:function(){e=e.filter((function(e){return e!==a})),m(e)}},{text:"\u53d6\u6d88",style:"active",onPress:function(){m(e)}}]}):(e.length>=4?U.p.info("\u4f01\u4e1a\u8ba4\u8bc1\u9501\u5b9a\u7684\u4e00\u7ea7\u76ee\u5f55\u5df2\u8fbe4\u4e2a\uff0c\u8bf7\u89e3\u9501\u5176\u5b83\u4e00\u7ea7\u76ee\u5f55\u540e\u518d\u8bd5"):e=[].concat(Object(o.a)(e),[a]),m(e))}},children:Object(S.jsx)(F.b,{text:i?"\u70b9\u51fb\u6b64\u5904\u53ef\u89e3\u9501\u5f53\u524d\u76ee\u5f55\uff0c\u5ba1\u6838\u901a\u8fc7\u540e\u5176\u4ed6\u7528\u6237\u53ef\u7f16\u8f91\u76ee\u5f55\u4e0b\u5185\u5bb9":"\u70b9\u51fb\u6b64\u5904\u9501\u5b9a\u5f53\u524d\u4e00\u7ea7\u76ee\u5f55\uff0c\u5ba1\u6838\u901a\u8fc7\u540e\uff0c\u5176\u4ed6\u7528\u6237\u5c06\u65e0\u6cd5\u7f16\u8f91\u8be5\u76ee\u5f55\u4e0b\u5185\u5bb9",children:i?Object(S.jsxs)(S.Fragment,{children:[Object(S.jsx)(zo.a,{className:Uo.a.icon}),"\u5df2\u9501\u5b9a"]}):Object(S.jsx)(S.Fragment,{children:!c&&Object(S.jsxs)(S.Fragment,{children:[Object(S.jsx)(zo.c,{className:Uo.a.icon}),"\u53bb\u9501\u5b9a"]})})})},"".concat(t).concat(n))}))]})},Jo=n(153),Qo=n(93),Ko=function(e){Object(c.a)(n,e);var t=Object(r.a)(n);function n(){var e;Object(a.a)(this,n);for(var o=arguments.length,i=new Array(o),c=0;c<o;c++)i[c]=arguments[c];return(e=t.call.apply(t,[this].concat(i)))._editorDivOnRef=function(t){e._editorDiv=t},e}return Object(i.a)(n,[{key:"getEditorOptions",value:function(){var e=Object(wt.a)(),t=[].concat(Object(o.a)(e),[new St.a,new m.a((function(e,t){var n=e.context.root,o=e.context.triggleContentChangeType;[p.a.inited].indexOf(o)>-1?Object(It.a)(n,null,o):(t=t||[],Object(It.a)(n,t,o))})),new we.a,new H,new h.a(this.props.placeholder||"\u8bf7\u8be6\u7ec6\u63cf\u8ff0\u8bcd\u6761\u7684\u4e3b\u8981\u5185\u5bb9"),new te.a((function(e){[].slice.call(e.querySelectorAll("section")).forEach((function(e){Object(Ne.isModule)(e)&&(Object(Ne.getModuleInfo)(e)?Object(Ne.moduleIsCard)(e)&&e.remove():Object(Dt.a)(e))})),Object(It.a)(e),Object(It.a)(e)}),(function(e){Object(Et.a)(e)})),new ne.a,new oe.a,new ae.a,new fe,new ke.a,new Ie.a,new ve.a,new je.a,new _e,new ee,new Ot,new kt,new ge.a(new Mt.a(Ro)),new Jo.c({applyModule:"content"})]),n=this.props.change;return{customAttributes:{type:u.b},initialContent:this.props.html,plugins:t,changed:function(e){if(n){var t=e.context.triggleContentChangeType,o=e.getContent();n(o);var a=[p.a.toggleBold,p.a.toggleItalic,p.a.toggleLink,p.a.toggleRef,p.a.toggleSup,p.a.toggleSub,p.a.toggleList,p.a.toggleHeader,p.a.blur,p.a.math,p.a.drop,p.a.manuallyDelete,p.a.specialCharacter,"".concat(p.a.moduleOpPrefix,"_").concat(p.a.input200ms),"".concat(p.a.moduleOpPrefix,"_").concat(p.a.compositionend),"".concat(p.a.moduleOpPrefix,"_").concat(p.a.toggleBold),"".concat(p.a.moduleOpPrefix,"_").concat(p.a.toggleItalic),"".concat(p.a.moduleOpPrefix,"_").concat(p.a.toggleLink),"".concat(p.a.moduleOpPrefix,"_").concat(p.a.toggleRef),"".concat(p.a.moduleOpPrefix,"_").concat(p.a.toggleSup),"".concat(p.a.moduleOpPrefix,"_").concat(p.a.toggleSub),"".concat(p.a.moduleOpPrefix,"_").concat(p.a.toggleList),"".concat(p.a.moduleOpPrefix,"_").concat(p.a.toggleHeader),"".concat(p.a.moduleOpPrefix,"_").concat(p.a.blur),"".concat(p.a.moduleOpPrefix,"_").concat(p.a.moduleOpInsert),"".concat(p.a.moduleOpPrefix,"_").concat(p.a.moduleOpModify),"".concat(p.a.moduleOpPrefix,"_").concat(p.a.math),"".concat(p.a.moduleOpPrefix,"_").concat(p.a.specialCharacter)];Object(Qo.a)()?a.push(p.a.contentChange):a.push.apply(a,[p.a.paste,p.a.input200ms,p.a.compositionend]),a.indexOf(t)>-1&&window.bkeAddUndoApi("\u4fee\u6539\u6b63\u6587\u6dfb\u52a0\u5386\u53f2\u8bb0\u5f55".concat(t))}}}}},{key:"componentDidMount",value:function(){this.editor=new d.a(this._editorDiv,this.getEditorOptions()),window.__contextEditor=this.editor}},{key:"componentWillUnmount",value:function(){this.editor&&this.editor.dispose()}},{key:"componentDidUpdate",value:function(){this.editor.setContent(this.props.html)}},{key:"render",value:function(){var e=(this.props.className||"")+"eeditor__editor--context eeditor__editor J-editor-for-dom-plugin clearfix";return Object(S.jsxs)("div",{className:"eeditor",children:[Object(S.jsx)("div",{spellCheck:"false",className:e,ref:this._editorDivOnRef}),Object(S.jsx)(Yo,{})]})}}]),n}(s.Component);Ko.defaultProps={placeholder:""}},394:function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),n.d(t,"c",(function(){return s})),n.d(t,"b",(function(){return l}));var o=n(39),a=n(44),i=n(35),c=n(253),r=function(e,t,n){e.triggleContentChange((function(){t=Object(c.a)(t);var r=Object(i.a)("p",t||"<br>",{});n||(n=e.context._current1LevelEleForInsert),Object(o.a)(r,n);var s=document.createRange();if(t){var l=t.length,d=r.childNodes[0];s.setStart(d,l),s.setStart(d,l)}else s.setStart(r,0),s.setStart(r,0);Object(a.a)(s)}),"\u63d2\u5165\u6bb5\u843d")},s=function(e,t,n){e.triggleContentChange((function(){t=Object(c.a)(t);var r=Object(i.a)("p",t||"<br>",{});n||(n=e.context._current1LevelEleForInsert),Object(o.a)(r,n);var s=document.createRange();s.setStart(r,0),s.setStart(r,0),Object(a.a)(s)}),"\u63d2\u5165\u6bb5\u843d")},l=function(e,t,n){n||(n=e.context._current1LevelEleForInsert),n&&e.triggleContentChange((function(){t=Object(c.a)(t);var o=Object(i.a)("p",t||"<br>",{});e.context.root.insertBefore(o,n);var r=document.createRange();if(t){var s=t.length,l=o.childNodes[0];r.setStart(l,s),r.setStart(l,s)}else r.setStart(o,0),r.setStart(o,0);Object(a.a)(r)}),"\u63d2\u5165\u6bb5\u843d\u5728\u5149\u6807\u4e4b\u524d")}},465:function(e,t,n){"use strict";n.d(t,"a",(function(){return $})),n.d(t,"b",(function(){return ee}));var o=n(58),a=n(10),i=n(42),c=n(79),r=n(2),s=n(63),l=n(105),d=n(96),u=n.n(d),p=n(25),m=n(26),h=n(142),b=n(94),f=n(120),v=n(179),j=function(e){return e=e||"largecenter",{key:["img"].reduce((function(e,t){return e.push("".concat(i.b.common,"_").concat(t,"_").concat("")),e}),[]),revise:function(t,n,o){if(function(e){return!(!Object(p.a)(e,["img"])||!e.getAttribute("src"))&&0!==e.getAttribute("src").indexOf("file://")}(t)){var a=t.getAttribute("src"),i=t.getAttribute("title")||"",c=Object(m.createInline)(Object(h.e)({type:e,height:220,width:220,picId:"8601a18b87d6277f9e2f2cf4fa700830e924b99956ec",url:"//baikebcs.bdimg.com/cms/wiki-react-editor/img/loading.svg",desc:i}));t.parentNode.replaceChild(c,t);var r=c.getAttribute("data-id");return x(r,a),c}return!1}}},g=function(e){return document.querySelector('[data-id="'.concat(e,'"]'))||document.getElementById(e)},x=function(e,t){b.a.lockedHistory(),Object(f.b)(t).then((function(t){b.a.unLockedHistory(),function(e,t){var n=g(e);if(n){var o=Object(m.getModuleInfo)(n);n.change.update(Object(r.a)(Object(r.a)({},o),{},{data:Object(r.a)(Object(r.a)({},o.data),{},{height:t.height,width:t.width,picId:t.picId,url:t.url})}))}}(e,t)})).catch((function(){b.a.unLockedHistory();var t=g(e);if(t){var n=Object(v.a)(t);t.remove(),n.__editor.triggleContentChange((function(){}),"\u4e0a\u4f20\u590d\u5236\u9ecf\u8d34\u7684\u56fe\u7247\u5931\u8d25")}}))},O=n(143),y=n(20),C=new i.a({rules:[],usePersonalRule:!0}),N=[{key:["h2","h3"].reduce((function(e,t){return e.push("".concat(i.b.common,"_").concat(t,"_").concat("")),e}),[]),revise:function(e,t,n){return Object(l.a)(n,e),Object(y.c)()?Object(s.a)(e,["data-id","class"]):Object(s.a)(e,["data-id"]),Object(O.a)(e),!function(e){return""===e.textContent}(e)?C.revise(e):e.querySelector("br")||e.appendChild(document.createElement("br")),!0}}],_=n(172),k=n(4),I=n(3),w=n(14),D=(n(6),n(86)),S=function(){function e(t){var n=this;if(Object(k.a)(this,e),this.table=t,this.table){var o=[].slice.call(this.table.rows),a=0;for(o.forEach((function(e,t){[].slice.call(e.cells).forEach((function(e){t+e.rowSpan>a&&(a=t+e.rowSpan)}))}));this.table.rows.length<a;)this.table.insertRow();o=[].slice.call(this.table.rows),this.cells=o.map((function(e){return[]})),o.forEach((function(e,t){for(var o=0,a=0;o<e.cells.length;o++){for(;n.cells[t][a];a++);for(var i=e.cells[o],c=0;c<i.colSpan;c++,a++)for(var r=0;r<i.rowSpan;r++)c+r===0&&ee(i),n.cells[t+r][a]={td:c+r===0?i:null}}})),this.fixCell()}}return Object(I.a)(e,[{key:"computedTable",value:function(){var e=this;if(0===this.colLength)return null;var t=!1;try{t=Object(p.a)(this.cells[0][this.cells[0].length-1].td,["th"])}catch(a){}var n=!1;try{n=Object(p.a)(this.cells[this.cells.length-1][0].td,["th"])}catch(a){}var o="<table".concat(t?" ".concat("data-horizontalth",'="1"'):"").concat(n?" ".concat("data-verticalth",'="1"'):"",">");return{type:w.B,data:{title:"",html:"".concat(o,"<colgroup>")+this.cells[0].reduce((function(t,n){var o=720/e.colLength;return t+='<col width="'.concat(o,'"/>')}),"")+"</colgroup><tbody>"+this.cells.reduce((function(e,t){return e+='<tr height="30">'+t.reduce((function(e,t){return t.td&&(e+="<td colspan='".concat(t.td.colSpan||1,"' rowspan='").concat(t.td.rowSpan||1,"' align='").concat(t.td.align||"","'>").concat(t.td.innerHTML,"</td>")),e}),"")+"</tr>"}),"")+"</tbody></table>"}}}},{key:"fixCell",value:function(){var e=this;this.colLength=this.cells.reduce((function(e,t){return t.length>e?t.length:e}),0),this.cells=this.cells.map((function(t){for(;t.length<e.colLength;){var n=document.createDocumentFragment(),o=document.createElement("td");o.innerHTML=Object(D.a)(),n.appendChild(o),t.push({td:n.firstElementChild})}return t}))}}]),e}(),E=[_.a,{key:"".concat(i.b.common,"_","table","_"),revise:function(e,t,n){Object(l.a)(n,e);var o=new S(e),a=Object(m.createBlock)(o.computedTable());return e.parentNode.replaceChild(a,e),a}},{key:["".concat(i.b.common,"_","code","_")],revise:function(e,t,n){Object(l.a)(n,e);var o=Object(m.createBlock)(Object(h.d)(e.innerText));return e.parentNode.replaceChild(o,e),o}}],M=n(164);function L(e,t){[].slice.call(e.childNodes).reduce((function(e,t){if(!Object(M.a)(t))if(Object(M.a)(t.previousSibling))t.previousSibling.appendChild(t);else{var n=document.createDocumentFragment(),o=document.createElement("li");o.appendChild(t.cloneNode(!0)),n.appendChild(o),t.parentNode.replaceChild(n,t)}}),[])}var T=n(190),R=function(e){return document.createElement("br")};var A=[].concat(Object(a.a)(c.a),Object(a.a)(c.b),[c.h,c.d,{key:"".concat(i.b.common,"_","br","_"),revise:function(e,t,n){if(Object(M.a)(e.parentElement)&&(!e.nextSibling||Object(M.b)(e.nextSibling)))return!0}},{key:M.d.reduce((function(e,t){return e.push("".concat(i.b.common,"_").concat(t,"_").concat("")),e}),[]),revise:function(e,t,n){if(Object(M.a)(e.parentElement)){if(Object(s.a)(e,["data-id"]),Object(O.a)(e),L(e),0===e.children.length)return;return t(e.childNodes),!0}}},{key:M.c.reduce((function(e,t){return e.push("".concat(i.b.common,"_").concat(t,"_").concat("")),e}),[]),revise:function(e,t){if(Object(M.b)(e.parentElement))return Object(s.a)(e,["data-id"]),Object(O.a)(e),function(e){var t=!1;[].slice.call(e.childNodes).reduce((function(e,n){t?t.appendChild(n):Object(M.b)(n)&&(t=n)}),[])}(e),(n=e).firstChild&&!Object(M.b)(n.firstChild)||Object(T.a)(R(),n),t(e.childNodes),!0;var n}}]),B=new i.a({rules:A,usePersonalRule:!1}),P=[{key:M.d.reduce((function(e,t){return e.push("".concat(i.b.common,"_").concat(t,"_").concat("")),e}),[]),revise:function(e,t,n){return L(e),0===e.children.length?void 0:(Object(s.a)(e,["data-id"]),Object(O.a)(e),Object(l.a)(n,e),B.revise(e),!0)}}],z=n(242),H=n(223),q=[{key:"".concat(i.b.common,"_","section","_","lock"),revise:function(e,t,n){return!0}}],W=function(e){[].slice.call(e.childNodes).reduce((function(e,t){if(!function(e){return Object(p.a)(e,["p","h2","h3","ol","ul","section"].concat(["table","pre","code","div"]))}(t))if(function(e){return Object(p.a)(e,["p"])}(t.previousSibling))t.previousSibling.appendChild(t);else{var n=document.createDocumentFragment(),o=document.createElement("p");o.appendChild(t.cloneNode(!0)),n.appendChild(o),t.parentNode.replaceChild(n,t)}}),[])},F=n(136),U=n(39),Z=n(35),V=n(91),X=n(163),Y=function(e){[].slice.call(e.childNodes).forEach((function(e){Object(p.a)(e,["p"])&&function(e){var t=[];try{t=Object(m.getImageOrAlbumInlineModule)(e)}catch(n){}t.length>0&&t.forEach((function(t,n){if(0===n&&(Object(m.moduleDomIsRightInline)(t)?(e.firstChild!==t&&Object(T.a)(t,e),e.firstChild.nextSibling||Object(m.moduleDomIsRightInline)(e)&&Object(U.a)(Object(Z.a)("",V.a),e.firstChild)):e.lastChild!==t&&e.append(t)),n>0){var o=Object(Z.a)("p","".concat(t.outerHTML));Object(m.moduleDomIsRightInline)(e)&&(o=Object(Z.a)("p","".concat(t.outerHTML).concat(V.b))),Object(U.a)(o,e),t.remove()}}))}(e)}))},J=new i.a({rules:[F.b].concat(Object(a.a)(c.a),Object(a.a)(c.b),[j(),c.h,c.d,X.a],Object(a.a)(z.b),Object(a.a)(H.a),Object(a.a)(q),Object(a.a)(E),Object(a.a)(N),Object(a.a)(P)),usePersonalRule:!0}),Q=new i.a({rules:[F.b,j("right")].concat(Object(a.a)(z.c),Object(a.a)(c.a),Object(a.a)(c.b),[c.h,c.d,X.a]),usePersonalRule:!1}),K=function(e){var t;t=e,[].slice.call(t.childNodes).reduce((function(e,t){var n=["p"];if(!Object(p.a)(t,n))if(t.previousSibling&&Object(p.a)(t.previousSibling,n))t.previousSibling.appendChild(t);else{var o=document.createDocumentFragment(),a=document.createElement("p");a.appendChild(t.cloneNode(!0)),o.appendChild(a),t.parentNode.replaceChild(o,t)}}),[]),Q.revise(e),Y(e)},G=function(e){var t=u()(e.innerHTML);Object(o.b)(e)&&(/^<p data-id=".{1,}"><\/p>$/.test(t)||(e.innerHTML=Object(D.a)()))},$=function(e,t){G(e),function(e,t){W(e),t?(J.setroot(e),t.forEach((function(e){J.reviseElement(e)}))):J.revise(e),Y(e)}(e,t)},ee=function(e){G(e),K(e)}},548:function(e,t,n){"use strict";var o=n(45);t.a=function(e,t){var n=!1;if(t&&t.collapsed&&0===t.startOffset)for(var a=t.commonAncestorContainer,i=1;i;)a===e?(i=0,n=!0):Object(o.a)(e,a)?a.previousSibling?i=0:a=a.parentNode:i=0;return n}},646:function(e,t,n){"use strict";n.d(t,"b",(function(){return x})),n.d(t,"c",(function(){return O})),n.d(t,"a",(function(){return y}));var o=n(5),a=n(2),i=n(4),c=n(3),r=n(86),s=n(729),l=n(35),d=n(39),u=n(49),p=n(190),m=n(25),h=n(541),b=n(406),f=n(15),v=n(195),j=n(58),g=function(){return Object(l.a)("td",Object(r.a)(),{rowspan:1,colspan:1})},x="data-horizontalth",O="data-verticalth",y=function(){function e(){var t=this;Object(i.a)(this,e),this.context={isActive:!1,selectedZoneByUser:{top:-1,bottom:-1,left:-1,right:-1},selectedZone:{top:-1,bottom:-1,left:-1,right:-1}},this.computed={heights:[],selectedDom:[],tableWidth:"",cols:[]},this.table=null,this.cells=[],this._stateChangeEventQuee=[],this.computedColsWidth=function(){var e=t.cells.reduce((function(e,t,n){return t&&t.forEach((function(t,n){if(e[n]=e[n]||"",t.td){var o=t.td.colSpan||1,a=t.td.getBoundingClientRect().right;e[n+o-1]||(e[n+o-1]=a)}})),e}),[]),n=t.table.getBoundingClientRect().left;e.unshift(n);var o=1,a=null;return e=e.reduce((function(e,t,n){if(0===n)a=t;else if(t){for(var i=(t-a)/o,c=0;c<o;c++)e[n-1-c]=i;o=1,a=t}else o++;return e}),[])},this.setOrClearTableWidth=function(e,n){e?Object(u.a)(t.table,{width:n}):Object(u.a)(t.table,{width:""})},this.setOrClearTableColsWidth=function(e){if(e){var n=t.computedColsWidth();[].slice.call(t.table.querySelectorAll("col")).map((function(e,t){Object(u.a)(e,{width:n[t],span:1})}),[])}else[].slice.call(t.table.querySelectorAll("col")).map((function(e){Object(u.a)(e,{width:"",span:1})}),[])},this._fixTableCol=function(){var e=t.cells.reduce((function(e,t){return t.length>e?t.length:e}),0),n=[].slice.call(t.table.querySelectorAll("col")).length;n>e&&(t.table.querySelector("colgroup").innerHTML="",n=[].slice.call(t.table.querySelectorAll("col")).length);for(var o=n;o<e;o++){var a=Object(l.a)("col","",{width:""});t.table.querySelector("colgroup").appendChild(a)}[].slice.call(t.table.querySelectorAll("col")).map((function(e){var t=e.getAttribute("width")||"";t&&(t=parseInt(t,10)),Object(u.a)(e,{width:t,span:1})}),[])},this._fixTableBody=function(){var e=t.cells.reduce((function(e,t){return t.length>e?t.length:e}),0);t.cells.forEach((function(n,o){for(var a=n.length;a<e;a++)t.table.rows[o].appendChild(g())}))},this.fixTable=function(){t.table.querySelector("colgroup")||Object(p.a)(Object(l.a)("colgroup",""),t.table),t._fixTableCol(),t._fixTableBody(),[].slice.call(t.table.rows).forEach((function(e){[].slice.call(e.childNodes).forEach((function(e){if(!Object(m.a)(e,["td"]))if(Object(m.a)(e,["br"]))e.remove();else{for(var t=e.nextSibling;t&&!Object(m.a)(t,["td"]);)t=t.nextSibling;t&&t.querySelector("p")?Object(p.a)(e,t.querySelector("p")):e.remove()}}))}));var e=Object(s.b)(t);if("active"===e.thHorizontal){var n=0;t.cells[0].forEach((function(e){e.td&&e.td.rowSpan>1&&(n=1)})),n&&t.toggleThHorizontal()}if("active"===e.thVertical){var o=0;t.cells.forEach((function(e){e[0].td&&e[0].td.colSpan>1&&(o=1)})),o&&t.toggleThVertical()}},this.adaptByText=function(){t.setOrClearTableWidth(!1),t.setOrClearTableColsWidth(!1),t.triggleStateChange()},this.adaptByWindow=function(){t.setOrClearTableWidth(!1),t.setOrClearTableColsWidth(!1),t.setOrClearTableWidth(!0,"100%"),t.setOrClearTableColsWidth(!0),t.setOrClearTableWidth(!1),t.triggleStateChange()}}return Object(c.a)(e,[{key:"refresh",value:function(e){var t=this;if(this.table=e instanceof HTMLTableElement?e:null,this.table){var n=[].slice.call(this.table.rows),o=0;for(n.forEach((function(e,t){[].slice.call(e.cells).forEach((function(e){t+e.rowSpan>o&&(o=t+e.rowSpan)}))}));this.table.rows.length<o;)this.table.insertRow();n=[].slice.call(this.table.rows),this.cells=n.map((function(e){return[]})),n.forEach((function(e,n){for(var o=0,a=0;o<e.cells.length;o++){for(;t.cells[n][a];a++);for(var i=e.cells[o],c=0;c<i.colSpan;c++,a++)for(var r=0;r<i.rowSpan;r++)t.cells[n+r][a]={td:parseInt(c,10)+parseInt(r,10)===0?i:null,virtualTd:i,row:n+r,col:a}}}))}this.fixTable(),this.reset(),this.triggleStateChange()}},{key:"reset",value:function(){try{if(this.cells[this.context.selectedZone.top][this.context.selectedZone.left]&&this.cells[this.context.selectedZone.bottom][this.context.selectedZone.right])return}catch(e){}this.context=Object(a.a)(Object(a.a)({},this.context),{},{selectedZone:{top:-1,bottom:-1,left:-1,right:-1},selectedZoneByUser:{top:-1,bottom:-1,left:-1,right:-1}})}},{key:"listenStateChange",value:function(e){var t=this;return this._stateChangeEventQuee.push(e),function(){t._stateChangeEventQuee=t._stateChangeEventQuee.filter((function(t){return t!==e}))}}},{key:"triggleStateChange",value:function(){this.computedInternalAttributes(),this._stateChangeEventQuee.forEach((function(e){e()}))}},{key:"change",value:function(e){var t=Object(a.a)(Object(a.a)({},this.context),e);JSON.stringify(this.context)!==JSON.stringify(t)&&(this.context=t,this.triggleStateChange())}},{key:"computedInternalAttributes",value:function(){this.context.selectedZone=this.getBound(this.context.selectedZoneByUser.top,this.context.selectedZoneByUser.bottom,this.context.selectedZoneByUser.left,this.context.selectedZoneByUser.right),this.computed.heights=Object(s.a)(this.table),this.computed.selectedDom=this.getSelectedDom(this.context.selectedZone),this.computed.cols=this.computedColsWidth(),this.computed.tableWidth=parseInt(this.table.getBoundingClientRect().width,10)}},{key:"getBound",value:function(e,t,n,o){if(e<0)return{top:e,bottom:t,left:n,right:o};for(var a=Number.MAX_VALUE,i=-1,c=Number.MAX_VALUE,r=-1,s=Math.min(e,t);s<=Math.max(e,t);s++)for(var l=Math.min(n,o);l<=Math.max(n,o);l++){var d;if((d=this.cells[s][l]).virtualTd){var u=this.getRowColByTd(d.virtualTd),p=u.col,m=u.row;a>m&&(a=m),c>p&&(c=p),i<m+d.virtualTd.rowSpan-1&&(i=m+d.virtualTd.rowSpan-1),r<p+d.virtualTd.colSpan-1&&(r=p+d.virtualTd.colSpan-1)}}return JSON.stringify({top:e,bottom:t,left:n,right:o})!==JSON.stringify({top:a,bottom:i,left:c,right:r})?this.getBound(a,i,c,r):{top:a,bottom:i,left:c,right:r}}},{key:"getSelectedDom",value:function(e){var t=[];return e&&this.cells.map((function(n,o){n.map((function(n,a){o>=e.top&&o<=e.bottom&&a>=e.left&&a<=e.right&&n.td&&t.push(n.td)}))})),t}},{key:"getRowColByTd",value:function(e){var t=-1,n=-1;return this.cells.map((function(o,a){o.map((function(o,i){o.td===e&&(t=a,n=i)}))})),{row:t,col:n}}},{key:"getBoundingClientRect",value:function(){return this.table?this.table.getBoundingClientRect():{left:0,right:0,top:0,bottom:0}}},{key:"_getCell",value:function(e,t){return this.cells&&this.cells[e]&&this.cells[e][t]||{}}},{key:"insertBelow",value:function(e){var t=this,n=e;e=-1===n?0:e;var o=Object(l.a)("tr","",{height:30});-1===n?Object(v.a)(o,this.table.rows[0]):Object(d.a)(o,this.table.rows[e]);var a=[];this.cells[e].map((function(i,c){if(i.virtualTd){var r=t.getRowColByTd(i.virtualTd),s=r.row,l=r.col;-1===n||parseInt(i.virtualTd.rowSpan,10)+s-1===e?o.appendChild(g()):-1===a.indexOf("".concat(s,"_").concat(l))&&(a.push("".concat(s,"_").concat(l)),Object(u.a)(i.virtualTd,{rowspan:parseInt(i.virtualTd.rowSpan,10)+1}))}})),this.refresh(this.table)}},{key:"insertRight",value:function(e){var t=this,n=e;e=-1===n?0:e;var o=this.table.querySelectorAll("col").length+1;if(b.c>=o){var a=(this.table.querySelectorAll("col")[n+1]||this.table.querySelectorAll("col")[n]).width,i=Object(l.a)("col","",{width:a||""});-1===n?Object(v.a)(i,this.table.querySelectorAll("col")[0]):Object(d.a)(i,this.table.querySelectorAll("col")[e]);var c=[];this.cells.map((function(o,a){var i=t.cells[a][e];if(i.virtualTd){var r=t.getRowColByTd(i.virtualTd),s=r.row,l=r.col;-1===n?t.cells[a].splice(0,0,{td:g(),virtualTd:g(),row:a,col:e}):parseInt(i.virtualTd.colSpan,10)+l-1===e?t.cells[a].splice(e+1,0,{td:g(),virtualTd:g(),row:a,col:e}):-1===c.indexOf("".concat(s,"_").concat(l))&&(c.push("".concat(s,"_").concat(l)),Object(u.a)(i.virtualTd,{colspan:parseInt(i.virtualTd.colSpan,10)+1}))}})),this.writbackBody(),this.refresh(this.table)}else f.p.info("\u6700\u591a\u63d2\u5165".concat(b.c,"\u5217"))}},{key:"writbackBody",value:function(){var e=this;Object(h.a)();var t=Object(l.a)("tbody","");this.cells.forEach((function(n,o){var a=e.table.rows[o].cloneNode();t.appendChild(a),n.forEach((function(e){e.td&&a.appendChild(e.td)}))})),this.table.querySelector("tbody").replaceWith(t)}},{key:"deleteRow",value:function(){var e=this,t=this.context.selectedZone,n=(t.left,t.right,t.top),o=t.bottom;if(-1!==o){for(var a=function(){var t=[];e.cells[i].forEach((function(n,o){var a=n.virtualTd;if(a.rowSpan>1){if(-1===t.indexOf(a)&&(t.push(a),Object(u.a)(a,{rowspan:parseInt(a.rowSpan,10)-1}),n.td)){var i=e.getRowColByTd(n.td),c=i.col,r=i.row;e.cells[r+1][c].td=a}}else n.td=null})),e.cells.splice(i,1)},i=o;i>=n;i--)a();this.writbackBody(),this.refresh(this.table)}}},{key:"deleteColumn",value:function(){var e=this,t=this.context.selectedZone,n=t.left,o=t.right;t.top,t.bottom;if(-1!==n){for(var a=n;a<=o;a++)this.table.querySelectorAll("col")[n].remove();for(var i=function(t){var n=[];e.cells.map((function(o,a){var i=e.cells[a][t].virtualTd;if(-1===n.indexOf(i)){if(i.colSpan>1)Object(u.a)(i,{colspan:parseInt(i.colSpan,10)-1});else{var c=e.getRowColByTd(i),r=c.col,s=c.row;e.cells[s][r].td=null}n.push(i)}}))},c=o;c>=n;c--)i(c);this.writbackBody(),this.refresh(this.table)}}},{key:"merge",value:function(){var e=this.context.selectedZone,t=e.left,n=e.right,o=e.top,a=e.bottom,i=this.cells[o][t],c=n-t+1,r=a-o+1;Object(u.a)(i.td,{colspan:c,rowspan:r});for(var s="",l=o;l<=a;l++)for(var d=t;d<=n;d++){var p=this.cells[l][d].td;l!==o||d!==t?p&&(s+=p.innerHTML,p.remove()):p&&(s+=p.innerHTML)}i.td.innerHTML=s,[].slice.call(i.td.childNodes).forEach((function(e){e.previousSibling&&Object(m.a)(e.previousSibling,["p"])&&Object(j.a)(e.previousSibling.innerHTML)&&e.previousSibling.remove()})),this.refresh(this.table)}},{key:"split",value:function(){var e=this.context.selectedZone,t=e.left,n=e.right,o=e.top,a=e.bottom,i=this.cells[o][t];Object(u.a)(i.td,{colspan:1,rowspan:1});for(var c=o;c<=a;c++)for(var r=t;r<=n;r++)c===o&&r===t||(this.cells[c][r].td=g());this.writbackBody(),this.refresh(this.table)}},{key:"setAlign",value:function(e){this.computed.selectedDom.forEach((function(t){Object(u.a)(t,{align:e})}))}},{key:"insertCol",value:function(e){var t=this.context.selectedZone,n=t.left,o=t.right;e?this.insertRight(o):this.insertRight(n-1)}},{key:"insertRow",value:function(e){var t=this.context.selectedZone,n=t.top,o=t.bottom;e?this.insertBelow(o):this.insertBelow(n-1)}},{key:"toggleThHorizontal",value:function(){this.table.getAttribute(x)?this.table.removeAttribute(x):Object(u.a)(this.table,Object(o.a)({},x,1))}},{key:"toggleThVertical",value:function(){this.table.getAttribute(O)?this.table.removeAttribute(O):Object(u.a)(this.table,Object(o.a)({},O,1))}}]),e}()},664:function(e,t,n){"use strict";n.d(t,"a",(function(){return l}));var o=n(4),a=n(3),i=n(27),c=n(17),r=n(6),s=n.n(r),l=function(){function e(t){var n=this;Object(o.a)(this,e),this.moduleService=null,this.renderEle=function(e){n.isRenderingEle||(n.isRenderingEle=!0,n.editor.context.__moduleService.renderEle(e),n.isRenderingEle=!1)},this.moduleService=t}return Object(a.a)(e,[{key:"initialize",value:function(e){this.editor=e,this.moduleService.setEditor(e),this.editor.context.__moduleService=this.moduleService}},{key:"onPluginEvent",value:function(e,t){var n=this.editor.context.triggleContentChangeType;switch(e){case i.a.BeforeContentChange:[c.a.inited,c.a.setContent,c.a.paste,c.a.drop].indexOf(n)>-1&&this.render();break;case i.b.documentmousemove.pluginEventName:case i.b.click.pluginEventName:t.target.closest(".editor-module")&&this.renderEle(t.target.closest(".editor-module"));break;case i.b.selectionchange.pluginEventName:var o=s()(this.editor,"context.selectionModel.focusNode");o&&o.closest(".editor-module")&&this.renderEle(o.closest(".editor-module"))}}},{key:"render",value:function(){this.isRendering||(this.isRendering=!0,this.editor.context.__moduleService.renderModules(),this.isRendering=!1)}},{key:"dispose",value:function(){this.editor.context.__moduleService.dispose(),this.editor=null}}]),e}()},665:function(e,t,n){"use strict";n.d(t,"a",(function(){return b}));var o=n(5),a=n(4),i=n(3),c=n(242),r=n(223),s=n(45),l=(n(817),n(17)),d=n(22),u=n(162),p=n(24),m=n(49),h=n(179),b=function(){function e(t){var n=this;Object(a.a)(this,e),this.editor=null,this.gcQueue=[],this.render=null,this._addMaybeShouldGcDom=function(e){0===n.gcQueue.filter((function(t){return t===e})).length&&n.gcQueue.push(e)},this.inCurrentEditor=function(e){return Object(h.a)(e)===n.editor.context.root},this.renderModules=function(){var e=n.editor.context.root;[].slice.call(e.querySelectorAll("span.editor-module")).forEach((function(e){Object(c.a)(e)&&n.inCurrentEditor(e)&&n.renderEle(e)})),[].slice.call(e.querySelectorAll("section.editor-module")).forEach((function(e){Object(r.b)(e)&&n.inCurrentEditor(e)&&n.renderEle(e)})),n._unmountFreeComponent()},this.render=t}return Object(i.a)(e,[{key:"setEditor",value:function(e){this.editor=e}},{key:"renderEle",value:function(e){this.render(e,this.editor),this._addMaybeShouldGcDom(e)}},{key:"_unmountFreeComponent",value:function(){this.gcQueue=this.gcQueue.filter((function(e){if(Object(s.a)(e.ownerDocument.body,e))return!0;try{d.unmountComponentAtNode(e),e.remove()}catch(t){}return!1}))}},{key:"dispose",value:function(){this._unmountFreeComponent()}},{key:"change",value:function(e,t){this.editor.triggleContentChange((function(){t&&t()}),"".concat(l.a.moduleOpPrefix,"_").concat(e))}},{key:"delete",value:function(e){try{d.unmountComponentAtNode(e),e.remove()}catch(t){}}},{key:"update",value:function(e,t){var n=Object(p.a)();Object(u.a)(Object(o.a)({},n,t)),Object(m.a)(e,{"data-module-key":n}),this.renderEle(e)}}]),e}()},729:function(e,t,n){"use strict";n.d(t,"a",(function(){return c})),n.d(t,"b",(function(){return s}));var o=n(646),a=n(6),i=n.n(a);function c(e){return e?[].slice.call(e.rows).reduce((function(e,t){return e.push(t.clientHeight),e}),[]):[]}var r={merge:"disabled",thHorizontal:"disabled",thVertical:"disabled",align:null};function s(e){if(i()(document,"activeElement.tagName")){var t=document.activeElement.tagName.toLowerCase();if(["input"].indexOf(t)>-1)return r}var n="disabled",a=e.computed.selectedDom,c=null;a.length&&(c=a[0].getAttribute("align")||"left"),a.length>1?n="enable":1===a.length&&(a[0].colSpan>1||a[0].rowSpan>1)&&(n="active");var s=e.table.getAttribute(o.b),l=e.table.getAttribute(o.c);return{merge:n,thHorizontal:!!s&&1===parseInt(s,10)?"active":"enable",thVertical:!!l&&1===parseInt(l,10)?"active":"enable",align:c}}},730:function(e,t,n){"use strict";var o=n(202);n(1104),n(1105);window.CodeMirror=o,o.modeURL||(o.modeURL="//baikebcs.bdimg.com/cms/wiki-react-editor/codemirror/mode/%N/%N.js");var a={},i=function(e,t){var n=o.modes[e].dependencies;if(!n)return t();for(var a=[],i=0;i<n.length;++i)o.modes.hasOwnProperty(n[i])||a.push(n[i]);if(!a.length)return t();for(var c=function(e,t){var n=t;return function(){0===--n&&e()}}(t,a.length),r=0;r<a.length;++r)o.requireMode(a[r],c)};o.requireMode=function(e,t){if("string"!==typeof e&&(e=e.name),o.modes.hasOwnProperty(e))return i(e,t);if(a.hasOwnProperty(e))return a[e].push(t);var n=o.modeURL.replace(/%N/g,e),c=document.createElement("script");c.src=n;var r=document.getElementsByTagName("script")[0],s=a[e]=[t];o.on(c,"load",(function(){i(e,(function(){for(var e=0;e<s.length;++e)s[e]()}))})),r.parentNode.insertBefore(c,r)},o.autoLoadMode=function(e,t){o.modes.hasOwnProperty(t)||o.requireMode(t,(function(){e.setOption("mode",e.getOption("mode"))}))},t.a=o},820:function(e,t,n){"use strict";n.d(t,"a",(function(){return b}));var o=n(4),a=n(3),i=n(56),c=n.n(i),r=n(548),s=n(270),l=(n(96),n(164)),d=n(27),u=n(58),p=n(45),m=n(25),h=function(e){var t=null;return{liHtmlStr:[].slice.call(e.childNodes).reduce((function(e,n){return Object(l.b)(n)?(t=n,e):(n&&1===n.nodeType?e+=n.outerHTML:e+=n.textContent,e)}),""),listDom:t}},b=function(){function e(){var t=this;Object(o.a)(this,e),this.onKeydown=function(e){if(c()("tab",e)){var n=t.editor.context,o=n.range,a=n.selectionModel.startNode.closest("li");o.collapsed&&a&&Object(r.a)(a,t.editor.context.range)&&(e.preventDefault(),Object(s.e)(t.editor))}if(c()(["delete","backspace"],e)){var i=t.editor.context,l=i.range,d=i.selectionModel.startNode.closest("li");if(l.collapsed&&d&&Object(r.a)(d,t.editor.context.range))if(d.previousSibling){if(Object(m.a)(d.previousSibling,["li"])){Object(s.b)(d).length>0&&(Object(s.d)(t.editor,d),e.preventDefault())}}else Object(s.c)(t.editor),e.preventDefault()}if(c()(["return"],e)){var p=t.editor.context,b=p.range,f=p.selectionModel.startNode.closest("li");if(b.collapsed&&f){var v=h(f),j=v.liHtmlStr,g=v.listDom;Object(r.a)(f,t.editor.context.range)&&Object(u.a)(j)&&!g&&(e.preventDefault(),Object(s.c)(t.editor))}}},this.onKeyup=function(e){if(c()(["backspace"],e)){var n=t.editor.context,o=(n.range,n.selectionModel),a=n.root,i=o.startNode.closest("li");if(i){if(!t.inLi){t.inLi=!0;var r=i.closest(l.d);if(r){for(;r.parentNode!==a&&Object(p.a)(a,r);)r=r.parentNode.closest(l.d);try{if(r.parentNode===a&&r.tagName===r.nextSibling.tagName){for(;r.nextSibling.firstChild;)r.appendChild(r.nextSibling.firstChild);r.nextSibling.remove()}}catch(s){}}}}else t.inLi=!1}}}return Object(a.a)(e,[{key:"initialize",value:function(e){this.editor=e}},{key:"dispose",value:function(){this.editor=null}},{key:"onPluginEvent",value:function(e,t){switch(e){case d.b.keydown.pluginEventName:this.onKeydown(t);break;case d.b.keyup.pluginEventName:this.onKeyup(t)}}}]),e}()},821:function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var o=n(4),a=n(3),i=n(64),c=n(56),r=n.n(c),s=function(){function e(){Object(o.a)(this,e),this.onKeydown=function(e){r()("tab",e)&&e.preventDefault()}}return Object(a.a)(e,[{key:"initialize",value:function(e){this.editor=e,this.allEventDisposer=[],this.allEventDisposer.push(Object(i.b)(this.editor.context.root,"keydown",this.onKeydown))}},{key:"dispose",value:function(){this.allEventDisposer.forEach((function(e){Object(i.a)(e.el,e.evt,e.fn)})),this.allEventDisposer=null,this.editor=null}}]),e}()},822:function(e,t,n){"use strict";n.d(t,"a",(function(){return l}));var o=n(4),a=n(3),i=n(56),c=n.n(i),r=n(58),s=n(27),l=function(){function e(){var t=this;Object(o.a)(this,e),this.onKeydown=function(e){var n=t.editor.context,o=n.range,a=n.selectionModel,i=n.root,s=a.focusNode;c()(["delete","backspace"],e)&&o.collapsed&&Object(r.a)(s.innerHTML)&&s.parentNode===i&&!s.previousSibling&&(s.nextSibling&&s.remove(),e.preventDefault())}}return Object(a.a)(e,[{key:"initialize",value:function(e){this.editor=e}},{key:"onPluginEvent",value:function(e,t){if(e===s.b.keydown.pluginEventName)this.onKeydown(t)}},{key:"dispose",value:function(){this.editor=null}}]),e}()},823:function(e,t,n){"use strict";n.d(t,"a",(function(){return b}));var o=n(4),a=n(3),i=n(56),c=n.n(i),r=n(27),s=n(45),l=n(409),d=n(270),u=n(648);function p(e,t){var n=!1;return m(e,t,(function(e){return 3===e.nodeType||(n=!0,!1)})),!n}function m(e,t,n){e&&Object(s.a)(t,e,!1)&&(n(e),m(e.previousSibling||e.parentElement,t,n))}var h={"#":{cmd:function(e){Object(l.a)(e,1)}},"##":{cmd:function(e){Object(l.a)(e,2)}},"*":{cmd:function(e){Object(d.f)(e)}},"+":{cmd:function(e){Object(d.f)(e)}},"-":{cmd:function(e){Object(d.f)(e)}},"1.":{cmd:function(e){Object(d.g)(e)}},"```":{cmd:function(e){Object(u.a)(e)}}},b=function(){function e(){var t=this;Object(o.a)(this,e),this.onKeydown=function(e){var n=t.editor.context,o=n.range,a=n.root,i=t.editor.context.selectionModel,r=i.startNode.closest("p")||i.startNode.closest("h2")||i.startNode.closest("h3");if(c()("space",e)&&o.collapsed&&i.startNode.closest(".J-editor-for-dom-plugin")===a&&(r&&r.parentElement===a&&p(o.startContainer,r))){var s=function(e,t,n){var o=document.createRange();return o.setStart(n,0),o.setEnd(e,t),{preText:o.toString(),textRange:o}}(o.startContainer,o.startOffset,r),l=s.preText,d=s.textRange;h[l]&&(d.deleteContents(),t.editor.refreshNativeRange(),h[l].cmd(t.editor),e.preventDefault())}}}return Object(a.a)(e,[{key:"initialize",value:function(e){this.editor=e}},{key:"dispose",value:function(){this.editor=null}},{key:"onPluginEvent",value:function(e,t){if(e===r.b.keydown.pluginEventName)this.onKeydown(t)}}]),e}()},824:function(e,t,n){"use strict";n.d(t,"a",(function(){return m}));var o=n(4),a=n(3),i=n(56),c=n.n(i),r=(n(96),n(44)),s=n(58),l=n(27),d=n(25),u=n(223),p=n(242),m=function(){function e(){var t=this;Object(o.a)(this,e),this.onKeydown=function(e){var n=t.editor.context,o=n.range,a=n.root,i=n.isCollapsed;if(c()("backspace",e)&&i&&0===o.startOffset){for(var l=o.startContainer;!l.previousSibling&&l!==a;)l=l.parentNode;if(l.previousSibling){var m=l.previousSibling;m&&1===m.nodeType&&((Object(d.a)(l,["p"])&&Object(d.a)(m,["h2","h3"])||Object(u.b)(m))&&(1===l.nodeType&&Object(s.a)(l.innerHTML)&&l.remove(),e.preventDefault(),setTimeout((function(){var e=document.createRange();e.setStart(m,m.childNodes.length),e.setStart(m,m.childNodes.length),Object(r.a)(e)}),0)),Object(p.a)(m.lastChild)&&(1===l.nodeType&&Object(s.a)(l.innerHTML)&&l.remove(),e.preventDefault(),setTimeout((function(){var e=document.createRange();e.setStart(m,m.childNodes.length),e.setStart(m,m.childNodes.length),Object(r.a)(e)}),0)),Object(p.a)(m)&&(e.preventDefault(),setTimeout((function(){var e=document.createRange();e.setStart(m,m.childNodes.length),e.setStart(m,m.childNodes.length),Object(r.a)(e)}),0)))}}}}return Object(a.a)(e,[{key:"initialize",value:function(e){this.editor=e}},{key:"dispose",value:function(){this.editor=null}},{key:"onPluginEvent",value:function(e,t){if(e===l.b.keydown.pluginEventName)this.onKeydown(t)}}]),e}()},825:function(e,t,n){"use strict";n.d(t,"a",(function(){return p}));var o=n(4),a=n(3),i=n(183),c=n(76),r=n(210),s=n(45),l=n(61),d=n(51),u=n(27),p=function(){function e(){var t=this;Object(o.a)(this,e),this.onSelectionChange=function(e){if(t.editor){var n=t.editor.context.root,o=Object(r.a)(n),a=Object(l.a)();if(o&&a.collapsed&&a.startContainer!==n){var s=Object(i.a)(a.startContainer,n);s&&"element"===Object(c.a)(s)&&(t.editor.context._current1LevelEleForInsert=s)}}},this.onClick=function(e){if(t.editor){var n=t.editor.context.root;if(Object(s.a)(n,e.target)){var o=Object(i.a)(e.target,n);o&&(t.editor.context._current1LevelEleForInsert=o)}}}}return Object(a.a)(e,[{key:"initialize",value:function(e){var t=this;this.editor=e,this.editorContentChangeServiceInsDispose=d.c.listenChange((function(){t.onSelectionChange()}))}},{key:"onPluginEvent",value:function(e,t){switch(e){case u.b.selectionchange.pluginEventName:this.onSelectionChange(t);break;case u.b.documentclick.pluginEventName:this.onClick(t)}}},{key:"dispose",value:function(){this.editorContentChangeServiceInsDispose(),this.editor=null}}]),e}()},826:function(e,t,n){"use strict";n.d(t,"a",(function(){return d}));var o=n(4),a=n(3),i=n(7),c=n(8),r=n(1),s=n(730),l=n(0),d=function(e){Object(i.a)(n,e);var t=Object(c.a)(n);function n(){return Object(o.a)(this,n),t.apply(this,arguments)}return Object(a.a)(n,[{key:"componentDidMount",value:function(){var e=this;this.hydrated=!1,this.editor=Object(s.a)(this.ref),window.codemirrorEditorInstance=this.editor,this.editor.setSize(null,150),this.editor.on("change",(function(){e.hydrated&&e.props.onChange(e.editor.getValue())})),this.editor.on("change",(function(t,n){e.props.onValueChange&&e.hydrated&&e.props.onValueChange(e.editor,n,e.editor.getValue())})),this.editor.on("focus",(function(e,t){t&&t.stopPropagation()})),this.editor.on("blur",(function(e,t){t&&t.stopPropagation()})),this.editor.on("scroll",(function(e,t){t&&t.stopPropagation()})),this.editor.on("keydown",(function(e,t){t&&t.stopPropagation()})),this.editor.on("keyup",(function(e,t){t&&t.stopPropagation()})),this.editor.on("keypress",(function(e,t){t&&t.stopPropagation()})),this.editor.on("paste",(function(e,t){t&&t.stopPropagation()})),this.hydrate(this.props)}},{key:"UNSAFE_componentWillReceiveProps",value:function(e){this.hydrated=!1,this.hydrate(e)}},{key:"hydrate",value:function(e){var t=this;e.value!==this.editor.getValue()&&this.editor.setValue(e.value||""),e.options.mode!==this.editor.getOption("mode")&&s.a.autoLoadMode(this.editor,e.options.mode),Object.keys(e.options||{}).forEach((function(n){e.options[n]!==t.editor.getOption(n)&&t.editor.setOption(n,e.options[n])})),this.hydrated=!0}},{key:"render",value:function(){var e=this,t=this.props.className;return Object(l.jsx)("div",{ref:function(t){return e.ref=t},className:t})}}]),n}(r.Component)},827:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var o=n(2),a=n(4),i=n(3),c=n(64),r=function(){function e(t){Object(a.a)(this,e),this.startTd=null,this.isDraging=!1,this.allEventDisposer=[],this.tableServiceIns=t}return Object(i.a)(e,[{key:"initialize",value:function(e){var t=this;this.editor=e;var n=this.tableServiceIns;this.allEventDisposer.push(Object(c.b)(document,"dragstart",(function(e){t.isDraging=!0,n.change({isActive:!1})}))),this.allEventDisposer.push(Object(c.b)(document,"dragend",(function(e){t.isDraging=!1,t.startTd=null}))),this.allEventDisposer.push(Object(c.b)(document,"drop",(function(e){t.isDraging=!1,t.startTd=null}))),this.allEventDisposer.push(Object(c.b)(document.body,"mousedown",(function(e){if(!t.isDraging){var o=e.target.closest("td");if(o){var a=n.getRowColByTd(o),i=a.row,c=a.col;t.startTd=o,n.change({selectedZoneByUser:{top:i,bottom:i,left:c,right:c}})}}}))),this.allEventDisposer.push(Object(c.b)(document.body,"mousemove",(function(e){if(!t.isDraging){var a=e.target.closest("td");if(t.startTd&&a&&t.startTd!==a){t.startSelectMul=!0;var i=n.getRowColByTd(a),c=i.row,r=i.col;a&&n.change({selectedZoneByUser:Object(o.a)(Object(o.a)({},n.context.selectedZoneByUser),{},{right:r,bottom:c})})}}}))),this.allEventDisposer.push(Object(c.b)(document.body,"mouseup",(function(e){t.isDraging||(t.startTd=null)})))}},{key:"onPluginEvent",value:function(e){e}},{key:"dispose",value:function(){this.editor=null,this.allEventDisposer.forEach((function(e){Object(c.a)(e.el,e.evt,e.fn)}))}},{key:"setSelectedEndTd",value:function(){}}]),e}()},828:function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));var o=n(4),a=n(3),i=n(35),c=n(91),r=n(64),s=n(27),l=n(548),d=n(190),u=function(){function e(){Object(o.a)(this,e)}return Object(a.a)(e,[{key:"initialize",value:function(e){this.editor=e,this.allEventDisposer=[]}},{key:"onPluginEvent",value:function(e,t){if(e===s.b.compositionstart.pluginEventName){var n=this.editor.context,o=n.range,a=n.selectionModel,r=a.startNode.closest("td");a.startNode.previousSibling||o.collapsed&&r&&Object(l.a)(r,o)&&r.querySelector("p")&&Object(d.a)(Object(i.a)("",c.a),r.querySelector("p"))}}},{key:"dispose",value:function(){this.allEventDisposer.forEach((function(e){Object(r.a)(e.el,e.evt,e.fn)})),this.allEventDisposer=null,this.editor=null}}]),e}()},829:function(e,t,n){"use strict";n.d(t,"a",(function(){return d}));var o=n(4),a=n(3),i=n(64),c=n(56),r=n.n(c),s=n(57),l=n(44),d=function(){function e(){var t=this;Object(o.a)(this,e),this.onKeydown=function(e){if(r()("tab",e)&&Object(s.a)(t.editor.context.root||document.body,"td")[0]){var n=Object(s.a)(t.editor.context.root||document.body,"table")[0],o=Object(s.a)(t.editor.context.root||document.body,"td")[0],a=null,i=!1;if([].slice.call(n.rows).forEach((function(e){[].slice.call(e.cells).forEach((function(e){i&&!a&&e&&(a=e),e===o&&(i=!0)}))})),a)try{var c=document.createRange(),d=a.children[0];c.setStart(d,0),c.setEnd(d,0),Object(l.a)(c),e.preventDefault()}catch(u){}}}}return Object(a.a)(e,[{key:"initialize",value:function(e){this.editor=e,this.allEventDisposer=[],this.allEventDisposer.push(Object(i.b)(this.editor.context.root,"keydown",this.onKeydown))}},{key:"dispose",value:function(){this.allEventDisposer.forEach((function(e){Object(i.a)(e.el,e.evt,e.fn)})),this.allEventDisposer=null,this.editor=null}}]),e}()},957:function(e,t,n){"use strict";n.d(t,"a",(function(){return E}));var o=n(2),a=n(1),i=n.n(a),c=n(22),r=n(4),s=n(3),l=n(7),d=n(8),u=n(91),p=n(56),m=n.n(p),h=n(394),b=n(63),f=n(39),v=n(44),j=function(e,t,n){e.triggleContentChange((function(){var e=document.createTextNode(n||u.a);Object(f.a)(e,t);var o=document.createRange();o.setStart(e,n.length),o.setStart(e,n.length),Object(v.a)(o)}),"\u5728dom\u4e4b\u540e\u63d2\u5165\u6587\u672c\u7247\u6bb5")},g=function(e,t,n){e.triggleContentChange((function(){var e=document.createTextNode(n||u.a);t.parentElement.insertBefore(e,t);var o=document.createRange();o.setStart(e,n.length),o.setStart(e,n.length),Object(v.a)(o)}),"\u5728dom\u4e4b\u524d\u63d2\u5165\u6587\u672c\u7247\u6bb5")},x=(n(1103),n(64)),O=n(45),y=n(61),C=n(253),N=n(0),_=function(e){Object(l.a)(n,e);var t=Object(d.a)(n);function n(e){var o;return Object(r.a)(this,n),(o=t.call(this,e))._dealKeyEvent=function(e){var t=o.props,n=t.editor,a=t.change,i=t.dom;if(Object(O.a)(n.context.root,document.activeElement,!0)){var c=i.getAttribute("data-module-type"),r=Object(y.c)();if(r){var s=r.selectionModel.focusNode;if(Object(O.a)(i,s)){if(m()(["up","down","left","right"],e))return;if(Object(O.a)(o.rightRef.current,s,!0)){if(m()(["delete","backspace"],e))return a.delete(),e.preventDefault(),void n.refreshNativeRange();var l=o.rightRef.current.innerText.replace(u.a,"");if(m()(["return"],e)){if("inline"===c)return o.isFloatOrIsLastBlock(i)?Object(h.a)(n,l,i.parentNode):j(n,i,l),e.preventDefault(),o._clearDom(),void n.refreshNativeRange();if("block"===c)return e.preventDefault(),o._clearDom(),n.refreshNativeRange(),void Object(h.a)(n,l)}"inline"===c?o.isFloatOrIsLastBlock(i)?Object(h.a)(n,l,i.parentNode):j(n,i,l):"block"===c&&Object(h.a)(n,l),e.preventDefault(),o._clearDom(),n.refreshNativeRange()}else if(Object(O.a)(o.leftRef.current,s,!0)){var d=o.leftRef.current.innerText.replace(u.a,"");if(m()(["return"],e)&&"inline"===c){if(o.isFloatOrIsLastBlock(i)){var p=i.outerHTML;a.delete(),Object(h.c)(n,p,i.parentNode)}return void e.preventDefault()}"inline"===c?g(n,i,d):"block"===c&&Object(h.b)(n,d),e.preventDefault(),o._clearDom(),n.refreshNativeRange()}}}}},o._dealSelectionChange=function(e){var t=o.props,n=t.editor,a=(t.change,t.dom);if(Object(O.a)(n.context.root,document.activeElement,!0)){var i=a.getAttribute("data-module-type"),c=Object(y.c)();if(c){var r=c.selectionModel.focusNode;if(Object(O.a)(a,r))if(Object(O.a)(o.rightRef.current,r,!0)){var s=o.rightRef.current.innerText.replace(u.a,"");(s=Object(C.a)(s))&&("inline"===i?o.isFloatOrIsLastBlock(a)?Object(h.a)(n,s,a.parentNode):j(n,a,s):"block"===i&&Object(h.a)(n,s),e.preventDefault(),o._clearDom(),n.refreshNativeRange())}else if(Object(O.a)(o.leftRef.current,r,!0)){var l=o.leftRef.current.innerText.replace(u.a,"");(l=Object(C.a)(l))&&("inline"===i?g(n,a,l):"block"===i&&Object(h.b)(n,l),o._clearDom(),n.refreshNativeRange())}}}},o.isFloatOrIsLastBlock=function(e){return"right"===getComputedStyle(e).float||"block"===getComputedStyle(e).display&&e.parentNode.lastChild===e},o.leftRef=i.a.createRef(),o.rightRef=i.a.createRef(),o.bodyRef=i.a.createRef(),o.isMouseDown=!1,o}return Object(s.a)(n,[{key:"componentDidMount",value:function(){var e=this,t=this.props.editor;this.allEventDisposer=[],this.allEventDisposer.push(Object(x.b)(t.context.root.ownerDocument,"keydown",(function(t){e._dealKeyEvent(t)}))),this.allEventDisposer.push(Object(x.b)(document,"selectionchange",(function(t){e._dealSelectionChange(t)})))}},{key:"_clearDom",value:function(){var e=this,t=this.props,n=t.change,o=t.dom;this.leftRef.current.innerHTML=u.b,this.rightRef.current.innerHTML=u.b;var a=[].slice.call(o.childNodes);a.map((function(t){-1===[e.leftRef.current,e.rightRef.current,e.bodyRef.current].indexOf(t)&&t.remove()})),Object(b.a)(this.leftRef.current,["class"]),Object(b.a)(this.rightRef.current,["class"]),Object(b.a)(this.bodyRef.current,["class","contenteditable","contentEditable"]),3!==(a=[].slice.call(o.childNodes)).length&&n.delete()}},{key:"componentWillUnmount",value:function(){this.allEventDisposer.forEach((function(e){Object(x.a)(e.el,e.evt,e.fn)}))}},{key:"render",value:function(){var e=this.props.children;return Object(N.jsxs)(N.Fragment,{children:[Object(N.jsx)("span",{className:"module__before",ref:this.leftRef,children:u.a}),Object(N.jsx)("span",{className:"module__body",contentEditable:"false",suppressContentEditableWarning:!0,ref:this.bodyRef,children:e}),Object(N.jsx)("span",{className:"module__end",ref:this.rightRef,children:u.a})]})}}]),n}(a.Component),k=n(6),I=n.n(k),w=n(49),D=n(26),S=n(17),E=function(e){return function(t,n){if(!I()(t,"_reactRootContainer._internalRoot")||t.__id!==t.getAttribute("data-module-key")){t.__id=t.getAttribute("data-module-key");var a=null,i=null;try{i=(a=Object(D.getModuleInfo)(t)).type}catch(p){return console.error("\u89e3\u6790\u5143\u7d20\u9519\u8bef"),void t.remove()}if(!e[a.type])return console.error("".concat(a.type,":\u5f53\u524d\u7c7b\u578b\u65e0render\u65b9\u6cd5"),t),void t.remove();Object(w.a)(t,{"data-module-style":[i,I()(a,"data.type")].reduce((function(e,t){return t&&e.push(t),e}),[]).join("_")});var r=n.context.__moduleService,s={delete:function(){r.change("".concat(S.a.moduleOpModify),(function(){r.delete(t)}),t)},update:function(e,n){r.change("".concat(S.a.moduleOpModify),(function(){r.update(t,e)}),t)}},l={id:t.dataset.id,node:a,change:s,dom:t},d={node:a,editor:n,change:s,dom:t};t.change=s;var u=e[i].com;c.render(Object(N.jsx)(_,Object(o.a)(Object(o.a)({},d),{},{children:Object(N.jsx)(u,Object(o.a)({},l))})),t)}}}},958:function(e,t,n){"use strict";n.d(t,"a",(function(){return p}));var o=n(4),a=n(3),i=n(56),c=n.n(i),r=n(58),s=n(45),l=function(e,t){if(Object(r.b)(e))return!0;var n=!1;if(t&&t.collapsed&&(1===t.startContainer.nodeType&&t.endOffset===t.commonAncestorContainer.childNodes.length||3===t.startContainer.nodeType&&t.endOffset===t.startContainer.length))for(var o=1,a=t.commonAncestorContainer;o;)a===e?(o=0,n=!0):a.nextSibling&&"BR"!==a.nextSibling.nodeName.toUpperCase()?Object(s.a)(e,a)||(o=0):(o=1,a=a.parentNode);return n},d=(n(96),n(394)),u=n(27),p=function(){function e(){var t=this;Object(o.a)(this,e),this.onKeydown=function(e){var n=t.editor.context,o=n.range,a=n.selectionModel;if(c()("return",e)){var i=a.startNode.closest("h2,h3");i&&l(i,o)&&(e.preventDefault(),Object(d.a)(t.editor))}}}return Object(a.a)(e,[{key:"initialize",value:function(e){this.editor=e}},{key:"dispose",value:function(){this.editor=null}},{key:"onPluginEvent",value:function(e,t){if(e===u.b.keydown.pluginEventName)this.onKeydown(t)}}]),e}()}}]);