(this["webpackJsonpwiki-react-editor"]=this["webpackJsonpwiki-react-editor"]||[]).push([[2],{1073:function(t,e,n){},1074:function(t,e,n){var i=n(48).default;!function(){var t,e=window.jQuery,n="mathquill-command-id",r="mathquill-block-id",s=Math.min,o=Math.max;function a(){}var l=[].slice;function c(t){var e=t.length-1;return function(){var n=l.call(arguments,0,e),i=l.call(arguments,e);return t.apply(this,n.concat([i]))}}var u=c((function(t,e){return c((function(n,i){if(t in n)return n[t].apply(n,e.concat(i))}))}));function h(t){return c((function(e,n){"function"!==typeof e&&(e=u(e));return t.call(this,(function(t){return e.apply(t,[t].concat(n))}))}))}function f(t){var e=l.call(arguments,1);return function(){return t.apply(this,e)}}function p(t,e){if(!e)throw new Error("prayer failed: "+t)}var d=function(t,e,n){function r(t){return"object"===i(t)}function s(t){return"function"===typeof t}function o(){}return function n(i,a){function l(){var t=new c;return s(t.init)&&t.init.apply(t,arguments),t}function c(){}undefined===a&&(a=i,i=Object),l.Bare=c;var u,h=o[t]=i[t],f=c[t]=l[t]=l.p=new o;return f.constructor=l,l.extend=function(t){return n(l,t)},(l.open=function(t){if(u={},s(t)?u=t.call(l,f,h,l,i):r(t)&&(u=t),r(u))for(var n in u)e.call(u,n)&&(f[n]=u[n]);return s(f.init)||(f.init=i),l})(a)}}("prototype",{}.hasOwnProperty),m=-1,g=1;function v(t){p("a direction was passed",t===m||t===g)}var b=d(e,(function(t){t.insDirOf=function(t,e){return t===m?this.insertBefore(e.first()):this.insertAfter(e.last())},t.insAtDirEnd=function(t,e){return t===m?this.prependTo(e):this.appendTo(e)}})),w=d((function(t){t.parent=0,t[m]=0,t[g]=0,t.init=function(t,e,n){this.parent=t,this[m]=e,this[g]=n},this.copy=function(t){return w(t.parent,t[m],t[g])}})),x=d((function(t){t[m]=0,t[g]=0,t.parent=0;var e=0;this.byId={},t.init=function(){this.id=e+=1,x.byId[this.id]=this,this.ends={},this.ends[m]=0,this.ends[g]=0},t.dispose=function(){delete x.byId[this.id]},t.toString=function(){return"{{ MathQuill Node #"+this.id+" }}"},t.jQ=b(),t.jQadd=function(t){return this.jQ=this.jQ.add(t)},t.jQize=function(t){t=b(t||this.html());function e(t){if(t.getAttribute){var n=t.getAttribute("mathquill-command-id"),i=t.getAttribute("mathquill-block-id");n&&x.byId[n].jQadd(t),i&&x.byId[i].jQadd(t)}for(t=t.firstChild;t;t=t.nextSibling)e(t)}for(var n=0;n<t.length;n+=1)e(t[n]);return t},t.createDir=function(t,e){v(t);var n=this;return n.jQize(),n.jQ.insDirOf(t,e.jQ),e[t]=n.adopt(e.parent,e[m],e[g]),n},t.createLeftOf=function(t){return this.createDir(m,t)},t.selectChildren=function(t,e){return T(t,e)},t.bubble=h((function(t){for(var e=this;e;e=e.parent){if(!1===t(e))break}return this})),t.postOrder=h((function(t){return function e(n){n.eachChild(e),t(n)}(this),this})),t.isEmpty=function(){return 0===this.ends[m]&&0===this.ends[g]},t.children=function(){return y(this.ends[m],this.ends[g])},t.eachChild=function(){var t=this.children();return t.each.apply(t,arguments),this},t.foldChildren=function(t,e){return this.children().fold(t,e)},t.withDirAdopt=function(t,e,n,i){return y(this,this).withDirAdopt(t,e,n,i),this},t.adopt=function(t,e,n){return y(this,this).adopt(t,e,n),this},t.disown=function(){return y(this,this).disown(),this},t.remove=function(){return this.jQ.remove(),this.postOrder("dispose"),this.disown()}}));function q(t,e,n){p("a parent is always present",t),p("leftward is properly set up",e?e[g]===n&&e.parent===t:t.ends[m]===n),p("rightward is properly set up",n?n[m]===e&&n.parent===t:t.ends[g]===e)}var y=d((function(e){e.init=function(e,n,i){if(i===t&&(i=m),v(i),p("no half-empty fragments",!e===!n),this.ends={},e){p("withDir is passed to Fragment",e instanceof x),p("oppDir is passed to Fragment",n instanceof x),p("withDir and oppDir have the same parent",e.parent===n.parent),this.ends[i]=e,this.ends[-i]=n;var r=this.fold([],(function(t,e){return t.push.apply(t,e.jQ.get()),t}));this.jQ=this.jQ.add(r)}},e.jQ=b(),e.withDirAdopt=function(t,e,n,i){return t===m?this.adopt(e,n,i):this.adopt(e,i,n)},e.adopt=function(t,e,n){q(t,e,n);var i=this;i.disowned=!1;var r=i.ends[m];if(!r)return this;var s=i.ends[g];return e||(t.ends[m]=r),n?n[m]=s:t.ends[g]=s,i.ends[g][g]=n,i.each((function(n){n[m]=e,n.parent=t,e&&(e[g]=n),e=n})),i},e.disown=function(){var t=this,e=t.ends[m];if(!e||t.disowned)return t;t.disowned=!0;var n=t.ends[g],i=e.parent;return q(i,e[m],e),q(i,n,n[g]),e[m]?e[m][g]=n[g]:i.ends[m]=n[g],n[g]?n[g][m]=e[m]:i.ends[g]=e[m],t},e.remove=function(){return this.jQ.remove(),this.each("postOrder","dispose"),this.disown()},e.each=h((function(t){var e=this,n=e.ends[m];if(!n)return e;for(;n!==e.ends[g][g];n=n[g]){if(!1===t(n))break}return e})),e.fold=function(t,e){return this.each((function(n){t=e.call(this,t,n)})),t}})),O={},k={},j=d(w,(function(t){t.init=function(t,e){this.parent=t,this.options=e;var n=this.jQ=this._jQ=b('<span class="mq-cursor">&#8203;</span>');this.blink=function(){n.toggleClass("mq-blink")},this.upDownCache={}},t.show=function(){return this.jQ=this._jQ.removeClass("mq-blink"),"intervalId"in this?clearInterval(this.intervalId):(this[g]?this.selection&&this.selection.ends[m][m]===this[m]?this.jQ.insertBefore(this.selection.jQ):this.jQ.insertBefore(this[g].jQ.first()):this.jQ.appendTo(this.parent.jQ),this.parent.focus()),this.intervalId=setInterval(this.blink,500),this},t.hide=function(){return"intervalId"in this&&clearInterval(this.intervalId),delete this.intervalId,this.jQ.detach(),this.jQ=b(),this},t.withDirInsertAt=function(t,e,n,i){var r=this.parent;this.parent=e,this[t]=n,this[-t]=i,r!==e&&r.blur&&r.blur(this)},t.insDirOf=function(t,e){return v(t),this.jQ.insDirOf(t,e.jQ),this.withDirInsertAt(t,e.parent,e[t],e),this.parent.jQ.addClass("mq-hasCursor"),this},t.insLeftOf=function(t){return this.insDirOf(m,t)},t.insRightOf=function(t){return this.insDirOf(g,t)},t.insAtDirEnd=function(t,e){return v(t),this.jQ.insAtDirEnd(t,e.jQ),this.withDirInsertAt(t,e,0,e.ends[t]),e.focus(),this},t.insAtLeftEnd=function(t){return this.insAtDirEnd(m,t)},t.insAtRightEnd=function(t){return this.insAtDirEnd(g,t)},t.jumpUpDown=function(t,e){var n=this;n.upDownCache[t.id]=w.copy(n);var i=n.upDownCache[e.id];if(i)i[g]?n.insLeftOf(i[g]):n.insAtRightEnd(i.parent);else{var r=n.offset().left;e.seek(r,n)}},t.offset=function(){var t=this.jQ.removeClass("mq-cursor").offset();return this.jQ.addClass("mq-cursor"),t},t.unwrapGramp=function(){var t=this.parent.parent,e=t.parent,n=t[g],i=t[m];if(t.disown().eachChild((function(r){r.isEmpty()||(r.children().adopt(e,i,n).each((function(e){e.jQ.insertBefore(t.jQ.first())})),i=r.ends[g])})),!this[g])if(this[m])this[g]=this[m][g];else for(;!this[g];){if(this.parent=this.parent[g],!this.parent){this[g]=t[g],this.parent=e;break}this[g]=this.parent.ends[m]}this[g]?this.insLeftOf(this[g]):this.insAtRightEnd(e),t.jQ.remove(),t[m].siblingDeleted&&t[m].siblingDeleted(this.options,g),t[g].siblingDeleted&&t[g].siblingDeleted(this.options,m)},t.startSelection=function(){for(var t=this.anticursor=w.copy(this),e=t.ancestors={},n=t;n.parent;n=n.parent)e[n.parent.id]=n},t.endSelection=function(){delete this.anticursor},t.select=function(){var t=this.anticursor;if(this[m]===t[m]&&this.parent===t.parent)return!1;for(var e=this;e.parent;e=e.parent)if(e.parent.id in t.ancestors){var n=e.parent;break}p("cursor and anticursor in the same tree",n);var i,r,s=t.ancestors[n.id],o=g;if(e[m]!==s)for(var a=e;a;a=a[g])if(a[g]===s[g]){o=m,i=e,r=s;break}return o===g&&(i=s,r=e),i instanceof w&&(i=i[g]),r instanceof w&&(r=r[m]),this.hide().selection=n.selectChildren(i,r),this.insDirOf(o,this.selection.ends[o]),this.selectionChanged(),!0},t.clearSelection=function(){return this.selection&&(this.selection.clear(),delete this.selection,this.selectionChanged()),this},t.deleteSelection=function(){this.selection&&(this[m]=this.selection.ends[m][m],this[g]=this.selection.ends[g][g],this.selection.remove(),this.selectionChanged(),delete this.selection)},t.replaceSelection=function(){var t=this.selection;return t&&(this[m]=t.ends[m][m],this[g]=t.ends[g][g],delete this.selection),t}})),T=d(y,(function(t,e){t.init=function(){e.init.apply(this,arguments),this.jQ=this.jQ.wrapAll('<span class="mq-selection"></span>').parent()},t.adopt=function(){return this.jQ.replaceWith(this.jQ=this.jQ.children()),e.adopt.apply(this,arguments)},t.clear=function(){return this.jQ.replaceWith(this.jQ[0].childNodes),this},t.join=function(t){return this.fold("",(function(e,n){return e+n[t]()}))}})),Q=d((function(t){t.init=function(t,e,n){this.id=t.id,this.data={},this.root=t,this.container=e,this.options=n,t.controller=this,this.cursor=t.cursor=j(t,n)},t.handle=function(t,e){var n=this.options.handlers;if(n&&n.fns[t]){var i=n.APIClasses[this.KIND_OF_MQ](this);e===m||e===g?n.fns[t](e,i):n.fns[t](i)}};var e=[];this.onNotify=function(t){e.push(t)},t.notify=function(){for(var t=0;t<e.length;t+=1)e[t].apply(this.cursor,arguments);return this}})),C={},_=d(),D={},S=d(),E={};function L(){window.console&&console.warn('You are using the MathQuill API without specifying an interface version, which will fail in v1.0.0. Easiest fix is to do the following before doing anything else:\n\n    MathQuill = MathQuill.getInterface(1);\n    // now MathQuill.MathField() works like it used to\n\nSee also the "`dev` branch (2014\u20132015) \u2192 v0.10.0 Migration Guide" at\n  https://github.com/mathquill/mathquill/wiki/%60dev%60-branch-(2014%E2%80%932015)-%E2%86%92-v0.10.0-Migration-Guide')}function A(t){return L(),Rt(t)}A.prototype=S.p,A.interfaceVersion=function(t){if(1!==t)throw"Only interface version 1 supported. You specified: "+t;return(L=function(){window.console&&console.warn('You called MathQuill.interfaceVersion(1); to specify the interface version, which will fail in v1.0.0. You can fix this easily by doing this before doing anything else:\n\n    MathQuill = MathQuill.getInterface(1);\n    // now MathQuill.MathField() works like it used to\n\nSee also the "`dev` branch (2014\u20132015) \u2192 v0.10.0 Migration Guide" at\n  https://github.com/mathquill/mathquill/wiki/%60dev%60-branch-(2014%E2%80%932015)-%E2%86%92-v0.10.0-Migration-Guide')})(),A},A.getInterface=z;var R=z.MIN=1,I=z.MAX=2;function z(t){if(!(R<=t&&t<=I))throw"Only interface versions between "+R+" and "+I+" supported. You specified: "+t;function n(t){if(!t||!t.nodeType)return null;var e=b(t).children(".mq-root-block").attr(r),n=e&&x.byId[e].controller;return n?i[n.KIND_OF_MQ](n):null}var i={};function s(t,e){for(var n in e&&e.handlers&&(e.handlers={fns:e.handlers,APIClasses:i}),e)if(e.hasOwnProperty(n)){var r=e[n],s=D[n];t[n]=s?s(r):r}}n.L=m,n.R=g,n.config=function(t){return s(_.p,t),this},n.registerEmbed=function(t,e){if(!/^[a-z][a-z0-9]*$/i.test(t))throw"Embed name must start with letter and be only letters and digits";E[t]=e};var o=i.AbstractMathQuill=d(S,(function(t){t.init=function(t){this.__controller=t,this.__options=t.options,this.id=t.id,this.data=t.data},t.__mathquillify=function(t){var e=this.__controller,n=e.root,i=e.container;e.createTextarea();var s=i.addClass(t).contents().detach();n.jQ=b('<span class="mq-root-block"/>').attr(r,n.id).appendTo(i),this.latex(s.text()),this.revert=function(){return i.empty().unbind(".mathquill").removeClass("mq-editable-field mq-math-mode mq-text-mode").append(s)}},t.config=function(t){return s(this.__options,t),this},t.el=function(){return this.__controller.container[0]},t.text=function(){return this.__controller.exportText()},t.latex=function(t){return arguments.length>0?(this.__controller.renderLatexMath(t),this.__controller.blurred&&this.__controller.cursor.hide().parent.blur(),this):this.__controller.exportLatex()},t.html=function(){return this.__controller.root.jQ.html().replace(/ mathquill-(?:command|block)-id="?\d+"?/g,"").replace(/<span class="?mq-cursor( mq-blink)?"?>.?<\/span>/i,"").replace(/ mq-hasCursor|mq-hasCursor ?/,"").replace(/ class=(""|(?= |>))/g,"")},t.reflow=function(){return this.__controller.root.postOrder("reflow"),this}}));for(var l in n.prototype=o.prototype,i.EditableField=d(o,(function(t,n){t.__mathquillify=function(){return n.__mathquillify.apply(this,arguments),this.__controller.editable=!0,this.__controller.delegateMouseEvents(),this.__controller.editablesTextareaEvents(),this},t.focus=function(){return this.__controller.textarea.focus(),this},t.blur=function(){return this.__controller.textarea.blur(),this},t.write=function(t){return this.__controller.writeLatex(t),this.__controller.scrollHoriz(),this.__controller.blurred&&this.__controller.cursor.hide().parent.blur(),this},t.cmd=function(t){var e=this.__controller.notify(),n=e.cursor;if(/^\\[a-z]+$/i.test(t)){t=t.slice(1);var i=O[t];i&&(t=i(t),n.selection&&t.replaces(n.replaceSelection()),t.createLeftOf(n.show()),this.__controller.scrollHoriz())}else n.parent.write(n,t);return e.blurred&&n.hide().parent.blur(),this},t.select=function(){var t=this.__controller;for(t.notify("move").cursor.insAtRightEnd(t.root);t.cursor[m];)t.selectLeft();return this},t.clearSelection=function(){return this.__controller.cursor.clearSelection(),this},t.moveToDirEnd=function(t){return this.__controller.notify("move").cursor.insAtDirEnd(t,this.__controller.root),this},t.moveToLeftEnd=function(){return this.moveToDirEnd(m)},t.moveToRightEnd=function(){return this.moveToDirEnd(g)},t.keystroke=function(t){t=t.replace(/^\s+|\s+$/g,"").split(/\s+/);for(var e=0;e<t.length;e+=1)this.__controller.keystroke(t[e],{preventDefault:a});return this},t.typedText=function(t){for(var e=0;e<t.length;e+=1)this.__controller.typedText(t.charAt(e));return this},t.dropEmbedded=function(t,e,n){var i=t-b(window).scrollLeft(),r=e-b(window).scrollTop(),s=document.elementFromPoint(i,r);this.__controller.seek(b(s),t,e),At().setOptions(n).createLeftOf(this.__controller.cursor)},t.clickAt=function(t,n,i){i=i||document.elementFromPoint(t,n);var r=this.__controller,s=r.root;return e.contains(s.jQ[0],i)||(i=s.jQ[0]),r.seek(b(i),t+pageXOffset,n+pageYOffset),r.blurred&&this.focus(),this},t.ignoreNextMousedown=function(t){return this.__controller.cursor.options.ignoreNextMousedown=t,this}})),n.EditableField=function(){throw"wtf don't call me, I'm 'abstract'"},n.EditableField.prototype=i.EditableField.prototype,C)!function(e,r){var s=i[e]=r(i);n[e]=function(i,r){var o=n(i);if(o instanceof s||!i||!i.nodeType)return o;var a=Q(s.RootBlock(),b(i),_());return a.KIND_OF_MQ=e,s(a).__mathquillify(r,t)},n[e].prototype=s.prototype}(l,C[l]);return n}A.noConflict=function(){return window.MathQuill=M,A};var M=window.MathQuill;function B(t){for(var e="moveOutOf deleteOutOf selectOutOf upOutOf downOutOf".split(" "),n=0;n<e.length;n+=1)!function(e){t[e]=function(t){this.controller.handle(e,t)}}(e[n]);t.reflow=function(){this.controller.handle("reflow"),this.controller.handle("edited"),this.controller.handle("edit")}}window.MathQuill=A;var F=d((function(t,e,n){function i(t,e){throw"Parse Error: "+e+" at "+(t=t?"'"+t+"'":"EOF")}t.init=function(t){this._=t},t.parse=function(t){return this.skip(o)._(""+t,(function(t,e){return e}),i)},t.or=function(t){p("or is passed a parser",t instanceof n);var e=this;return n((function(n,i,r){return e._(n,i,(function(e){return t._(n,i,r)}))}))},t.then=function(t){var e=this;return n((function(i,r,s){return e._(i,(function(e,i){var o=t instanceof n?t:t(i);return p("a parser is returned",o instanceof n),o._(e,r,s)}),s)}))},t.many=function(){var t=this;return n((function(e,n,i){for(var r=[];t._(e,s,o););return n(e,r);function s(t,n){return e=t,r.push(n),!0}function o(){return!1}}))},t.times=function(t,e){arguments.length<2&&(e=t);var i=this;return n((function(n,r,s){for(var o,a=[],l=!0,c=0;c<t;c+=1)if(!(l=i._(n,u,h)))return s(n,o);for(;c<e&&l;c+=1)l=i._(n,u,f);return r(n,a);function u(t,e){return a.push(e),n=t,!0}function h(t,e){return o=e,n=t,!1}function f(t,e){return!1}}))},t.result=function(t){return this.then(s(t))},t.atMost=function(t){return this.times(0,t)},t.atLeast=function(t){var e=this;return e.times(t).then((function(t){return e.many().map((function(e){return t.concat(e)}))}))},t.map=function(t){return this.then((function(e){return s(t(e))}))},t.skip=function(t){return this.then((function(e){return t.result(e)}))};this.string=function(t){var e=t.length,i="expected '"+t+"'";return n((function(n,r,s){var o=n.slice(0,e);return o===t?r(n.slice(e),o):s(n,i)}))};var r=this.regex=function(t){p("regexp parser is anchored","^"===t.toString().charAt(1));var e="expected "+t;return n((function(n,i,r){var s=t.exec(n);if(s){var o=s[0];return i(n.slice(o.length),o)}return r(n,e)}))},s=n.succeed=function(t){return n((function(e,n){return n(e,t)}))},o=(n.fail=function(t){return n((function(e,n,i){return i(e,t)}))},n.letter=r(/^[a-z]/i),n.letters=r(/^[a-z]*/i),n.digit=r(/^[0-9]/),n.digits=r(/^[0-9]*/),n.whitespace=r(/^\s+/),n.optWhitespace=r(/^\s*/),n.any=n((function(t,e,n){return t?e(t.slice(1),t.charAt(0)):n(t,"expected any character")})),n.all=n((function(t,e,n){return e("",t)})),n.eof=n((function(t,e,n){return t?n(t,"expected EOF"):e(t,t)})))})),$=function(){var t={8:"Backspace",9:"Tab",10:"Enter",13:"Enter",16:"Shift",17:"Control",18:"Alt",20:"CapsLock",27:"Esc",32:"Spacebar",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"Left",38:"Up",39:"Right",40:"Down",45:"Insert",46:"Del",144:"NumLock"};return function(n,i){var r,s=null,o=null,l=e(n),c=e(i.container||l),u=a;function h(t){u=t,clearTimeout(r),r=setTimeout(t)}c.bind("keydown keypress input keyup focusout paste",(function(t){u(t)}));var f=!1;function p(){i.keystroke(function(e){var n,i=e.which||e.keyCode,r=t[i],s=[];return e.ctrlKey&&s.push("Ctrl"),e.originalEvent&&e.originalEvent.metaKey&&s.push("Meta"),e.altKey&&s.push("Alt"),e.shiftKey&&s.push("Shift"),n=r||String.fromCharCode(i),s.length||r?(s.push(n),s.join("-")):n}(s),s)}function d(){if(!function(){var t=l[0];return"selectionStart"in t&&t.selectionStart!==t.selectionEnd}()){var t=l.val();1===t.length?(l.val(""),i.typedText(t)):t&&l[0].select&&l[0].select()}}function m(){var t=l.val();l.val(""),t&&i.paste(t)}return c.bind({keydown:function(t){s=t,o=null,f&&h((function(t){t&&"focusout"===t.type||!l[0].select||l[0].select(),u=a,clearTimeout(r)})),p()},keypress:function(t){s&&o&&p(),o=t,h(d)},focusout:function(){s=o=null},paste:function(t){l.focus(),h(m)}}),{select:function(t){u(),u=a,clearTimeout(r),l.val(t),t&&l[0].select&&l[0].select(),f=!!t}}}}();Q.open((function(t,e){t.exportText=function(){return this.root.foldChildren("",(function(t,e){return t+e.text()}))}})),Q.open((function(t){t.focusBlurEvents=function(){var t,e=this,n=e.root,i=e.cursor;function r(){clearTimeout(t),i.selection&&i.selection.jQ.addClass("mq-blur"),s()}function s(){i.hide().parent.blur(),e.container.removeClass("mq-focused"),b(window).off("blur",r)}e.textarea.focus((function(){e.blurred=!1,clearTimeout(t),e.container.addClass("mq-focused"),i.parent||i.insAtRightEnd(n),i.selection?(i.selection.jQ.removeClass("mq-blur"),e.selectionChanged()):i.show()})).blur((function(){e.blurred=!0,t=setTimeout((function(){n.postOrder("intentionalBlur"),i.clearSelection().endSelection(),s()})),b(window).on("blur",r)})),e.blurred=!0,i.hide().parent.blur()}})),Q.open((function(t){t.keystroke=function(t,e){this.cursor.parent.keystroke(t,e,this)}})),x.open((function(t){t.keystroke=function(t,e,n){var i=n.cursor;switch(t){case"Ctrl-Shift-Backspace":case"Ctrl-Backspace":n.ctrlDeleteDir(m);break;case"Shift-Backspace":case"Backspace":n.backspace();break;case"Esc":case"Tab":return void n.escapeDir(g,t,e);case"Shift-Tab":case"Shift-Esc":return void n.escapeDir(m,t,e);case"End":n.notify("move").cursor.insAtRightEnd(i.parent);break;case"Ctrl-End":n.notify("move").cursor.insAtRightEnd(n.root);break;case"Shift-End":for(;i[g];)n.selectRight();break;case"Ctrl-Shift-End":for(;i[g]||i.parent!==n.root;)n.selectRight();break;case"Home":n.notify("move").cursor.insAtLeftEnd(i.parent);break;case"Ctrl-Home":n.notify("move").cursor.insAtLeftEnd(n.root);break;case"Shift-Home":for(;i[m];)n.selectLeft();break;case"Ctrl-Shift-Home":for(;i[m]||i.parent!==n.root;)n.selectLeft();break;case"Left":n.moveLeft();break;case"Shift-Left":n.selectLeft();break;case"Ctrl-Left":break;case"Right":n.moveRight();break;case"Shift-Right":n.selectRight();break;case"Ctrl-Right":break;case"Up":n.moveUp();break;case"Down":n.moveDown();break;case"Shift-Up":if(i[m])for(;i[m];)n.selectLeft();else n.selectLeft();case"Shift-Down":if(i[g])for(;i[g];)n.selectRight();else n.selectRight();case"Ctrl-Up":case"Ctrl-Down":break;case"Ctrl-Shift-Del":case"Ctrl-Del":n.ctrlDeleteDir(g);break;case"Shift-Del":case"Del":n.deleteForward();break;case"Meta-A":case"Ctrl-A":for(n.notify("move").cursor.insAtRightEnd(n.root);i[m];)n.selectLeft();break;default:return}e.preventDefault(),n.scrollHoriz()},t.moveOutOf=t.moveTowards=t.deleteOutOf=t.deleteTowards=t.unselectInto=t.selectOutOf=t.selectTowards=function(){p("overridden or never called on this node")}})),Q.open((function(t){function e(t,e){var n=t.notify("upDown").cursor,i=e+"Into",r=e+"OutOf";return n[g][i]?n.insAtLeftEnd(n[g][i]):n[m][i]?n.insAtRightEnd(n[m][i]):n.parent.bubble((function(t){var e=t[r];if(e&&("function"===typeof e&&(e=t[r](n)),e instanceof x&&n.jumpUpDown(t,e),!0!==e))return!1})),t}this.onNotify((function(t){"move"!==t&&"upDown"!==t||this.show().clearSelection()})),t.escapeDir=function(t,e,n){v(t);var i=this.cursor;if(i.parent!==this.root&&n.preventDefault(),i.parent!==this.root)return i.parent.moveOutOf(t,i),this.notify("move")},D.leftRightIntoCmdGoes=function(t){if(t&&"up"!==t&&"down"!==t)throw'"up" or "down" required for leftRightIntoCmdGoes option, got "'+t+'"';return t},t.moveDir=function(t){v(t);var e=this.cursor,n=e.options.leftRightIntoCmdGoes;return e.selection?e.insDirOf(t,e.selection.ends[t]):e[t]?e[t].moveTowards(t,e,n):e.parent.moveOutOf(t,e,n),this.notify("move")},t.moveLeft=function(){return this.moveDir(m)},t.moveRight=function(){return this.moveDir(g)},t.moveUp=function(){return e(this,"up")},t.moveDown=function(){return e(this,"down")},this.onNotify((function(t){"upDown"!==t&&(this.upDownCache={})})),this.onNotify((function(t){"edit"===t&&this.show().deleteSelection()})),t.deleteDir=function(t){v(t);var e=this.cursor,n=e.selection;return this.notify("edit"),n||(e[t]?e[t].deleteTowards(t,e):e.parent.deleteOutOf(t,e)),e[m].siblingDeleted&&e[m].siblingDeleted(e.options,g),e[g].siblingDeleted&&e[g].siblingDeleted(e.options,m),e.parent.bubble("reflow"),this},t.ctrlDeleteDir=function(t){v(t);var e=this.cursor;return!e[m]||e.selection?ctrlr.deleteDir():(this.notify("edit"),y(e.parent.ends[m],e[m]).remove(),e.insAtDirEnd(m,e.parent),e[m].siblingDeleted&&e[m].siblingDeleted(e.options,g),e[g].siblingDeleted&&e[g].siblingDeleted(e.options,m),e.parent.bubble("reflow"),this)},t.backspace=function(){return this.deleteDir(m)},t.deleteForward=function(){return this.deleteDir(g)},this.onNotify((function(t){"select"!==t&&this.endSelection()})),t.selectDir=function(t){var e=this.notify("select").cursor,n=e.selection;v(t),e.anticursor||e.startSelection();var i=e[t];i?n&&n.ends[t]===i&&e.anticursor[-t]!==i?i.unselectInto(t,e):i.selectTowards(t,e):e.parent.selectOutOf(t,e),e.clearSelection(),e.select()||e.show()},t.selectLeft=function(){return this.selectDir(m)},t.selectRight=function(){return this.selectDir(g)}}));var N=function(){function t(t){for(var e=t[0]||K(),n=1;n<t.length;n+=1)t[n].children().adopt(e,e.ends[g],0);return e}var e=F.string,n=F.regex,i=F.letter,r=F.any,s=F.optWhitespace,o=F.succeed,a=F.fail,l=i.map((function(t){return it(t)})),c=n(/^[^${}\\_^]/).map((function(t){return H(t)})),u=n(/^[^\\a-eg-zA-Z]/).or(e("\\").then(n(/^[a-z]+/i).or(n(/^\s+/).result(" ")).or(r))).then((function(t){var e=O[t];return e?e(t).parser():a("unknown command: \\"+t)})).or(l).or(c),h=e("{").then((function(){return p})).skip(e("}")),f=s.then(h.or(u.map((function(t){var e=K();return t.adopt(e,0,0),e})))),p=f.many().map(t).skip(s),d=e("[").then(f.then((function(t){return"]"!==t.join("latex")?o(t):a()})).many().map(t).skip(s)).skip(e("]")),m=p;return m.block=f,m.optBlock=d,m}();Q.open((function(t,e){t.exportLatex=function(){return this.root.latex().replace(/(\\[a-z]+) (?![a-z])/gi,"$1")},t.writeLatex=function(t){var e=this.notify("edit").cursor,n=F.all,i=F.eof,r=N.skip(i).or(n.result(!1)).parse(t);r&&!r.isEmpty()&&(r.children().adopt(e.parent,e[m],e[g]),r.jQize().insertBefore(e.jQ),e[m]=r.ends[g],r.finalizeInsert(e.options,e),r.ends[g][g].siblingCreated&&r.ends[g][g].siblingCreated(e.options,m),r.ends[m][m].siblingCreated&&r.ends[m][m].siblingCreated(e.options,g),e.parent.bubble("reflow"));return this},t.renderLatexMath=function(t){var e=this.root,n=this.cursor,i=F.all,r=F.eof,s=N.skip(r).or(i.result(!1)).parse(t);e.eachChild("postOrder","dispose"),e.ends[m]=e.ends[g]=0,s&&s.children().adopt(e,0,0);var o=e.jQ;if(s){var a=s.join("html");o.html(a),e.jQize(o.children()),e.finalizeInsert(n.options)}else o.empty();delete n.selection,n.insAtRightEnd(e)},t.renderLatexText=function(t){var e=this.root,n=this.cursor;e.jQ.children().slice(1).remove(),e.eachChild("postOrder","dispose"),e.ends[m]=e.ends[g]=0,delete n.selection,n.show().insAtRightEnd(e);var i=F.regex,r=F.string,s=F.eof,o=F.all,a=r("$").then(N).skip(r("$").or(s)).map((function(t){var e=V(n);e.createBlocks();var i=e.ends[m];return t.children().adopt(i,0,0),e})),l=r("\\$").result("$").or(i(/^[^$]/)).map(H),c=a.or(l).many().skip(s).or(o.result(!1)).parse(t);if(c){for(var u=0;u<c.length;u+=1)c[u].adopt(e,e.ends[g],0);e.jQize().appendTo(e.jQ),e.finalizeInsert(n.options)}}})),Q.open((function(e){_.p.ignoreNextMousedown=a,e.delegateMouseEvents=function(){var e=this.root.jQ;this.container.bind("mousedown.mathquill",(function(n){var i,s=b(n.target).closest(".mq-root-block"),o=x.byId[s.attr(r)||e.attr(r)].controller,l=o.cursor,c=l.blink,u=o.textareaSpan,h=o.textarea;(n.preventDefault(),n.target.unselectable=!0,l.options.ignoreNextMousedown(n))||(l.options.ignoreNextMousedown=a,o.blurred&&(o.editable||s.prepend(u),h.focus()),l.blink=a,o.seek(b(n.target),n.pageX,n.pageY).cursor.startSelection(),s.mousemove(f),b(n.target.ownerDocument).mousemove(p).mouseup((function t(e){l.blink=c,l.selection||(o.editable?l.show():u.detach()),s.unbind("mousemove",f),b(e.target.ownerDocument).unbind("mousemove",p).unbind("mouseup",t)})));function f(t){i=b(t.target)}function p(e){l.anticursor||l.startSelection(),o.seek(i,e.pageX,e.pageY).cursor.select(),i=t}}))}})),Q.open((function(t){t.seek=function(t,e,i){var s=this.notify("select").cursor;if(t){var o=t.attr(r)||t.attr(n);if(!o){var a=t.parent();o=a.attr(r)||a.attr(n)}}var l=o?x.byId[o]:this.root;return p("nodeId is the id of some Node that exists",l),s.clearSelection().show(),l.seek(e,s),this.scrollHoriz(),this}})),Q.open((function(t){t.scrollHoriz=function(){var t=this.cursor,e=t.selection,n=this.root.jQ[0].getBoundingClientRect();if(e){var i=e.jQ[0].getBoundingClientRect(),r=i.left-(n.left+20),s=i.right-(n.right-20);if(e.ends[m]===t[g])if(r<0)a=r;else{if(!(s>0))return;if(i.left-s<n.left+20)a=r;else a=s}else if(s>0)a=s;else{if(!(r<0))return;if(i.right-r>n.right-20)a=s;else a=r}}else{var o=t.jQ[0].getBoundingClientRect().left;if(o>n.right-20)var a=o-(n.right-20);else{if(!(o<n.left+20))return;var a=o-(n.left+20)}}this.root.jQ.stop().animate({scrollLeft:"+="+a},100)}})),Q.open((function(e){_.p.substituteTextarea=function(){return b("<textarea autocapitalize=off autocomplete=off autocorrect=off spellcheck=false x-palm-disable-ste-all=true />")[0]},e.createTextarea=function(){var t=this.textareaSpan=b('<span class="mq-textarea"></span>'),e=this.options.substituteTextarea();if(!e.nodeType)throw"substituteTextarea() must return a DOM element, got "+e;e=this.textarea=b(e).appendTo(t);var n=this;n.cursor.selectionChanged=function(){n.selectionChanged()},n.container.bind("copy",(function(){n.setTextareaSelection()}))},e.selectionChanged=function(){var e=this;bt(e.container[0]),e.textareaSelectionTimeout===t&&(e.textareaSelectionTimeout=setTimeout((function(){e.setTextareaSelection()})))},e.setTextareaSelection=function(){this.textareaSelectionTimeout=t;var e="";this.cursor.selection&&(e=this.cursor.selection.join("latex"),this.options.statelessClipboard&&(e="$"+e+"$")),this.selectFn(e)},e.staticMathTextareaEvents=function(){var t=this,e=(t.root,t.cursor),n=t.textarea,i=t.textareaSpan;function r(){i.detach(),t.blurred=!0}this.container.prepend('<span class="mq-selectable">$'+t.exportLatex()+"$</span>"),t.blurred=!0,n.bind("cut paste",!1).focus((function(){t.blurred=!1})).blur((function(){e.selection&&e.selection.clear(),setTimeout(r)})),t.selectFn=function(t){n.val(t),t&&n.select()}},e.editablesTextareaEvents=function(){var t=this,e=(t.root,t.cursor),n=t.textarea,i=t.textareaSpan,r=$(n,this);this.selectFn=function(t){r.select(t)},this.container.prepend(i).on("cut",(function(n){e.selection&&setTimeout((function(){t.notify("edit"),e.parent.bubble("reflow")}))})),this.focusBlurEvents()},e.typedText=function(t){if("\n"===t)return this.handle("enter");var e=this.notify().cursor;e.parent.write(e,t),this.scrollHoriz()},e.paste=function(t){this.options.statelessClipboard&&(t="$"===t.slice(0,1)&&"$"===t.slice(-1)?t.slice(1,-1):"\\text{"+t+"}"),this.writeLatex(t).cursor.show()}}));var P=d(x,(function(t,e){t.finalizeInsert=function(t,e){var n=this;n.postOrder("finalizeTree",t),n.postOrder("contactWeld",e),n.postOrder("blur"),n.postOrder("reflow"),n[g].siblingCreated&&n[g].siblingCreated(t,m),n[m].siblingCreated&&n[m].siblingCreated(t,g),n.bubble("reflow")}})),W=d(P,(function(t,e){t.init=function(t,n,i){var r=this;e.init.call(r),r.ctrlSeq||(r.ctrlSeq=t),n&&(r.htmlTemplate=n),i&&(r.textTemplate=i)},t.replaces=function(t){t.disown(),this.replacedFragment=t},t.isEmpty=function(){return this.foldChildren(!0,(function(t,e){return t&&e.isEmpty()}))},t.parser=function(){var t=N.block,e=this;return t.times(e.numBlocks()).map((function(t){e.blocks=t;for(var n=0;n<t.length;n+=1)t[n].adopt(e,e.ends[g],0);return e}))},t.createLeftOf=function(t){var n=this,i=n.replacedFragment;n.createBlocks(),e.createLeftOf.call(n,t),i&&(i.adopt(n.ends[m],0,0),i.jQ.appendTo(n.ends[m].jQ)),n.finalizeInsert(t.options),n.placeCursor(t)},t.createBlocks=function(){for(var t=this,e=t.numBlocks(),n=t.blocks=Array(e),i=0;i<e;i+=1){(n[i]=K()).adopt(t,t.ends[g],0)}},t.placeCursor=function(t){t.insAtRightEnd(this.foldChildren(this.ends[m],(function(t,e){return t.isEmpty()?t:e})))},t.moveTowards=function(t,e,n){var i=n&&this[n+"Into"];e.insAtDirEnd(-t,i||this.ends[-t])},t.deleteTowards=function(t,e){this.isEmpty()?e[t]=this.remove()[t]:this.moveTowards(t,e,null)},t.selectTowards=function(t,e){e[-t]=this,e[t]=this[t]},t.selectChildren=function(){return T(this,this)},t.unselectInto=function(t,e){e.insAtDirEnd(-t,e.anticursor.ancestors[this.id])},t.seek=function(t,e){function n(t){var e={};return e[m]=t.jQ.offset().left,e[g]=e[m]+t.jQ.outerWidth(),e}var i=this,r=n(i);if(t<r[m])return e.insLeftOf(i);if(t>r[g])return e.insRightOf(i);var s=r[m];i.eachChild((function(o){var a=n(o);return t<a[m]?(t-s<a[m]-t?o[m]?e.insAtRightEnd(o[m]):e.insLeftOf(i):e.insAtLeftEnd(o),!1):t>a[g]?void(o[g]?s=a[g]:r[g]-t<t-a[g]?e.insRightOf(i):e.insAtRightEnd(o)):(o.seek(t,e),!1)}))},t.numBlocks=function(){var t=this.htmlTemplate.match(/&\d+/g);return t?t.length:0},t.html=function(){var t=this,e=t.blocks,n=" mathquill-command-id="+t.id,i=t.htmlTemplate.match(/<[^<>]+>|[^<>]+/g);p("no unmatched angle brackets",i.join("")===this.htmlTemplate);for(var r=0,s=i[0];s;s=i[r+=1])if("/>"===s.slice(-2))i[r]=s.slice(0,-2)+n+"/>";else if("<"===s.charAt(0)){p("not an unmatched top-level close tag","/"!==s.charAt(1)),i[r]=s.slice(0,-1)+n+">";var o=1;do{p("no missing close tags",s=i[r+=1]),"</"===s.slice(0,2)?o-=1:"<"===s.charAt(0)&&"/>"!==s.slice(-2)&&(o+=1)}while(o>0)}return i.join("").replace(/>&(\d+)/g,(function(t,n){return" mathquill-block-id="+e[n].id+">"+e[n].join("html")}))},t.latex=function(){return this.foldChildren(this.ctrlSeq,(function(t,e){return t+"{"+(e.latex()||" ")+"}"}))},t.textTemplate=[""],t.text=function(){var t=this,e=0;return t.foldChildren(t.textTemplate[e],(function(n,i){e+=1;var r=i.text();return n&&"("===t.textTemplate[e]&&"("===r[0]&&")"===r.slice(-1)?n+r.slice(1,-1)+t.textTemplate[e]:n+i.text()+(t.textTemplate[e]||"")}))}})),U=d(W,(function(t,e){t.init=function(t,n,i){i||(i=t&&t.length>1?t.slice(1):t),e.init.call(this,t,n,[i])},t.parser=function(){return F.succeed(this)},t.numBlocks=function(){return 0},t.replaces=function(t){t.remove()},t.createBlocks=a,t.moveTowards=function(t,e){e.jQ.insDirOf(t,this.jQ),e[-t]=this,e[t]=this[t]},t.deleteTowards=function(t,e){e[t]=this.remove()[t]},t.seek=function(t,e){t-this.jQ.offset().left<this.jQ.outerWidth()/2?e.insLeftOf(this):e.insRightOf(this)},t.latex=function(){return this.ctrlSeq},t.text=function(){return this.textTemplate},t.placeCursor=a,t.isEmpty=function(){return!0}})),H=d(U,(function(t,e){t.init=function(t,n){e.init.call(this,t,"<span>"+(n||t)+"</span>")}})),G=d(U,(function(t,e){t.init=function(t,n,i){e.init.call(this,t,'<span class="mq-binary-operator">'+n+"</span>",i)}})),K=d(P,(function(t,e){t.join=function(t){return this.foldChildren("",(function(e,n){return e+n[t]()}))},t.html=function(){return this.join("html")},t.latex=function(){return this.join("latex")},t.text=function(){return this.ends[m]===this.ends[g]&&0!==this.ends[m]?this.ends[m].text():this.join("text")},t.keystroke=function(t,n,i){return!i.options.spaceBehavesLikeTab||"Spacebar"!==t&&"Shift-Spacebar"!==t?e.keystroke.apply(this,arguments):(n.preventDefault(),void i.escapeDir("Shift-Spacebar"===t?m:g,t,n))},t.moveOutOf=function(t,e,n){!(n&&this.parent[n+"Into"])&&this[t]?e.insAtDirEnd(-t,this[t]):e.insDirOf(t,this.parent)},t.selectOutOf=function(t,e){e.insDirOf(t,this.parent)},t.deleteOutOf=function(t,e){e.unwrapGramp()},t.seek=function(t,e){var n=this.ends[g];if(!n||n.jQ.offset().left+n.jQ.outerWidth()<t)return e.insAtRightEnd(this);if(t<this.ends[m].jQ.offset().left)return e.insAtLeftEnd(this);for(;t<n.jQ.offset().left;)n=n[m];return n.seek(t,e)},t.chToCmd=function(t){var e;return t.match(/^[a-eg-zA-Z]$/)?it(t):/^\d$/.test(t)?et(t):(e=k[t]||O[t])?e(t):H(t)},t.write=function(t,e){var n=this.chToCmd(e);t.selection&&n.replaces(t.replaceSelection()),n.createLeftOf(t.show())},t.focus=function(){return this.jQ.addClass("mq-hasCursor"),this.jQ.removeClass("mq-empty"),this},t.blur=function(){return this.jQ.removeClass("mq-hasCursor"),this.isEmpty()&&this.jQ.addClass("mq-empty"),this}}));C.StaticMath=function(t){return d(t.AbstractMathQuill,(function(e,n){this.RootBlock=K,e.__mathquillify=function(){return n.__mathquillify.call(this,"mq-math-mode"),this.__controller.delegateMouseEvents(),this.__controller.staticMathTextareaEvents(),this},e.init=function(){n.init.apply(this,arguments),this.__controller.root.postOrder("registerInnerField",this.innerFields=[],t.MathField)},e.latex=function(){var e=n.latex.apply(this,arguments);return arguments.length>0&&this.__controller.root.postOrder("registerInnerField",this.innerFields=[],t.MathField),e}}))};var Y=d(K,B);C.MathField=function(t){return d(t.EditableField,(function(t,e){this.RootBlock=Y,t.__mathquillify=function(t,n){return this.config(t),n>1&&(this.__controller.root.reflow=a),e.__mathquillify.call(this,"mq-editable-field mq-math-mode"),delete this.__controller.root.reflow,this}}))};var X=d(x,(function(t,e){function n(t){t.jQ[0].normalize();var e=t.jQ[0].firstChild;if(e){p("only node in TextBlock span is Text node",3===e.nodeType);var n=Z(e.data);return n.jQadd(e),t.children().disown(),n.adopt(t,0,0)}}t.ctrlSeq="\\text",t.replaces=function(t){t instanceof y?this.replacedText=t.remove().jQ.text():"string"===typeof t&&(this.replacedText=t)},t.jQadd=function(t){e.jQadd.call(this,t),this.ends[m]&&this.ends[m].jQadd(this.jQ[0].firstChild)},t.createLeftOf=function(t){var n=this;if(e.createLeftOf.call(this,t),n[g].siblingCreated&&n[g].siblingCreated(t.options,m),n[m].siblingCreated&&n[m].siblingCreated(t.options,g),n.bubble("reflow"),t.insAtRightEnd(n),n.replacedText)for(var i=0;i<n.replacedText.length;i+=1)n.write(t,n.replacedText.charAt(i))},t.parser=function(){var t=this,e=F.string,n=F.regex;return F.optWhitespace.then(e("{")).then(n(/^[^}]*/)).skip(e("}")).map((function(e){return 0===e.length?y():(Z(e).adopt(t,0,0),t)}))},t.textContents=function(){return this.foldChildren("",(function(t,e){return t+e.text}))},t.text=function(){return'"'+this.textContents()+'"'},t.latex=function(){var t=this.textContents();return 0===t.length?"":"\\text{"+t+"}"},t.html=function(){return'<span class="mq-text-mode" mathquill-command-id='+this.id+">"+this.textContents()+"</span>"},t.moveTowards=function(t,e){e.insAtDirEnd(-t,this)},t.moveOutOf=function(t,e){e.insDirOf(t,this)},t.unselectInto=t.moveTowards,t.selectTowards=W.prototype.selectTowards,t.deleteTowards=W.prototype.deleteTowards,t.selectOutOf=function(t,e){e.insDirOf(t,this)},t.deleteOutOf=function(t,e){this.isEmpty()&&e.insRightOf(this)},t.write=function(t,n){if(t.show().deleteSelection(),"$"!==n)t[m]?t[m].appendText(n):Z(n).createLeftOf(t);else if(this.isEmpty())t.insRightOf(this),H("\\$","$").createLeftOf(t);else if(t[g])if(t[m]){var i=X(),r=this.ends[m];r.disown().jQ.detach(),r.adopt(i,0,0),t.insLeftOf(this),e.createLeftOf.call(i,t)}else t.insLeftOf(this);else t.insRightOf(this)},t.seek=function(t,e){e.hide();var i=n(this),r=this.jQ.width()/this.text.length,s=Math.round((t-this.jQ.offset().left)/r);s<=0?e.insAtLeftEnd(this):s>=i.text.length?e.insAtRightEnd(this):e.insLeftOf(i.splitRight(s));for(var o=t-e.show().offset().left,a=o&&o<0?m:g,l=a;e[a]&&o*l>0;)e[a].moveTowards(a,e),l=o,o=t-e.offset().left;if(a*o<-a*l&&e[-a].moveTowards(-a,e),e.anticursor){if(e.anticursor.parent===this){var c=e[m]&&e[m].text.length;if(this.anticursorPosition===c)e.anticursor=w.copy(e);else{if(this.anticursorPosition<c){var u=e[m].splitRight(this.anticursorPosition);e[m]=u}else u=e[g].splitRight(this.anticursorPosition-c);e.anticursor=w(this,u[m],u)}}}else this.anticursorPosition=e[m]&&e[m].text.length},t.blur=function(t){K.prototype.blur.call(this),t&&(""===this.textContents()?(this.remove(),t[m]===this?t[m]=this[m]:t[g]===this&&(t[g]=this[g])):n(this))},t.focus=K.prototype.focus})),Z=d(x,(function(t,e){function n(t,e){return e.charAt(t===m?0:-1+e.length)}t.init=function(t){e.init.call(this),this.text=t},t.jQadd=function(t){this.dom=t,this.jQ=b(t)},t.jQize=function(){return this.jQadd(document.createTextNode(this.text))},t.appendText=function(t){this.text+=t,this.dom.appendData(t)},t.prependText=function(t){this.text=t+this.text,this.dom.insertData(0,t)},t.insTextAtDirEnd=function(t,e){v(e),e===g?this.appendText(t):this.prependText(t)},t.splitRight=function(t){var e=Z(this.text.slice(t)).adopt(this.parent,this,this[g]);return e.jQadd(this.dom.splitText(t)),this.text=this.text.slice(0,t),e},t.moveTowards=function(t,e){v(t);var i=n(-t,this.text),r=this[-t];return r?r.insTextAtDirEnd(i,t):Z(i).createDir(-t,e),this.deleteTowards(t,e)},t.latex=function(){return this.text},t.deleteTowards=function(t,e){this.text.length>1?t===g?(this.dom.deleteData(0,1),this.text=this.text.slice(1)):(this.dom.deleteData(-1+this.text.length,1),this.text=this.text.slice(0,-1)):(this.remove(),this.jQ.remove(),e[t]=this[t])},t.selectTowards=function(t,e){v(t);var i=e.anticursor,r=n(-t,this.text);if(i[t]===this){var s=Z(r).createDir(t,e);i[t]=s,e.insDirOf(t,s)}else{var o=this[-t];if(o)o.insTextAtDirEnd(r,t);else(s=Z(r).createDir(-t,e)).jQ.insDirOf(-t,e.selection.jQ);1===this.text.length&&i[-t]===this&&(i[-t]=this[-t])}return this.deleteTowards(t,e)}}));function J(t,e,n){return d(X,{ctrlSeq:t,htmlTemplate:"<"+e+" "+n+">&0</"+e+">"})}k.$=O.text=O.textnormal=O.textrm=O.textup=O.textmd=X,O.em=O.italic=O.italics=O.emph=O.textit=O.textsl=J("\\textit","i",'class="mq-text-mode"'),O.strong=O.bold=O.textbf=J("\\textbf","b",'class="mq-text-mode"'),O.sf=O.textsf=J("\\textsf","span",'class="mq-sans-serif mq-text-mode"'),O.tt=O.texttt=J("\\texttt","span",'class="mq-monospace mq-text-mode"'),O.textsc=J("\\textsc","span",'style="font-variant:small-caps" class="mq-text-mode"'),O.uppercase=J("\\uppercase","span",'style="text-transform:uppercase" class="mq-text-mode"'),O.lowercase=J("\\lowercase","span",'style="text-transform:lowercase" class="mq-text-mode"');var V=d(W,(function(t,e){t.init=function(t){e.init.call(this,"$"),this.cursor=t},t.htmlTemplate='<span class="mq-math-mode">&0</span>',t.createBlocks=function(){e.createBlocks.call(this),this.ends[m].cursor=this.cursor,this.ends[m].write=function(t,e){"$"!==e?K.prototype.write.call(this,t,e):this.isEmpty()?(t.insRightOf(this.parent),this.parent.deleteTowards(dir,t),H("\\$","$").createLeftOf(t.show())):t[g]?t[m]?K.prototype.write.call(this,t,e):t.insLeftOf(this.parent):t.insRightOf(this.parent)}},t.latex=function(){return"$"+this.ends[m].latex()+"$"}})),tt=d(Y,(function(t,e){t.keystroke=function(t){if("Spacebar"!==t&&"Shift-Spacebar"!==t)return e.keystroke.apply(this,arguments)},t.write=function(t,e){var n;(t.show().deleteSelection(),"$"===e)?V(t).createLeftOf(t):("<"===e?n="&lt;":">"===e&&(n="&gt;"),H(e,n).createLeftOf(t))}}));C.TextField=function(t){return d(t.EditableField,(function(t,e){this.RootBlock=tt,t.__mathquillify=function(){return e.__mathquillify.call(this,"mq-editable-field mq-text-mode")},t.latex=function(t){return arguments.length>0?(this.__controller.renderLatexText(t),this.__controller.blurred&&this.__controller.cursor.hide().parent.blur(),this):this.__controller.exportLatex()}}))},O.notin=O.cong=O.equiv=O.oplus=O.otimes=d(G,(function(t,e){t.init=function(t){e.init.call(this,"\\"+t+" ","&"+t+";")}})),O["\u2260"]=O.ne=O.neq=f(G,"\\ne ","&ne;"),O.ast=O.star=O.loast=O.lowast=f(G,"\\ast ","&lowast;"),O.therefor=O.therefore=f(G,"\\therefore ","&there4;"),O.cuz=O.because=f(G,"\\because ","&#8757;"),O.prop=O.propto=f(G,"\\propto ","&prop;"),O["\u2248"]=O.asymp=O.approx=f(G,"\\approx ","&asymp;"),O.isin=O.in=f(G,"\\in ","&isin;"),O.ni=O.contains=f(G,"\\ni ","&ni;"),O.notni=O.niton=O.notcontains=O.doesnotcontain=f(G,"\\not\\ni ","&#8716;"),O.sub=O.subset=f(G,"\\subset ","&sub;"),O.sup=O.supset=O.superset=f(G,"\\supset ","&sup;"),O.nsub=O.notsub=O.nsubset=O.notsubset=f(G,"\\not\\subset ","&#8836;"),O.nsup=O.notsup=O.nsupset=O.notsupset=O.nsuperset=O.notsuperset=f(G,"\\not\\supset ","&#8837;"),O.sube=O.subeq=O.subsete=O.subseteq=f(G,"\\subseteq ","&sube;"),O.supe=O.supeq=O.supsete=O.supseteq=O.supersete=O.superseteq=f(G,"\\supseteq ","&supe;"),O.nsube=O.nsubeq=O.notsube=O.notsubeq=O.nsubsete=O.nsubseteq=O.notsubsete=O.notsubseteq=f(G,"\\not\\subseteq ","&#8840;"),O.nsupe=O.nsupeq=O.notsupe=O.notsupeq=O.nsupsete=O.nsupseteq=O.notsupsete=O.notsupseteq=O.nsupersete=O.nsuperseteq=O.notsupersete=O.notsuperseteq=f(G,"\\not\\supseteq ","&#8841;"),O.N=O.naturals=O.Naturals=f(H,"\\mathbb{N}","&#8469;"),O.P=O.primes=O.Primes=O.projective=O.Projective=O.probability=O.Probability=f(H,"\\mathbb{P}","&#8473;"),O.Z=O.integers=O.Integers=f(H,"\\mathbb{Z}","&#8484;"),O.Q=O.rationals=O.Rationals=f(H,"\\mathbb{Q}","&#8474;"),O.R=O.reals=O.Reals=f(H,"\\mathbb{R}","&#8477;"),O.C=O.complex=O.Complex=O.complexes=O.Complexes=O.complexplane=O.Complexplane=O.ComplexPlane=f(H,"\\mathbb{C}","&#8450;"),O.H=O.Hamiltonian=O.quaternions=O.Quaternions=f(H,"\\mathbb{H}","&#8461;"),O.quad=O.emsp=f(H,"\\quad ","    "),O.qquad=f(H,"\\qquad ","        "),O.diamond=f(H,"\\diamond ","&#9671;"),O.bigtriangleup=f(H,"\\bigtriangleup ","&#9651;"),O.ominus=f(H,"\\ominus ","&#8854;"),O.uplus=f(H,"\\uplus ","&#8846;"),O.bigtriangledown=f(H,"\\bigtriangledown ","&#9661;"),O.sqcap=f(H,"\\sqcap ","&#8851;"),O.triangleleft=f(H,"\\triangleleft ","&#8882;"),O.sqcup=f(H,"\\sqcup ","&#8852;"),O.triangleright=f(H,"\\triangleright ","&#8883;"),O.odot=O.circledot=f(H,"\\odot ","&#8857;"),O.bigcirc=f(H,"\\bigcirc ","&#9711;"),O.dagger=f(H,"\\dagger ","&#0134;"),O.ddagger=f(H,"\\ddagger ","&#135;"),O.wr=f(H,"\\wr ","&#8768;"),O.amalg=f(H,"\\amalg ","&#8720;"),O.models=f(H,"\\models ","&#8872;"),O.prec=f(H,"\\prec ","&#8826;"),O.succ=f(H,"\\succ ","&#8827;"),O.preceq=f(H,"\\preceq ","&#8828;"),O.succeq=f(H,"\\succeq ","&#8829;"),O.simeq=f(H,"\\simeq ","&#8771;"),O.mid=f(H,"\\mid ","&#8739;"),O.ll=f(H,"\\ll ","&#8810;"),O.gg=f(H,"\\gg ","&#8811;"),O.parallel=f(H,"\\parallel ","&#8741;"),O.nparallel=f(H,"\\nparallel ","&#8742;"),O.bowtie=f(H,"\\bowtie ","&#8904;"),O.sqsubset=f(H,"\\sqsubset ","&#8847;"),O.sqsupset=f(H,"\\sqsupset ","&#8848;"),O.smile=f(H,"\\smile ","&#8995;"),O.sqsubseteq=f(H,"\\sqsubseteq ","&#8849;"),O.sqsupseteq=f(H,"\\sqsupseteq ","&#8850;"),O.doteq=f(H,"\\doteq ","&#8784;"),O.frown=f(H,"\\frown ","&#8994;"),O.vdash=f(H,"\\vdash ","&#8870;"),O.dashv=f(H,"\\dashv ","&#8867;"),O.nless=f(H,"\\nless ","&#8814;"),O.ngtr=f(H,"\\ngtr ","&#8815;"),O.longleftarrow=f(H,"\\longleftarrow ","&#8592;"),O.longrightarrow=f(H,"\\longrightarrow ","&#8594;"),O.Longleftarrow=f(H,"\\Longleftarrow ","&#8656;"),O.Longrightarrow=f(H,"\\Longrightarrow ","&#8658;"),O.longleftrightarrow=f(H,"\\longleftrightarrow ","&#8596;"),O.updownarrow=f(H,"\\updownarrow ","&#8597;"),O.Longleftrightarrow=f(H,"\\Longleftrightarrow ","&#8660;"),O.Updownarrow=f(H,"\\Updownarrow ","&#8661;"),O.mapsto=f(H,"\\mapsto ","&#8614;"),O.nearrow=f(H,"\\nearrow ","&#8599;"),O.hookleftarrow=f(H,"\\hookleftarrow ","&#8617;"),O.hookrightarrow=f(H,"\\hookrightarrow ","&#8618;"),O.searrow=f(H,"\\searrow ","&#8600;"),O.leftharpoonup=f(H,"\\leftharpoonup ","&#8636;"),O.rightharpoonup=f(H,"\\rightharpoonup ","&#8640;"),O.swarrow=f(H,"\\swarrow ","&#8601;"),O.leftharpoondown=f(H,"\\leftharpoondown ","&#8637;"),O.rightharpoondown=f(H,"\\rightharpoondown ","&#8641;"),O.nwarrow=f(H,"\\nwarrow ","&#8598;"),O.ldots=f(H,"\\ldots ","&#8230;"),O.cdots=f(H,"\\cdots ","&#8943;"),O.vdots=f(H,"\\vdots ","&#8942;"),O.ddots=f(H,"\\ddots ","&#8945;"),O.surd=f(H,"\\surd ","&#8730;"),O.triangle=f(H,"\\triangle ","&#9651;"),O.ell=f(H,"\\ell ","&#8467;"),O.top=f(H,"\\top ","&#8868;"),O.flat=f(H,"\\flat ","&#9837;"),O.natural=f(H,"\\natural ","&#9838;"),O.sharp=f(H,"\\sharp ","&#9839;"),O.wp=f(H,"\\wp ","&#8472;"),O.bot=f(H,"\\bot ","&#8869;"),O.clubsuit=f(H,"\\clubsuit ","&#9827;"),O.diamondsuit=f(H,"\\diamondsuit ","&#9826;"),O.heartsuit=f(H,"\\heartsuit ","&#9825;"),O.spadesuit=f(H,"\\spadesuit ","&#9824;"),O.parallelogram=f(H,"\\parallelogram ","&#9649;"),O.square=f(H,"\\square ","&#11036;"),O.oint=f(H,"\\oint ","&#8750;"),O.bigcap=f(H,"\\bigcap ","&#8745;"),O.bigcup=f(H,"\\bigcup ","&#8746;"),O.bigsqcup=f(H,"\\bigsqcup ","&#8852;"),O.bigvee=f(H,"\\bigvee ","&#8744;"),O.bigwedge=f(H,"\\bigwedge ","&#8743;"),O.bigodot=f(H,"\\bigodot ","&#8857;"),O.bigotimes=f(H,"\\bigotimes ","&#8855;"),O.bigoplus=f(H,"\\bigoplus ","&#8853;"),O.biguplus=f(H,"\\biguplus ","&#8846;"),O.lfloor=f(H,"\\lfloor ","&#8970;"),O.rfloor=f(H,"\\rfloor ","&#8971;"),O.lceil=f(H,"\\lceil ","&#8968;"),O.rceil=f(H,"\\rceil ","&#8969;"),O.opencurlybrace=O.lbrace=f(H,"\\lbrace ","{"),O.closecurlybrace=O.rbrace=f(H,"\\rbrace ","}"),O.lbrack=f(H,"["),O.rbrack=f(H,"]"),O.slash=f(H,"/"),O.vert=f(H,"|"),O.perp=O.perpendicular=f(H,"\\perp ","&perp;"),O.nabla=O.del=f(H,"\\nabla ","&nabla;"),O.hbar=f(H,"\\hbar ","&#8463;"),O.AA=O.Angstrom=O.angstrom=f(H,"\\text\\AA ","&#8491;"),O.ring=O.circ=O.circle=f(H,"\\circ ","&#8728;"),O.bull=O.bullet=f(H,"\\bullet ","&bull;"),O.setminus=O.smallsetminus=f(H,"\\setminus ","&#8726;"),O.not=O["\xac"]=O.neg=f(H,"\\neg ","&not;"),O["\u2026"]=O.dots=O.ellip=O.hellip=O.ellipsis=O.hellipsis=f(H,"\\dots ","&hellip;"),O.converges=O.darr=O.dnarr=O.dnarrow=O.downarrow=f(H,"\\downarrow ","&darr;"),O.dArr=O.dnArr=O.dnArrow=O.Downarrow=f(H,"\\Downarrow ","&dArr;"),O.diverges=O.uarr=O.uparrow=f(H,"\\uparrow ","&uarr;"),O.uArr=O.Uparrow=f(H,"\\Uparrow ","&uArr;"),O.to=f(G,"\\to ","&rarr;"),O.rarr=O.rightarrow=f(H,"\\rightarrow ","&rarr;"),O.implies=f(G,"\\Rightarrow ","&rArr;"),O.rArr=O.Rightarrow=f(H,"\\Rightarrow ","&rArr;"),O.gets=f(G,"\\gets ","&larr;"),O.larr=O.leftarrow=f(H,"\\leftarrow ","&larr;"),O.impliedby=f(G,"\\Leftarrow ","&lArr;"),O.lArr=O.Leftarrow=f(H,"\\Leftarrow ","&lArr;"),O.harr=O.lrarr=O.leftrightarrow=f(H,"\\leftrightarrow ","&harr;"),O.iff=f(G,"\\Leftrightarrow ","&hArr;"),O.hArr=O.lrArr=O.Leftrightarrow=f(H,"\\Leftrightarrow ","&hArr;"),O.Re=O.Real=O.real=f(H,"\\Re ","&real;"),O.Im=O.imag=O.image=O.imagin=O.imaginary=O.Imaginary=f(H,"\\Im ","&image;"),O.part=O.partial=f(H,"\\partial ","&part;"),O.infty=O.infin=O.infinity=f(H,"\\infty ","&infin;"),O.alef=O.alefsym=O.aleph=O.alephsym=f(H,"\\aleph ","&alefsym;"),O.xist=O.xists=O.exist=O.exists=f(H,"\\exists ","&exist;"),O.nexists=O.nexist=f(H,"\\nexists ","&#8708;"),O.and=O.land=O.wedge=f(H,"\\wedge ","&and;"),O.or=O.lor=O.vee=f(H,"\\vee ","&or;"),O.o=O.O=O.empty=O.emptyset=O.oslash=O.Oslash=O.nothing=O.varnothing=f(G,"\\varnothing ","&empty;"),O.cup=O.union=f(G,"\\cup ","&cup;"),O.cap=O.intersect=O.intersection=f(G,"\\cap ","&cap;"),O.deg=O.degree=f(H,"\\degree ","&deg;"),O.ang=O.angle=f(H,"\\angle ","&ang;"),O.measuredangle=f(H,"\\measuredangle ","&#8737;");var et=d(H,(function(t,e){t.createLeftOf=function(t){t.options.autoSubscriptNumerals&&t.parent!==t.parent.parent.sub&&(t[m]instanceof nt&&!1!==t[m].isItalic||t[m]instanceof yt&&t[m][m]instanceof nt&&!1!==t[m][m].isItalic)?(O._().createLeftOf(t),e.createLeftOf.call(this,t),t.insRightOf(t.parent.parent)):e.createLeftOf.call(this,t)}})),nt=d(U,(function(t,e){t.init=function(t,n){e.init.call(this,t,"<var>"+(n||t)+"</var>")},t.text=function(){var t=this.ctrlSeq;return!this[m]||this[m]instanceof nt||this[m]instanceof G||"\\ "===this[m].ctrlSeq||(t="*"+t),!this[g]||this[g]instanceof G||this[g]instanceof yt||(t+="*"),t}}));_.p.autoCommands={_maxLength:0},D.autoCommands=function(t){if(!/^[a-z]+(?: [a-z]+)*$/i.test(t))throw'"'+t+'" not a space-delimited list of only letters';for(var e=t.split(" "),n={},i=0,r=0;r<e.length;r+=1){var s=e[r];if(s.length<2)throw'autocommand "'+s+'" not minimum length of 2';if(O[s]===at)throw'"'+s+'" is a built-in operator name';n[s]=1,i=o(i,s.length)}return n._maxLength=i,n};var it=d(nt,(function(t,e){function n(t){return!t||t instanceof G||t instanceof kt}t.init=function(t){return e.init.call(this,this.letter=t)},t.createLeftOf=function(t){e.createLeftOf.apply(this,arguments);var n=t.options.autoCommands,i=n._maxLength;if(i>0){for(var r="",s=this,o=0;s instanceof it&&s.ctrlSeq===s.letter&&o<i;)r=s.letter+r,s=s[m],o+=1;for(;r.length;){if(n.hasOwnProperty(r)){for(o=1,s=this;o<r.length;o+=1,s=s[m]);return y(s,this).remove(),t[m]=s[m],O[r](r).createLeftOf(t)}r=r.slice(1)}}},t.italicize=function(t){return this.isItalic=t,this.jQ.toggleClass("mq-operator-name",!t),this},t.finalizeTree=t.siblingDeleted=t.siblingCreated=function(t,e){e!==m&&this[g]instanceof it||this.autoUnItalicize(t)},t.autoUnItalicize=function(t){var e=t.autoOperatorNames;if(0!==e._maxLength){for(var i=this.letter,r=this[m];r instanceof it;r=r[m])i=r.letter+i;for(var o=this[g];o instanceof it;o=o[g])i+=o.letter;y(r[g]||this.parent.ends[m],o[m]||this.parent.ends[g]).each((function(t){t.italicize(!0).jQ.removeClass("mq-first mq-last mq-followed-by-supsub"),t.ctrlSeq=t.letter}));t:for(var a=0,l=r[g]||this.parent.ends[m];a<i.length;a+=1,l=l[g])for(var c=s(e._maxLength,i.length-a);c>0;c-=1){var u=i.slice(a,a+c);if(e.hasOwnProperty(u)){for(var h=0,f=l;h<c;h+=1,f=f[g]){f.italicize(!1);var p=f}var d=rt.hasOwnProperty(u);if(l.ctrlSeq=(d?"\\":"\\operatorname{")+l.ctrlSeq,p.ctrlSeq+=d?" ":"}",ot.hasOwnProperty(u)&&p[m][m][m].jQ.addClass("mq-last"),n(l[m])||l.jQ.addClass("mq-first"),!n(p[g]))if(p[g]instanceof yt){var v=p[g];(v.siblingCreated=v.siblingDeleted=function(){v.jQ.toggleClass("mq-after-operator-name",!(v[g]instanceof Dt))})()}else p.jQ.toggleClass("mq-last",!(p[g]instanceof Dt));a+=c-1,l=p;continue t}}}}})),rt={},st=_.p.autoOperatorNames={_maxLength:9},ot={limsup:1,liminf:1,projlim:1,injlim:1};!function(){for(var t="arg deg det dim exp gcd hom inf ker lg lim ln log max min sup limsup liminf injlim projlim Pr".split(" "),e=0;e<t.length;e+=1)rt[t[e]]=st[t[e]]=1;var n="sin cos tan arcsin arccos arctan sinh cosh tanh sec csc cot coth".split(" ");for(e=0;e<n.length;e+=1)rt[n[e]]=1;var i="sin cos tan sec cosec csc cotan cot ctg".split(" ");for(e=0;e<i.length;e+=1)st[i[e]]=st["arc"+i[e]]=st[i[e]+"h"]=st["ar"+i[e]+"h"]=st["arc"+i[e]+"h"]=1;var r="gcf hcf lcm proj span".split(" ");for(e=0;e<r.length;e+=1)st[r[e]]=1}(),D.autoOperatorNames=function(t){if(!/^[a-z]+(?: [a-z]+)*$/i.test(t))throw'"'+t+'" not a space-delimited list of only letters';for(var e=t.split(" "),n={},i=0,r=0;r<e.length;r+=1){var s=e[r];if(s.length<2)throw'"'+s+'" not minimum length of 2';n[s]=1,i=o(i,s.length)}return n._maxLength=i,n};var at=d(U,(function(t,e){t.init=function(t){this.ctrlSeq=t},t.createLeftOf=function(t){for(var e=this.ctrlSeq,n=0;n<e.length;n+=1)it(e.charAt(n)).createLeftOf(t)},t.parser=function(){for(var t=this.ctrlSeq,e=K(),n=0;n<t.length;n+=1)it(t.charAt(n)).adopt(e,e.ends[g],0);return F.succeed(e.children())}}));for(var lt in st)st.hasOwnProperty(lt)&&(O[lt]=at);O.operatorname=d(W,(function(t){t.createLeftOf=a,t.numBlocks=function(){return 1},t.parser=function(){return N.block.map((function(t){return t.children()}))}})),O.f=d(it,(function(t,e){t.init=function(){U.p.init.call(this,this.letter="f",'<var class="mq-f">f</var>')},t.italicize=function(t){return this.jQ.html("f").toggleClass("mq-f",t),e.italicize.apply(this,arguments)}})),O[" "]=O.space=f(H,"\\ ","&nbsp;"),O["'"]=O.prime=f(H,"'","&prime;"),O.backslash=f(H,"\\backslash ","\\"),k["\\"]||(k["\\"]=O.backslash),O.$=f(H,"\\$","$");var ct=d(U,(function(t,e){t.init=function(t,n){e.init.call(this,t,'<span class="mq-nonSymbola">'+(n||t)+"</span>")}}));O["@"]=ct,O["&"]=f(ct,"\\&","&amp;"),O["%"]=f(ct,"\\%","%"),O.alpha=O.beta=O.gamma=O.delta=O.zeta=O.eta=O.theta=O.iota=O.kappa=O.mu=O.nu=O.xi=O.rho=O.sigma=O.tau=O.chi=O.psi=O.omega=d(nt,(function(t,e){t.init=function(t){e.init.call(this,"\\"+t+" ","&"+t+";")}})),O.phi=f(nt,"\\phi ","&#981;"),O.phiv=O.varphi=f(nt,"\\varphi ","&phi;"),O.epsilon=f(nt,"\\epsilon ","&#1013;"),O.epsiv=O.varepsilon=f(nt,"\\varepsilon ","&epsilon;"),O.piv=O.varpi=f(nt,"\\varpi ","&piv;"),O.sigmaf=O.sigmav=O.varsigma=f(nt,"\\varsigma ","&sigmaf;"),O.thetav=O.vartheta=O.thetasym=f(nt,"\\vartheta ","&thetasym;"),O.upsilon=O.upsi=f(nt,"\\upsilon ","&upsilon;"),O.gammad=O.Gammad=O.digamma=f(nt,"\\digamma ","&#989;"),O.kappav=O.varkappa=f(nt,"\\varkappa ","&#1008;"),O.rhov=O.varrho=f(nt,"\\varrho ","&#1009;"),O.pi=O["\u03c0"]=f(ct,"\\pi ","&pi;"),O.lambda=f(ct,"\\lambda ","&lambda;"),O.Upsilon=O.Upsi=O.upsih=O.Upsih=f(U,"\\Upsilon ",'<var style="font-family: serif">&upsih;</var>'),O.Gamma=O.Delta=O.Theta=O.Lambda=O.Xi=O.Pi=O.Sigma=O.Phi=O.Psi=O.Omega=O.forall=d(H,(function(t,e){t.init=function(t){e.init.call(this,"\\"+t+" ","&"+t+";")}}));var ut=d(W,(function(t){t.init=function(t){this.latex=t},t.createLeftOf=function(t){var e=N.parse(this.latex);e.children().adopt(t.parent,t[m],t[g]),t[m]=e.ends[g],e.jQize().insertBefore(t.jQ),e.finalizeInsert(t.options,t),e.ends[g][g].siblingCreated&&e.ends[g][g].siblingCreated(t.options,m),e.ends[m][m].siblingCreated&&e.ends[m][m].siblingCreated(t.options,g),t.parent.bubble("reflow")},t.parser=function(){var t=N.parse(this.latex).children();return F.succeed(t)}}));O["\xb9"]=f(ut,"^1"),O["\xb2"]=f(ut,"^2"),O["\xb3"]=f(ut,"^3"),O["\xbc"]=f(ut,"\\frac14"),O["\xbd"]=f(ut,"\\frac12"),O["\xbe"]=f(ut,"\\frac34");var ht=d(G,(function(t){t.init=H.prototype.init,t.contactWeld=t.siblingCreated=t.siblingDeleted=function(t,e){if(e!==g)return this.jQ[0].className=!this[m]||this[m]instanceof G||/^[,;:\(\[]$/.test(this[m].ctrlSeq)?"":"mq-binary-operator",this}}));O["+"]=f(ht,"+","+"),O["\u2013"]=O["-"]=f(ht,"-","&minus;"),O["\xb1"]=O.pm=O.plusmn=O.plusminus=f(ht,"\\pm ","&plusmn;"),O.mp=O.mnplus=O.minusplus=f(ht,"\\mp ","&#8723;"),k["*"]=O.sdot=O.cdot=f(G,"\\cdot ","&middot;","*");var ft=d(G,(function(t,e){t.init=function(t,n){this.data=t,this.strict=n;var i=n?"Strict":"";e.init.call(this,t["ctrlSeq"+i],t["html"+i],t["text"+i])},t.swap=function(t){this.strict=t;var e=t?"Strict":"";this.ctrlSeq=this.data["ctrlSeq"+e],this.jQ.html(this.data["html"+e]),this.textTemplate=[this.data["text"+e]]},t.deleteTowards=function(t,n){if(t===m&&!this.strict)return this.swap(!0),void this.bubble("reflow");e.deleteTowards.apply(this,arguments)}})),pt={ctrlSeq:"\\le ",html:"&le;",text:"\u2264",ctrlSeqStrict:"<",htmlStrict:"&lt;",textStrict:"<"},dt={ctrlSeq:"\\ge ",html:"&ge;",text:"\u2265",ctrlSeqStrict:">",htmlStrict:"&gt;",textStrict:">"};O["<"]=O.lt=f(ft,pt,!0),O[">"]=O.gt=f(ft,dt,!0),O["\u2264"]=O.le=O.leq=f(ft,pt,!1),O["\u2265"]=O.ge=O.geq=f(ft,dt,!1);var mt=d(G,(function(t,e){t.init=function(){e.init.call(this,"=","=")},t.createLeftOf=function(t){if(t[m]instanceof ft&&t[m].strict)return t[m].swap(!1),void t[m].bubble("reflow");e.createLeftOf.apply(this,arguments)}}));O["="]=mt,O["\xd7"]=O.times=f(G,"\\times ","&times;","[x]"),O["\xf7"]=O.div=O.divide=O.divides=f(G,"\\div ","&divide;","[/]"),k["~"]=O.sim=f(G,"\\sim ","~","~");var gt,vt,bt=a,wt=document.createElement("div").style;for(var xt in{transform:1,WebkitTransform:1,MozTransform:1,OTransform:1,msTransform:1})if(xt in wt){vt=xt;break}vt?gt=function(t,e,n){t.css(vt,"scale("+e+","+n+")")}:"filter"in wt?(bt=function(t){t.className=t.className},gt=function(t,e,n){e/=1+(n-1)/2,t.css("fontSize",n+"em"),t.hasClass("mq-matrixed-container")||t.addClass("mq-matrixed-container").wrapInner('<span class="mq-matrixed"></span>');var i=t.children().css("filter","progid:DXImageTransform.Microsoft.Matrix(M11="+e+",SizingMethod='auto expand')");function r(){t.css("marginRight",(i.width()-1)*(e-1)/e+"px")}r();var s=setInterval(r);b(window).load((function(){clearTimeout(s),r()}))}):gt=function(t,e,n){t.css("fontSize",n+"em")};var qt=d(W,(function(t,e){t.init=function(t,n,i){e.init.call(this,t,"<"+n+" "+i+">&0</"+n+">")}}));O.mathrm=f(qt,"\\mathrm","span",'class="mq-roman mq-font"'),O.mathit=f(qt,"\\mathit","i",'class="mq-font"'),O.mathbf=f(qt,"\\mathbf","b",'class="mq-font"'),O.mathsf=f(qt,"\\mathsf","span",'class="mq-sans-serif mq-font"'),O.mathtt=f(qt,"\\mathtt","span",'class="mq-monospace mq-font"'),O.underline=f(qt,"\\underline","span",'class="mq-non-leaf mq-underline"'),O.overline=O.bar=f(qt,"\\overline","span",'class="mq-non-leaf mq-overline"'),O.overrightarrow=f(qt,"\\overrightarrow","span",'class="mq-non-leaf mq-overarrow mq-arrow-right"'),O.overleftarrow=f(qt,"\\overleftarrow","span",'class="mq-non-leaf mq-overarrow mq-arrow-left"');O.textcolor=d(W,(function(t,e){t.setColor=function(t){this.color=t,this.htmlTemplate='<span class="mq-textcolor" style="color:'+t+'">&0</span>'},t.latex=function(){return"\\textcolor{"+this.color+"}{"+this.blocks[0].latex()+"}"},t.parser=function(){var t=this,n=F.optWhitespace,i=F.string,r=F.regex;return n.then(i("{")).then(r(/^[#\w\s.,()%-]*/)).skip(i("}")).then((function(n){return t.setColor(n),e.parser.call(t)}))}})),O.class=d(W,(function(t,e){t.parser=function(){var t=this,n=F.string,i=F.regex;return F.optWhitespace.then(n("{")).then(i(/^[-\w\s\\\xA0-\xFF]*/)).skip(n("}")).then((function(n){return t.htmlTemplate='<span class="mq-class '+n+'">&0</span>',e.parser.call(t)}))}}));var yt=d(W,(function(t,e){t.ctrlSeq="_{...}^{...}",t.createLeftOf=function(t){if(t[m]||!t.options.supSubsRequireOperand)return e.createLeftOf.apply(this,arguments)},t.contactWeld=function(t){for(var e=m;e;e=e===m&&g)if(this[e]instanceof yt){for(var n="sub";n;n="sub"===n&&"sup"){var i=this[n],r=this[e][n];if(i){if(r)if(i.isEmpty())o=w(r,0,r.ends[m]);else{i.jQ.children().insAtDirEnd(-e,r.jQ);var s=i.children().disown(),o=w(r,s.ends[g],r.ends[m]);e===m?s.adopt(r,r.ends[g],0):s.adopt(r,0,r.ends[m])}else this[e].addBlock(i.disown());this.placeCursor=function(t,n){return function(i){i.insAtDirEnd(-e,t||n)}}(r,i)}}this.remove(),t&&t[m]===this&&(e===g&&o?o[m]?t.insRightOf(o[m]):t.insAtLeftEnd(o.parent):t.insRightOf(this[e]));break}},_.p.charsThatBreakOutOfSupSub="",t.finalizeTree=function(){this.ends[m].write=function(t,e){if(t.options.autoSubscriptNumerals&&this===this.parent.sub){if("_"===e)return;var n=this.chToCmd(e);return n instanceof U?t.deleteSelection():t.clearSelection().insRightOf(this.parent),n.createLeftOf(t.show())}t[m]&&!t[g]&&!t.selection&&t.options.charsThatBreakOutOfSupSub.indexOf(e)>-1&&t.insRightOf(this.parent),K.p.write.apply(this,arguments)}},t.moveTowards=function(t,n,i){n.options.autoSubscriptNumerals&&!this.sup?n.insDirOf(t,this):e.moveTowards.apply(this,arguments)},t.deleteTowards=function(t,n){if(n.options.autoSubscriptNumerals&&this.sub){var i=this.sub.ends[-t];i instanceof U?i.remove():i&&i.deleteTowards(t,n.insAtDirEnd(-t,this.sub)),this.sub.isEmpty()&&(this.sub.deleteOutOf(m,n.insAtLeftEnd(this.sub)),this.sup&&n.insDirOf(-t,this))}else e.deleteTowards.apply(this,arguments)},t.latex=function(){function t(t,e){var n=e&&e.latex();return e?t+(1===n.length?n:"{"+(n||" ")+"}"):""}return t("_",this.sub)+t("^",this.sup)},t.addBlock=function(t){"sub"===this.supsub?(this.sup=this.upInto=this.sub.upOutOf=t,t.adopt(this,this.sub,0).downOutOf=this.sub,t.jQ=b('<span class="mq-sup"/>').append(t.jQ.children()).attr(r,t.id).prependTo(this.jQ)):(this.sub=this.downInto=this.sup.downOutOf=t,t.adopt(this,0,this.sup).upOutOf=this.sup,t.jQ=b('<span class="mq-sub"></span>').append(t.jQ.children()).attr(r,t.id).appendTo(this.jQ.removeClass("mq-sup-only")),this.jQ.append('<span style="display:inline-block;width:0">&#8203;</span>'));for(var e=0;e<2;e+=1)!function(t,e,n,i){t[e].deleteOutOf=function(r,s){if(s.insDirOf(this[r]?-r:r,this.parent),!this.isEmpty()){var o=this.ends[r];this.children().disown().withDirAdopt(r,s.parent,s[r],s[-r]).jQ.insDirOf(-r,s.jQ),s[-r]=o}t.supsub=n,delete t[e],delete t[i+"Into"],t[n][i+"OutOf"]=Ot,delete t[n].deleteOutOf,"sub"===e&&b(t.jQ.addClass("mq-sup-only")[0].lastChild).remove(),this.remove()}}(this,"sub sup".split(" ")[e],"sup sub".split(" ")[e],"down up".split(" ")[e])}}));function Ot(t){var e=this.parent,n=t;do{if(n[g])return t.insLeftOf(e);n=n.parent.parent}while(n!==e);t.insRightOf(e)}O.subscript=O._=d(yt,(function(t,e){t.supsub="sub",t.htmlTemplate='<span class="mq-supsub mq-non-leaf"><span class="mq-sub">&0</span><span style="display:inline-block;width:0">&#8203;</span></span>',t.textTemplate=["_"],t.finalizeTree=function(){this.downInto=this.sub=this.ends[m],this.sub.upOutOf=Ot,e.finalizeTree.call(this)}})),O.superscript=O.supscript=O["^"]=d(yt,(function(t,e){t.supsub="sup",t.htmlTemplate='<span class="mq-supsub mq-non-leaf mq-sup-only"><span class="mq-sup">&0</span></span>',t.textTemplate=["^"],t.finalizeTree=function(){this.upInto=this.sup=this.ends[g],this.sup.downOutOf=Ot,e.finalizeTree.call(this)}}));var kt=d(W,(function(t,e){t.init=function(t,e){var n='<span class="mq-large-operator mq-non-leaf"><span class="mq-to"><span>&1</span></span><big>'+e+'</big><span class="mq-from"><span>&0</span></span></span>';U.prototype.init.call(this,t,n)},t.createLeftOf=function(t){e.createLeftOf.apply(this,arguments),t.options.sumStartsWithNEquals&&(it("n").createLeftOf(t),mt().createLeftOf(t))},t.latex=function(){function t(t){return 1===t.length?t:"{"+(t||" ")+"}"}return this.ctrlSeq+"_"+t(this.ends[m].latex())+"^"+t(this.ends[g].latex())},t.parser=function(){for(var t=F.string,e=F.optWhitespace,n=F.succeed,i=N.block,r=this,s=r.blocks=[K(),K()],o=0;o<s.length;o+=1)s[o].adopt(r,r.ends[g],0);return e.then(t("_").or(t("^"))).then((function(t){var e=s["_"===t?0:1];return i.then((function(t){return t.children().adopt(e,e.ends[g],0),n(r)}))})).many().result(r)},t.finalizeTree=function(){this.downInto=this.ends[m],this.upInto=this.ends[g],this.ends[m].upOutOf=this.ends[g],this.ends[g].downOutOf=this.ends[m]}}));O["\u2211"]=O.sum=O.summation=f(kt,"\\sum ","&sum;"),O["\u220f"]=O.prod=O.product=f(kt,"\\prod ","&prod;"),O.coprod=O.coproduct=f(kt,"\\coprod ","&#8720;"),O["\u222b"]=O.int=O.integral=d(kt,(function(t,e){t.init=function(){U.prototype.init.call(this,"\\int ",'<span class="mq-int mq-non-leaf"><big>&int;</big><span class="mq-supsub mq-non-leaf"><span class="mq-sup"><span class="mq-sup-inner">&1</span></span><span class="mq-sub">&0</span><span style="display:inline-block;width:0">&#8203</span></span></span>')},t.createLeftOf=W.p.createLeftOf}));var jt=O.frac=O.dfrac=O.cfrac=O.fraction=d(W,(function(t,e){t.ctrlSeq="\\frac",t.htmlTemplate='<span class="mq-fraction mq-non-leaf"><span class="mq-numerator">&0</span><span class="mq-denominator">&1</span><span style="display:inline-block;width:0">&#8203;</span></span>',t.textTemplate=["(",")/(",")"],t.finalizeTree=function(){this.upInto=this.ends[g].upOutOf=this.ends[m],this.downInto=this.ends[m].downOutOf=this.ends[g]}})),Tt=O.over=k["/"]=d(jt,(function(t,e){t.createLeftOf=function(t){if(!this.replacedFragment){for(var n=t[m];n&&!(n instanceof G||n instanceof(O.text||a)||n instanceof kt||"\\ "===n.ctrlSeq||/^[,;:]$/.test(n.ctrlSeq));)n=n[m];n instanceof kt&&n[g]instanceof yt&&(n=n[g])[g]instanceof yt&&n[g].ctrlSeq!=n.ctrlSeq&&(n=n[g]),n!==t[m]&&(this.replaces(y(n[g]||t.parent.ends[m],t[m])),t[m]=n)}e.createLeftOf.call(this,t)}})),Qt=O.sqrt=O["\u221a"]=d(W,(function(t,e){t.ctrlSeq="\\sqrt",t.htmlTemplate='<span class="mq-non-leaf"><span class="mq-scaled mq-sqrt-prefix">&radic;</span><span class="mq-non-leaf mq-sqrt-stem">&0</span></span>',t.textTemplate=["sqrt(",")"],t.parser=function(){return N.optBlock.then((function(t){return N.block.map((function(e){var n=Ct();return n.blocks=[t,e],t.adopt(n,0,0),e.adopt(n,t,0),n}))})).or(e.parser.call(this))},t.reflow=function(){var t=this.ends[g].jQ;gt(t.prev(),1,t.innerHeight()/+t.css("fontSize").slice(0,-2)-.1)}})),Ct=(O.vec=d(W,(function(t,e){t.ctrlSeq="\\vec",t.htmlTemplate='<span class="mq-non-leaf"><span class="mq-vector-prefix">&rarr;</span><span class="mq-vector-stem">&0</span></span>',t.textTemplate=["vec(",")"]})),O.nthroot=d(Qt,(function(t,e){t.htmlTemplate='<sup class="mq-nthroot mq-non-leaf">&0</sup><span class="mq-scaled"><span class="mq-sqrt-prefix mq-scaled">&radic;</span><span class="mq-sqrt-stem mq-non-leaf">&1</span></span>',t.textTemplate=["sqrt[","](",")"],t.latex=function(){return"\\sqrt["+this.ends[m].latex()+"]{"+this.ends[g].latex()+"}"}})));function _t(t,e){t.jQadd=function(){e.jQadd.apply(this,arguments),this.delimjQs=this.jQ.children(":first").add(this.jQ.children(":last")),this.contentjQ=this.jQ.children(":eq(1)")},t.reflow=function(){var t=this.contentjQ.outerHeight()/parseFloat(this.contentjQ.css("fontSize"));gt(this.delimjQs,s(1+.2*(t-1),1.2),1.2*t)}}var Dt=d(d(W,_t),(function(e,n){e.init=function(e,i,r,s,o){n.init.call(this,"\\left"+s,t,[i,r]),this.side=e,this.sides={},this.sides[m]={ch:i,ctrlSeq:s},this.sides[g]={ch:r,ctrlSeq:o}},e.numBlocks=function(){return 1},e.html=function(){return this.htmlTemplate='<span class="mq-non-leaf"><span class="mq-scaled mq-paren'+(this.side===g?" mq-ghost":"")+'">'+this.sides[m].ch+'</span><span class="mq-non-leaf">&0</span><span class="mq-scaled mq-paren'+(this.side===m?" mq-ghost":"")+'">'+this.sides[g].ch+"</span></span>",n.html.call(this)},e.latex=function(){return"\\left"+this.sides[m].ctrlSeq+this.ends[m].latex()+"\\right"+this.sides[g].ctrlSeq},e.oppBrack=function(t,e,n){return e instanceof Dt&&e.side&&e.side!==-n&&("|"===this.sides[this.side].ch||e.side===-this.side)&&(!t.restrictMismatchedBrackets||St[this.sides[this.side].ch]===e.sides[e.side].ch||{"(":"]","[":")"}[this.sides[m].ch]===e.sides[g].ch)&&e},e.closeOpposing=function(t){t.side=0,t.sides[this.side]=this.sides[this.side],t.delimjQs.eq(this.side===m?0:1).removeClass("mq-ghost").html(this.sides[this.side].ch)},e.createLeftOf=function(t){if(!this.replacedFragment)var e=t.options,i=this.oppBrack(e,t[m],m)||this.oppBrack(e,t[g],g)||this.oppBrack(e,t.parent.parent);if(i){var r=this.side=-i.side;this.closeOpposing(i),i===t.parent.parent&&t[r]&&(y(t[r],t.parent.ends[r],-r).disown().withDirAdopt(-r,i.parent,i,i[r]).jQ.insDirOf(r,i.jQ),i.bubble("reflow"))}else r=(i=this).side,i.replacedFragment?i.side=0:t[-r]&&(i.replaces(y(t[-r],t.parent.ends[-r],r)),t[-r]=0),n.createLeftOf.call(i,t);r===m?t.insAtLeftEnd(i.ends[m]):t.insRightOf(i)},e.placeCursor=a,e.unwrap=function(){this.ends[m].children().disown().adopt(this.parent,this,this[g]).jQ.insertAfter(this.jQ),this.remove()},e.deleteSide=function(t,e,n){var i=this.parent,r=this[t],s=i.ends[t];if(t===this.side)return this.unwrap(),void(r?n.insDirOf(-t,r):n.insAtDirEnd(t,i));var o=n.options,a=!this.side;if(this.side=-t,this.oppBrack(o,this.ends[m].ends[this.side],t)){this.closeOpposing(this.ends[m].ends[this.side]);var l=this.ends[m].ends[t];this.unwrap(),l.siblingCreated&&l.siblingCreated(n.options,t),r?n.insDirOf(-t,r):n.insAtDirEnd(t,i)}else{if(this.oppBrack(o,this.parent.parent,t))this.parent.parent.closeOpposing(this),this.parent.parent.unwrap();else{if(e&&a)return this.unwrap(),void(r?n.insDirOf(-t,r):n.insAtDirEnd(t,i));this.sides[t]={ch:St[this.sides[this.side].ch],ctrlSeq:St[this.sides[this.side].ctrlSeq]},this.delimjQs.removeClass("mq-ghost").eq(t===m?0:1).addClass("mq-ghost").html(this.sides[t].ch)}if(r){l=this.ends[m].ends[t];y(r,s,-t).disown().withDirAdopt(-t,this.ends[m],l,0).jQ.insAtDirEnd(t,this.ends[m].jQ.removeClass("mq-empty")),l.siblingCreated&&l.siblingCreated(n.options,t),n.insDirOf(-t,r)}else e?n.insDirOf(t,this):n.insAtDirEnd(t,this.ends[m])}},e.deleteTowards=function(t,e){this.deleteSide(-t,!1,e)},e.finalizeTree=function(){this.ends[m].deleteOutOf=function(t,e){this.parent.deleteSide(t,!0,e)},this.finalizeTree=this.intentionalBlur=function(){this.delimjQs.eq(this.side===m?1:0).removeClass("mq-ghost"),this.side=0}},e.siblingCreated=function(t,e){e===-this.side&&this.finalizeTree()}})),St={"(":")",")":"(","[":"]","]":"[","{":"}","}":"{","\\{":"\\}","\\}":"\\{","&lang;":"&rang;","&rang;":"&lang;","\\langle ":"\\rangle ","\\rangle ":"\\langle ","|":"|"};function Et(t,e){e=e||t;var n=St[t],i=St[e];k[t]=f(Dt,m,t,n,e,i),k[n]=f(Dt,g,t,n,e,i)}Et("("),Et("["),Et("{","\\{"),O.langle=f(Dt,m,"&lang;","&rang;","\\langle ","\\rangle "),O.rangle=f(Dt,g,"&lang;","&rang;","\\langle ","\\rangle "),k["|"]=f(Dt,m,"|","|","|","|"),O.left=d(W,(function(t){t.parser=function(){var t=F.regex,e=F.string,n=(F.succeed,F.optWhitespace);return n.then(t(/^(?:[([|]|\\\{)/)).then((function(i){var r="\\"===i.charAt(0)?i.slice(1):i;return N.then((function(s){return e("\\right").skip(n).then(t(/^(?:[\])|]|\\\})/)).map((function(t){var e="\\"===t.charAt(0)?t.slice(1):t,n=Dt(0,r,e,i,t);return n.blocks=[s],s.adopt(n,0,0),n}))}))}))}})),O.right=d(W,(function(t){t.parser=function(){return F.fail("unmatched \\right")}}));var Lt=O.binom=O.binomial=d(d(W,_t),(function(t,e){t.ctrlSeq="\\binom",t.htmlTemplate='<span class="mq-non-leaf"><span class="mq-paren mq-scaled">(</span><span class="mq-non-leaf"><span class="mq-array mq-non-leaf"><span>&0</span><span>&1</span></span></span><span class="mq-paren mq-scaled">)</span></span>',t.textTemplate=["choose(",",",")"]}));O.choose=d(Lt,(function(t){t.createLeftOf=Tt.prototype.createLeftOf}));O.editable=O.MathQuillMathField=d(W,(function(t,e){t.ctrlSeq="\\MathQuillMathField",t.htmlTemplate='<span class="mq-editable-field"><span class="mq-root-block">&0</span></span>',t.parser=function(){var t=this,n=F.string,i=F.regex,r=F.succeed;return n("[").then(i(/^[a-z][a-z0-9]*/i)).skip(n("]")).map((function(e){t.name=e})).or(r()).then(e.parser.call(t))},t.finalizeTree=function(){var t=Q(this.ends[m],this.jQ,_());t.KIND_OF_MQ="MathField",t.editable=!0,t.createTextarea(),t.editablesTextareaEvents(),t.cursor.insAtRightEnd(t.root),B(t.root)},t.registerInnerField=function(t,e){t.push(t[this.name]=e(this.ends[m].controller))},t.latex=function(){return this.ends[m].latex()},t.text=function(){return this.ends[m].text()}}));var At=O.embed=d(U,(function(t,e){t.setOptions=function(t){function e(){return""}return this.text=t.text||e,this.htmlTemplate=t.htmlString||"",this.latex=t.latex||e,this},t.parser=function(){var t=this;return string=F.string,regex=F.regex,succeed=F.succeed,string("{").then(regex(/^[a-z][a-z0-9]*/i)).skip(string("}")).then((function(e){return string("[").then(regex(/^[-\w\s]*/)).skip(string("]")).or(succeed()).map((function(n){return t.setOptions(E[e](n))}))}))}})),Rt=(k["\\"]=d(W,(function(t,e){t.ctrlSeq="\\",t.replaces=function(t){this._replacedFragment=t.disown(),this.isEmpty=function(){return!1}},t.htmlTemplate='<span class="mq-latex-command-input mq-non-leaf">\\<span>&0</span></span>',t.textTemplate=["\\"],t.createBlocks=function(){e.createBlocks.call(this),this.ends[m].focus=function(){return this.parent.jQ.addClass("mq-hasCursor"),this.isEmpty()&&this.parent.jQ.removeClass("mq-empty"),this},this.ends[m].blur=function(){return this.parent.jQ.removeClass("mq-hasCursor"),this.isEmpty()&&this.parent.jQ.addClass("mq-empty"),this},this.ends[m].write=function(t,e){t.show().deleteSelection(),e.match(/[a-z]/i)?H(e).createLeftOf(t):(this.parent.renderCommand(t),"\\"===e&&this.isEmpty()||this.parent.parent.write(t,e))},this.ends[m].keystroke=function(t,n,i){return"Tab"===t||"Enter"===t||"Spacebar"===t?(this.parent.renderCommand(i.cursor),void n.preventDefault()):e.keystroke.apply(this,arguments)}},t.createLeftOf=function(t){if(e.createLeftOf.call(this,t),this._replacedFragment){var n=this.jQ[0];this.jQ=this._replacedFragment.jQ.addClass("mq-blur").bind("mousedown mousemove",(function(t){return b(t.target=n).trigger(t),!1})).insertBefore(this.jQ).add(this.jQ)}},t.latex=function(){return"\\"+this.ends[m].latex()+" "},t.renderCommand=function(t){this.jQ=this.jQ.last(),this.remove(),this[g]?t.insLeftOf(this[g]):t.insAtRightEnd(this.parent);var e=this.ends[m].latex();e||(e=" ");var n=O[e];n?(n=n(e),this._replacedFragment&&n.replaces(this._replacedFragment),n.createLeftOf(t)):((n=X()).replaces(e),n.createLeftOf(t),t.insRightOf(n),this._replacedFragment&&this._replacedFragment.remove())}})),z(1));for(var It in Rt)!function(t,e){"function"===typeof e?(A[t]=function(){return L(),e.apply(this,arguments)},A[t].prototype=e.prototype):A[t]=e}(It,Rt[It])}()},720:function(t,e){function n(t,e){t.onload=function(){this.onerror=this.onload=null,e(null,t)},t.onerror=function(){this.onerror=this.onload=null,e(new Error("Failed to load "+this.src),t)}}function i(t,e){t.onreadystatechange=function(){"complete"!=this.readyState&&"loaded"!=this.readyState||(this.onreadystatechange=null,e(null,t))}}t.exports=function(t,e,r){var s=document.head||document.getElementsByTagName("head")[0],o=document.createElement("script");"function"===typeof e&&(r=e,e={}),e=e||{},r=r||function(){},o.type=e.type||"text/javascript",o.charset=e.charset||"utf8",o.async=!("async"in e)||!!e.async,o.src=t,e.attrs&&function(t,e){for(var n in e)t.setAttribute(n,e[n])}(o,e.attrs),e.text&&(o.text=""+e.text),("onload"in o?n:i)(o,r),o.onload||n(o,r),s.appendChild(o)}},816:function(t,e,n){(function(e){var i=n(48).default,r="Expected a function",s=NaN,o="[object Symbol]",a=/^\s+|\s+$/g,l=/^[-+]0x[0-9a-f]+$/i,c=/^0b[01]+$/i,u=/^0o[0-7]+$/i,h=parseInt,f="object"==("undefined"===typeof e?"undefined":i(e))&&e&&e.Object===Object&&e,p="object"==("undefined"===typeof self?"undefined":i(self))&&self&&self.Object===Object&&self,d=f||p||Function("return this")(),m=Object.prototype.toString,g=Math.max,v=Math.min,b=function(){return d.Date.now()};function w(t,e,n){var i,s,o,a,l,c,u=0,h=!1,f=!1,p=!0;if("function"!=typeof t)throw new TypeError(r);function d(e){var n=i,r=s;return i=s=void 0,u=e,a=t.apply(r,n)}function m(t){var n=t-c;return void 0===c||n>=e||n<0||f&&t-u>=o}function w(){var t=b();if(m(t))return q(t);l=setTimeout(w,function(t){var n=e-(t-c);return f?v(n,o-(t-u)):n}(t))}function q(t){return l=void 0,p&&i?d(t):(i=s=void 0,a)}function O(){var t=b(),n=m(t);if(i=arguments,s=this,c=t,n){if(void 0===l)return function(t){return u=t,l=setTimeout(w,e),h?d(t):a}(c);if(f)return l=setTimeout(w,e),d(c)}return void 0===l&&(l=setTimeout(w,e)),a}return e=y(e)||0,x(n)&&(h=!!n.leading,o=(f="maxWait"in n)?g(y(n.maxWait)||0,e):o,p="trailing"in n?!!n.trailing:p),O.cancel=function(){void 0!==l&&clearTimeout(l),u=0,i=c=s=l=void 0},O.flush=function(){return void 0===l?a:q(b())},O}function x(t){var e=i(t);return!!t&&("object"==e||"function"==e)}function q(t){return"symbol"==i(t)||function(t){return!!t&&"object"==i(t)}(t)&&m.call(t)==o}function y(t){if("number"==typeof t)return t;if(q(t))return s;if(x(t)){var e="function"==typeof t.valueOf?t.valueOf():t;t=x(e)?e+"":e}if("string"!=typeof t)return 0===t?t:+t;t=t.replace(a,"");var n=c.test(t);return n||u.test(t)?h(t.slice(2),n?2:8):l.test(t)?s:+t}t.exports=function(t,e,n){var i=!0,s=!0;if("function"!=typeof t)throw new TypeError(r);return x(n)&&(i="leading"in n?!!n.leading:i,s="trailing"in n?!!n.trailing:s),w(t,e,{leading:i,maxWait:e,trailing:s})}}).call(this,n(192))}}]);